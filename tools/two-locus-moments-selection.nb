(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    308934,       8139]
NotebookOptionsPosition[    285563,       7831]
NotebookOutlinePosition[    285959,       7847]
CellTagsIndexPosition[    285916,       7844]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Computing transition probabilities for two-locus \
statistics with selection", "Title"]], "Subtitle",
 CellGroupingRules->{"TitleGrouping", Inherited},
 CellChangeTimes->{{3.866550413739953*^9, 3.866550478770227*^9}, {
  3.866555479967609*^9, 
  3.866555480947106*^9}},ExpressionUUID->"584ef30d-dc91-40b3-9f41-\
a306b58dc2d7"],

Cell["\<\
This notebook derives transitions for expected two-locus statistics due to \
recombination (r), drift (Ne), mutation (u, under an infinite sites model, \
assumed to be equal at both loci), and selection (s). Selection occurs at one \
locus, here the left locus, and the right locus is a linked neutral locus.\
\>", "Text",
 CellChangeTimes->{{3.866550428618734*^9, 3.866550428995473*^9}, {
  3.8665504807375393`*^9, 
  3.866550592945072*^9}},ExpressionUUID->"3a9b7c18-bd38-4904-8530-\
abbc673e9b30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"some", " ", "definitions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "2", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "4", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"c1", ",", " ", "c2", ",", " ", "c3", ",", " ", "c4"}], "}"}]}],
     ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "cs", " ", "are", " ", "the", " ", "allele", " ", "frequencies", " ", 
      "of", " ", "AB"}], ",", " ", "Ab", ",", " ", "aB", ",", " ", 
     RowBox[{"and", " ", "ab"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exp", "[", "monome_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Exponent", "[", 
       RowBox[{"monome", ",", 
        RowBox[{
        "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Extracts", " ", "the", " ", "exponents", " ", "of", " ", "the", " ", 
      RowBox[{"\[Product]", " ", 
       RowBox[{"c_i", "^", "k_i"}]}]}], " ", "*)"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
  3.866550892865244*^9, 3.866551059208465*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"4e0090fa-45e8-4cda-974d-929309f812ec"],

Cell[TextData[{
 "While the \[OpenCurlyDoubleQuote]cs\[CloseCurlyDoubleQuote] give the \
two-locus allele frequencies, many of the statistics we are interested in are \
given in terms of p=c1+c2 (the frequency of A), q=c1+c3 (the frequency of B), \
and D=c1c4-c2c3 (the standard covariance measure of LD). Thus, we will need \
to convert between \[OpenCurlyDoubleQuote]c-space\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]pqD-space\[CloseCurlyDoubleQuote].\n\nTo give a \
probabilistic meaning to a given monome (i.e., ",
 Cell[BoxData[
  RowBox[{"\[Product]", " ", 
   RowBox[{"c_i", "^", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "0e0415a0-67a4-4203-9bf3-e8ee1d005396"],
 "), we think of this as denoting the probability of drawing a sample of size \
\[Sum]k_i and observing the ",
 StyleBox["ordered",
  FontSlant->"Italic"],
 " sample of k_1 of type 1, k_2 of type 2, etc. For example, the monome c1c2 \
means the probability that we draw a type 1 (AB) haplotype, followed by a \
type 2 (Ab) haplotype. This is in contrast to the typical ",
 StyleBox["unsorted",
  FontSlant->"Italic"],
 " notion of drawing haplotype configurations.\n\nNote: terms should always \
be thought of as ",
 StyleBox["in expectation",
  FontSlant->"Italic"],
 ". These are genome- or region-wide average statistics, where averages are \
taken over a large set of exchangeable loci.\n\nWhy do we play this \
\[OpenCurlyDoubleQuote]sorted\[CloseCurlyDoubleQuote] vs \
\[OpenCurlyDoubleQuote]unsorted\[CloseCurlyDoubleQuote] sampling game? ..."
}], "Text",
 CellChangeTimes->{{3.866550611790963*^9, 3.866550614930521*^9}, {
   3.8665511023831167`*^9, 3.8665511378617907`*^9}, {3.866551210619643*^9, 
   3.86655131254775*^9}, {3.866551380667603*^9, 3.866551563018952*^9}, {
   3.8665516472621517`*^9, 3.86655170343577*^9}, {3.866584691138134*^9, 
   3.866584739949698*^9}, {3.887213533690798*^9, 3.8872135351447067`*^9}, 
   3.88721364497486*^9},ExpressionUUID->"04348e1a-2180-4a53-b92d-\
5a9833bf3ad2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToMonomes", "[", "t_", "]"}], ":=", 
   RowBox[{"MonomialList", "[", 
    RowBox[{"t", ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}]}], "]"}]}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
   "Takes", " ", "an", " ", "expression", " ", "and", " ", "returns", " ", 
    "a", " ", "list", " ", "of", " ", "all", " ", "monomials", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", "c1c4"}], "-", 
      RowBox[{"c2c3", " ", "gets", " ", "returned", " ", "as", " ", 
       RowBox[{"{", 
        RowBox[{"c1c4", ",", 
         RowBox[{"-", "c2c3"}]}], "}"}]}]}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scale", "[", "monome_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Multinomial", "@@", "k"}]}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "scaling", " ", "factor", " ", "to", " ", "convert", " ", 
    "from", " ", "sorted", " ", "to", " ", "unsorted"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "following", " ", "functions", " ", "convert", " ", "from", 
     " ", "unsorted", " ", "to", " ", "sorted"}], ",", " ", 
    RowBox[{"and", " ", "vice", " ", "versa"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToSorted", "[", "term_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "monomes", "}"}], ",", 
     RowBox[{
      RowBox[{"monomes", "=", 
       RowBox[{"ToMonomes", "[", "term", "]"}]}], ";", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"scale", "/@", "monomes"}], ")"}], ",", "monomes"}], 
       "]"}]}]}], "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToUnsorted", "[", "term_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "monomes", "}"}], ",", 
    RowBox[{
     RowBox[{"monomes", "=", 
      RowBox[{"ToMonomes", "[", "term", "]"}]}], ";", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"scale", "/@", "monomes"}]}], ")"}], ",", "monomes"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pqDsorted", "[", "term_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"term", "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"c1", "+", "c2"}], "\[Equal]", "p"}], ",", 
          RowBox[{
           RowBox[{"c1", "+", "c3"}], "\[Equal]", "q"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"c1", " ", "c4"}], "-", 
            RowBox[{"c2", " ", "c3"}]}], "\[Equal]", "DD"}], ",", 
          RowBox[{
           RowBox[{"c1", "+", "c2", "+", "c3", "+", "c4"}], "\[Equal]", 
           "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "takes", " ", "cs", " ", "sorted", " ", "term", " ", "and", " ", 
     "returns", " ", "p"}], ",", "q", ",", "D"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pqDunsorted", "[", "term_", "]"}], ":=", 
  RowBox[{"pqDsorted", "[", 
   RowBox[{"ToSorted", "[", "term", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tocs", "[", "pqDterm_", "]"}], ":=", 
   RowBox[{"ToUnsorted", "[", 
    RowBox[{"pqDterm", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "\[Rule]", 
        RowBox[{
         RowBox[{"c1", " ", "c4"}], "-", 
         RowBox[{"c2", " ", "c3"}]}]}], ",", " ", 
       RowBox[{"p", "\[Rule]", 
        RowBox[{"c1", "+", "c2"}]}], ",", " ", 
       RowBox[{"q", "\[Rule]", 
        RowBox[{"c1", "+", "c3"}]}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "moments"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DD", "=", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", " ", "c4"}], " ", "-", " ", 
       RowBox[{"c2", " ", "c3"}]}], ")"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"DDz", "=", 
   RowBox[{"D", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "p"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "q"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"2", "*", "p", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pi2", "=", 
   RowBox[{"p", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "*", "q", "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8665512981585293`*^9, 3.866551298722571*^9}, 
   3.866551369430169*^9, {3.8665516162189693`*^9, 3.866551621368041*^9}, 
   3.8665517510462933`*^9, {3.884771642590823*^9, 3.884771681757373*^9}, 
   3.884771746706983*^9, {3.8847718492303762`*^9, 3.8847718666233063`*^9}, 
   3.8872136341713333`*^9, {3.887214558239932*^9, 3.887214567473301*^9}, {
   3.887291117536018*^9, 3.887291194437829*^9}, {3.887291417675078*^9, 
   3.8872914576713047`*^9}, {3.887295729228142*^9, 3.887295945193509*^9}, {
   3.8872974599592743`*^9, 3.887297471191162*^9}, {3.887297541575098*^9, 
   3.887297555840399*^9}},ExpressionUUID->"a7c5e36c-2590-4bdc-bd5e-\
d7b5c36b4395"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ToUnsorted", "[", 
  RowBox[{"DD", "^", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Tocs", "[", "DD", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Tocs", "[", "DDz", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Tocs", "[", "H", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Tocs", "[", "Pi2", "]"}]}], "Input",
 CellChangeTimes->{{3.887296051644445*^9, 3.8872960756270857`*^9}, 
   3.887296160562138*^9, {3.8872974169983997`*^9, 3.8872974222850122`*^9}, {
   3.887297502975181*^9, 3.887297503266523*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"200426a1-d1a0-4ce9-91f4-25681ce49157"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["c2", "2"], " ", 
    SuperscriptBox["c3", "2"]}], "6"], "-", 
  RowBox[{
   FractionBox["1", "12"], " ", "c1", " ", "c2", " ", "c3", " ", "c4"}], "+", 
  
  FractionBox[
   RowBox[{
    SuperscriptBox["c1", "2"], " ", 
    SuperscriptBox["c4", "2"]}], "6"]}]], "Output",
 CellChangeTimes->{
  3.887296259912839*^9, 3.887297424634804*^9, 3.8872974660565023`*^9, {
   3.887297504514758*^9, 3.8872975161374283`*^9}},
 CellLabel->
  "Out[143]=",ExpressionUUID->"359fe9d8-a610-4fad-9a0a-f4848540040b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c2", " ", "c3"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c4"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.887296259912839*^9, 3.887297424634804*^9, 3.8872974660565023`*^9, {
   3.887297504514758*^9, 3.887297516138735*^9}},
 CellLabel->
  "Out[144]=",ExpressionUUID->"83236b33-a281-467d-94d7-c569d7d75eda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c2", " ", "c3"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "c1", " ", "c2", " ", "c3"}], "3"], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c1", "2"], " ", "c2", " ", "c3"}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["c2", "2"], " ", "c3"}], "3"], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", "c1", " ", 
   SuperscriptBox["c2", "2"], " ", "c3"}], "+", 
  FractionBox[
   RowBox[{"2", " ", "c2", " ", 
    SuperscriptBox["c3", "2"]}], "3"], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", "c1", " ", "c2", " ", 
   SuperscriptBox["c3", "2"]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["c2", "2"], " ", 
    SuperscriptBox["c3", "2"]}], "3"], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c4"}], "2"], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["c1", "2"], " ", "c4"}], "3"], "+", 
  RowBox[{
   SuperscriptBox["c1", "3"], " ", "c4"}], "-", 
  FractionBox[
   RowBox[{"c1", " ", "c2", " ", "c4"}], "3"], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c1", "2"], " ", "c2", " ", "c4"}], "-", 
  FractionBox[
   RowBox[{"c1", " ", "c3", " ", "c4"}], "3"], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c1", "2"], " ", "c3", " ", "c4"}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c2", " ", "c3", " ", 
   "c4"}]}]], "Output",
 CellChangeTimes->{
  3.887296259912839*^9, 3.887297424634804*^9, 3.8872974660565023`*^9, {
   3.887297504514758*^9, 3.887297516139802*^9}},
 CellLabel->
  "Out[145]=",ExpressionUUID->"7e049b15-08b1-41bb-9c71-11a102df1000"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "c1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["c1", "2"]}], "+", 
  RowBox[{"2", " ", "c2"}], "-", 
  RowBox[{"2", " ", "c1", " ", "c2"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["c2", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.887296259912839*^9, 3.887297424634804*^9, 3.8872974660565023`*^9, {
   3.887297504514758*^9, 3.887297516141011*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"d4e92c21-fc9e-4c09-a83d-27ca1a6e6e00"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["c1", "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["c1", "3"]}], "+", 
  SuperscriptBox["c1", "4"], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c2"}], "2"], "-", 
  RowBox[{
   SuperscriptBox["c1", "2"], " ", "c2"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["c1", "3"], " ", "c2"}], "2"], "-", 
  FractionBox[
   RowBox[{"c1", " ", 
    SuperscriptBox["c2", "2"]}], "3"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["c1", "2"], " ", 
    SuperscriptBox["c2", "2"]}], "6"], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c3"}], "2"], "-", 
  RowBox[{
   SuperscriptBox["c1", "2"], " ", "c3"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["c1", "3"], " ", "c3"}], "2"], "+", 
  FractionBox[
   RowBox[{"c2", " ", "c3"}], "2"], "-", 
  FractionBox[
   RowBox[{"2", " ", "c1", " ", "c2", " ", "c3"}], "3"], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c1", "2"], " ", "c2", " ", "c3"}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["c2", "2"], " ", "c3"}], "3"], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", 
   SuperscriptBox["c2", "2"], " ", "c3"}], "-", 
  FractionBox[
   RowBox[{"c1", " ", 
    SuperscriptBox["c3", "2"]}], "3"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["c1", "2"], " ", 
    SuperscriptBox["c3", "2"]}], "6"], "-", 
  FractionBox[
   RowBox[{"c2", " ", 
    SuperscriptBox["c3", "2"]}], "3"], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c2", " ", 
   SuperscriptBox["c3", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["c2", "2"], " ", 
    SuperscriptBox["c3", "2"]}], "6"]}]], "Output",
 CellChangeTimes->{
  3.887296259912839*^9, 3.887297424634804*^9, 3.8872974660565023`*^9, {
   3.887297504514758*^9, 3.887297516142115*^9}},
 CellLabel->
  "Out[147]=",ExpressionUUID->"63f7c4bf-2fde-44ad-b734-d506ed3d9da8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Recombination", "Subtitle"]], "Subsubtitle",
 CellChangeTimes->{{3.866551289484717*^9, 
  3.8665512905726213`*^9}},ExpressionUUID->"073e83c6-35d4-48b9-b551-\
d122f7bfe12e"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ll take a random union of gametes model, so that the \
recombination operator is unaffected by drift.\n\nUsing E[c1]_{t+1} = E[c1]_t \
- rD, E[c2]_{t+1} = E[c2]_t + rD, E[c3]_{t+1} = E[c3]_t + rD, E[c4]_{t+1} = \
E[c4]_t - rD. Taking any term ",
 Cell[BoxData[
  RowBox[{"\[Product]", " ", 
   RowBox[{"c_i", "^", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "d6dda336-d452-4823-b696-ea9272b06fbc"],
 ", and neglecting terms of order ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "2"], TraditionalForm]],ExpressionUUID->
  "e82bf7b3-83bb-441c-b178-a44dd38130ba"],
 " and higher, we get ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Product]", " ", 
    RowBox[{"c_i", "^", "k_i"}]}], "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"r", " ", "DD", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k1"}], "/", "c1"}], "+", 
         RowBox[{"k2", "/", "c2"}], "+", 
         RowBox[{"k3", "/", "c3"}], "-", 
         RowBox[{"k4", "/", "c4"}]}], ")"}]}]}], ")"}], 
    RowBox[{"\[Product]", " ", 
     RowBox[{"c_i", "^", "k_i"}]}]}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "0139fac3-85e2-40b4-af64-768e1ea61930"],
 ". The following function applies this operation, and then we can write a \
function (RecombUnsorted) that applies the function sequentially to unsorted \
statistics in c-space."
}], "Text",
 CellChangeTimes->{{3.866551997070841*^9, 3.866552015653597*^9}, {
  3.866554230383066*^9, 3.866554250638155*^9}, {3.866554632782934*^9, 
  3.866554880196154*^9}, {3.884771778556328*^9, 
  3.88477177862029*^9}},ExpressionUUID->"3dd74df5-3c33-4b9c-84e5-\
50f55027dafc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Coefficients", " ", "of", " ", "transition", " ", "for", " ", 
     RowBox[{"cs", ":", " ", "c_i"}]}], " ", "\[Rule]", " ", 
    RowBox[{"c_i", " ", "+", " ", 
     RowBox[{"\[Eta]", " ", "r", " ", "D"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RecombMonome", "[", "monome_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", ",", "k", ",", "vars", ",", "DD", ",", "coeff"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cs", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
          "^", 
         RowBox[{
         "k", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeff", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"monome", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DD", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", " ", "c4"}], "-", 
        RowBox[{"c2", " ", "c3"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", ">", "0"}], ",", 
       RowBox[{"coeff", "*", "vars", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"K", ">", "0"}], ",", 
            RowBox[{"r", " ", "DD", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{
                 "k", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "/", "c1"}], "+", 
               RowBox[{
                RowBox[{
                "k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "/", "c2"}], "+", 
               RowBox[{
                RowBox[{
                "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "/", "c3"}], "-", 
               RowBox[{
                RowBox[{
                "k", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "/", "c4"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}], ",", 
       "monome"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.866553491639883*^9, 3.866553540375498*^9}, {
   3.8665539509942093`*^9, 3.866554083493705*^9}, {3.866554216088108*^9, 
   3.866554220787105*^9}, {3.8665543684676723`*^9, 3.866554386556026*^9}, {
   3.866554472443677*^9, 3.866554472996256*^9}, 3.866555780833953*^9, {
   3.86657716747234*^9, 3.866577188785802*^9}, {3.866577416484889*^9, 
   3.866577423697749*^9}, {3.884771897660265*^9, 3.884771902050929*^9}, 
   3.887291283606394*^9, 3.887296023471904*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"bdf6ebda-0f0f-4262-ab5b-9ae9bebd1489"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Recomb", "[", "term_", "]"}], ":=", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{"RecombMonome", "/@", 
      RowBox[{"ToMonomes", "[", 
       RowBox[{"ToSorted", "[", "term", "]"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RecombUnsorted", "[", "term_", "]"}], ":=", 
   RowBox[{"ToUnsorted", "[", 
    RowBox[{"Plus", "@@", 
     RowBox[{"(", " ", 
      RowBox[{"RecombMonome", "/@", 
       RowBox[{"ToMonomes", "[", 
        RowBox[{"ToSorted", "[", "term", "]"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.866554085001419*^9, 3.8665541272545357`*^9}, {
  3.8665557833848753`*^9, 3.8665557859918137`*^9}, {3.8847719656004543`*^9, 
  3.88477197130824*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"97e1f496-ae00-4724-9c6c-1b0e1137b128"],

Cell["Test this out:", "Text",
 CellChangeTimes->{{3.866554937278434*^9, 
  3.866554940656447*^9}},ExpressionUUID->"d1cf5acb-d0b7-433e-87a9-\
6c1a2a946414"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"Tocs", "[", "DD", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RecombUnsorted", "[", 
  RowBox[{
   RowBox[{"c1", " ", 
    RowBox[{"c4", "/", "2"}]}], "-", 
   RowBox[{"c2", " ", 
    RowBox[{"c3", "/", "2"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{
    RowBox[{"c1", " ", 
     RowBox[{"c4", "/", "2"}]}], "-", 
    RowBox[{"c2", " ", 
     RowBox[{"c3", "/", "2"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8665548879917173`*^9, 3.866554912518565*^9}, {
   3.8665549441560307`*^9, 3.866554976767127*^9}, 3.887291286328536*^9, {
   3.8872960353908873`*^9, 3.88729604375561*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"034ef1cc-3c5b-463b-b2e8-96889599980c"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    47, 1, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962599955673`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"90b10ca8-33b5-4aaf-be43-d1042b3f5a18"],

Cell[BoxData[
 RowBox[{"c1", "-", 
  RowBox[{"p", " ", "q"}]}]], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.866561771950226*^9, 3.887220350405734*^9, {
   3.887282477885203*^9, 3.887282484613394*^9}, 3.887296260055052*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"8dd88d5e-a324-445b-8fd9-9aea6ffd8d6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c2", " ", "c3"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c4"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c2", " ", "c3", " ", "r"}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c2", "2"], " ", "c3", " ", "r"}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", "c2", " ", 
   SuperscriptBox["c3", "2"], " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c1", "2"], " ", "c4", " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c2", " ", "c4", " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c3", " ", "c4", " ", "r"}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c2", " ", "c3", " ", "c4", " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", "c1", " ", 
   SuperscriptBox["c4", "2"], " ", "r"}]}]], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.866561771950226*^9, 3.887220350405734*^9, {
   3.887282477885203*^9, 3.887282484613394*^9}, 3.8872962600561743`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"750283b3-fa23-479d-aac9-ba48f637cc16"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    49, 2, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296260057776*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"7464d501-9967-447f-b7a0-e74eeeb7d303"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r"}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.866561771950226*^9, 3.887220350405734*^9, {
   3.887282477885203*^9, 3.887282484613394*^9}, 3.887296260063143*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"72d8f104-2555-4133-b470-b8843f108f98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"Tocs", "[", "DD", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", "^", "2"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", "^", "3"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.866554404162075*^9, 3.8665544635907993`*^9}, {
  3.866554512172394*^9, 3.8665546130428534`*^9}, {3.866554989800791*^9, 
  3.866554992510648*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"72e27084-2e02-49ef-8d28-102c3e91fd85"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    50, 3, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.88729626007506*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"d8b9d692-a8e7-432f-9111-56ab91c987da"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r"}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866554397473692*^9, 3.866554464838044*^9}, {
   3.866554519172106*^9, 3.866554623449513*^9}, {3.866554982152773*^9, 
   3.866554993244667*^9}, 3.866555793070587*^9, 3.866558729830947*^9, 
   3.8665617741091413`*^9, 3.8872203504563313`*^9, 3.887296260079153*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"3a6fecc2-c87e-4ec4-88b9-7f600cb44a22"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    51, 4, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962600798903`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"d7e12fc3-efc9-4c90-925b-1ac7a6f42ceb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "r"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866554397473692*^9, 3.866554464838044*^9}, {
   3.866554519172106*^9, 3.866554623449513*^9}, {3.866554982152773*^9, 
   3.866554993244667*^9}, 3.866555793070587*^9, 3.866558729830947*^9, 
   3.8665617741091413`*^9, 3.8872203504563313`*^9, 3.8872962600832767`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"9de28326-8fa6-4da9-a892-df7225585343"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    52, 5, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962600839977`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"292aa1fe-9f2f-417f-8814-490c52ca8ea0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], "3"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"3", " ", "r"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866554397473692*^9, 3.866554464838044*^9}, {
   3.866554519172106*^9, 3.866554623449513*^9}, {3.866554982152773*^9, 
   3.866554993244667*^9}, 3.866555793070587*^9, 3.866558729830947*^9, 
   3.8665617741091413`*^9, 3.8872203504563313`*^9, 3.88729626008773*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"9a7c81dd-5949-4ffb-b612-ecc9887c5ab0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Drift", "Subtitle"]], "Subsubtitle",
 CellChangeTimes->{{3.866555463767095*^9, 
  3.866555464759981*^9}},ExpressionUUID->"eea14446-08e9-4e7b-a065-\
3ec4042ca706"],

Cell[TextData[{
 "We can think of a statistic ",
 Cell[BoxData[
  RowBox[{"\[Product]", " ", 
   RowBox[{"c_i", "^", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "fac95b05-761f-460d-a8fd-50ee2a39aa78"],
 " as the probability of drawing a given configuration of two-locus \
haplotypes from  ",
 Cell[BoxData[
  RowBox[{"K", "=", 
   RowBox[{"\[Sum]", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "ca5b507d-0071-40ee-9694-89b098e63166"],
 " lineages. A \[OpenCurlyDoubleQuote]drift event\[CloseCurlyDoubleQuote] \
occurs within our K lineages when one of those lineages copies itself twice, \
replacing one of the other K-1 lineages. This will cause that copied type to \
increase in count and the replace type to decrease in count.\n\nWhat goes \
into the drift operator? The probability that a drift event does ",
 StyleBox["not",
  FontSlant->"Italic"],
 " occur among K lineages is ",
 Cell[BoxData[
  RowBox[{
   SubsuperscriptBox["\[Product]", 
    RowBox[{"i", "=", "1"}], "K"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "1"}], ")"}], "/", "2"}], "/", "Ne"}]}], ")"}]}]], 
  "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "5921310d-6a62-4603-bafb-23c01758b3f6"],
 "which is approximately ",
 Cell[BoxData[
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"K", ",", "2"}], "]"}], "/", "2"}], "/", "Ne"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "62b78835-d550-4eb4-8377-3a164ed26828"],
 ", and the probability of one drift event occurring is ",
 Cell[BoxData[
  RowBox[{"Binomial", "[", 
   RowBox[{"K", ",", "2"}], "]"}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "b7c45c19-eb8f-4aca-b177-e0fe226da03b"],
 ". We ignore more than one drift event occurring, which is O(1/",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ne", "2"], TraditionalForm]],ExpressionUUID->
  "84eb9521-2683-4612-86c5-d2a509bfc813"],
 "), just as we ignored higher order terms in r.\n\nThen in the even that \
probability occurs, we determine the expected increase/decrease in haplotype \
counts, given the term provided."
}], "Text",
 CellChangeTimes->{{3.8665612445192432`*^9, 3.866561404152478*^9}, {
  3.866561784452128*^9, 
  3.866562107792262*^9}},ExpressionUUID->"6c96e922-cdcc-45f5-9e7f-\
7974be5f4680"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DriftMonome", "[", 
   RowBox[{"monome_", ",", "Ne_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "K", ",", "k", ",", "vars", ",", "coeff", ",", "pcoal", ",", "kprev"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pcoal", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"K", ",", "2"}], "]"}], "/", "2"}], "/", "Ne"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cs", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
          "^", 
         RowBox[{
         "k", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeff", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"monome", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", ">", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pcoal"}], ")"}], "*", "coeff", "*", "vars"}], 
        "+", "\[IndentingNewLine]", 
        RowBox[{
        "pcoal", "*", "coeff", "*", "vars", "*", "\[IndentingNewLine]", 
         RowBox[{"Sum", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"kprev", "=", 
             RowBox[{"k", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"i", " ", "increased", " ", "1"}], ",", " ", 
              RowBox[{"j", " ", "decreased", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"i", ".", "e", ".", " ", "copy"}], " ", "type", " ", 
               "i", " ", "over", " ", "j"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K"}]}], ",", 
              "\[IndentingNewLine]", "0", ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"transition", " ", "not", " ", "possible"}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "kprev", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "kprev", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                    RowBox[{
                    "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "/", 
                    RowBox[{
                    "cs", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"transition", " ", "occurs"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "kprev", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "kprev", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
                RowBox[{"(*", " ", 
                 RowBox[{"coalescence", " ", "but", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "change", " ", "state"}], 
                 " ", "*)"}], "\[IndentingNewLine]", "/", "K"}], "/", 
               RowBox[{"(", 
                RowBox[{"K", "-", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "monome"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drift", "[", 
   RowBox[{"term_", ",", "Ne_"}], "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"DriftMonome", "[", 
       RowBox[{"#", ",", "Ne"}], "]"}], "&"}], "/@", 
     RowBox[{"ToMonomes", "[", "term", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.866555794980392*^9, 3.8665559577422657`*^9}, {
   3.866556006977648*^9, 3.8665560128287582`*^9}, {3.866556076298017*^9, 
   3.866556088232374*^9}, {3.8665561379210453`*^9, 3.866556166714699*^9}, {
   3.866556518466511*^9, 3.866556689697435*^9}, {3.866556750527295*^9, 
   3.866556807913457*^9}, {3.8665571094926977`*^9, 3.866557113562207*^9}, {
   3.8665571512679443`*^9, 3.866557154237097*^9}, {3.866557231853441*^9, 
   3.866557232089779*^9}, 3.86655728730099*^9, {3.866557509965497*^9, 
   3.866557552482807*^9}, {3.86655758600814*^9, 3.866557598089033*^9}, {
   3.866557628660087*^9, 3.866557643525772*^9}, {3.866558577523831*^9, 
   3.866558579052698*^9}, {3.866558749154615*^9, 3.8665587511983643`*^9}, 
   3.866558879741498*^9, {3.866558949506627*^9, 3.86655896974541*^9}, {
   3.866570394553712*^9, 3.8665704092615213`*^9}, {3.866577284921359*^9, 
   3.866577304286643*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"bb04c2bc-caa1-4e68-9131-f6cbe1aed486"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"drift", "[", 
   RowBox[{
    RowBox[{"Tocs", "[", "DD", "]"}], ",", "Ne"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.866557057302205*^9, 3.866557071914991*^9}, {
  3.8665576524683447`*^9, 3.866557668755521*^9}, {3.866558599469614*^9, 
  3.866558606713876*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"9e4959c5-c31a-4c04-b8da-8723e3d3d420"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    55, 6, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296260107995*^9},
 CellLabel->
  "During evaluation of \
In[55]:=",ExpressionUUID->"a63758eb-ff54-4582-92cc-d2cc117fe2be"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"c1", "-", 
     RowBox[{"p", " ", "q"}]}], ")"}]}], 
  RowBox[{"2", " ", "Ne"}]]], "Output",
 CellChangeTimes->{
  3.866557072306365*^9, 3.866557242239599*^9, 3.866557291165021*^9, 
   3.8665574583716497`*^9, {3.866557512438797*^9, 3.866557518337215*^9}, {
   3.866557591693758*^9, 3.866557600494104*^9}, {3.866557646679381*^9, 
   3.866557669060481*^9}, {3.866558581492558*^9, 3.866558613551693*^9}, 
   3.8665587330658197`*^9, 3.8665587819537773`*^9, {3.8665589556546173`*^9, 
   3.866558972272105*^9}, 3.8665704193933496`*^9, 3.866577316437666*^9, 
   3.887220350492134*^9, 3.887296260111803*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"e74345ab-401a-4b7b-a197-6ac89ff108a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DriftMonome", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "^", "2"}], " ", 
    RowBox[{"c4", "^", "2"}]}], ",", "NN"}], "]"}]], "Input",
 CellChangeTimes->{{3.866558241257471*^9, 3.8665582944618483`*^9}, 
   3.866558345194829*^9, {3.8665583809713984`*^9, 3.866558381987627*^9}, 
   3.866558478351883*^9, {3.8665586233045683`*^9, 3.866558624681019*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"1272e920-5f03-4f43-ba36-3c0f2182e2e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["c1", "2"], " ", 
   SuperscriptBox["c4", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox["3", "NN"]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["c1", "2"], " ", 
    SuperscriptBox["c4", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "3"], "+", 
      FractionBox["c2", 
       RowBox[{"12", " ", "c1"}]], "+", 
      FractionBox["c3", 
       RowBox[{"12", " ", "c1"}]], "+", 
      FractionBox["c1", 
       RowBox[{"4", " ", "c4"}]], "+", 
      FractionBox["c2", 
       RowBox[{"12", " ", "c4"}]], "+", 
      FractionBox["c3", 
       RowBox[{"12", " ", "c4"}]], "+", 
      FractionBox["c4", 
       RowBox[{"4", " ", "c1"}]]}], ")"}]}], "NN"]}]], "Output",
 CellChangeTimes->{{3.866558278196961*^9, 3.866558294784658*^9}, 
   3.866558346164052*^9, 3.866558382571268*^9, 3.866558479123199*^9, {
   3.866558614646224*^9, 3.8665586319727087`*^9}, 3.866558735311784*^9, 
   3.8665587828097477`*^9, {3.866558956770631*^9, 3.866558973289125*^9}, 
   3.887220350505048*^9, 3.887296260122425*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"6e42c060-8c00-4e4c-a49e-68ed81f5b6d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", "^", "2"}], "]"}], ",", "Ne"}], "]"}], "]"}], "]"}], 
   ",", "DD"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "p"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "q"}]}], ")"}]}], "]"}], ",", "Ne"}], "]"}], "]"}], 
    "]"}], ",", "DD"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", 
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}], "q", 
         RowBox[{"(", 
          RowBox[{"1", "-", "q"}], ")"}]}], "]"}], ",", "Ne"}], "]"}], "]"}], 
    "]"}], ",", "DD"}], "]"}]}], "Input",
 CellChangeTimes->{{3.709032902872877*^9, 3.709032920840023*^9}, {
  3.713699262468418*^9, 3.713699279201479*^9}, {3.71369934380926*^9, 
  3.7136993453290243`*^9}, {3.713779768101837*^9, 3.713779771500746*^9}, {
  3.713781382818722*^9, 3.7137814007705173`*^9}, {3.866558307258851*^9, 
  3.86655831483249*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"73e67e94-e5e9-4ad5-9df8-d1e7677914cf"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    57, 7, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296260156498*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"f013b91c-ad97-49da-89cd-75f980d514f3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"c1", "+", 
   RowBox[{
    SuperscriptBox["c1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}]}], "-", 
   RowBox[{"2", " ", "c1", " ", "q"}], "-", 
   RowBox[{"2", " ", "c1", " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "+", 
         RowBox[{"2", " ", "Ne"}]}], ")"}], " ", "q"}]}], ")"}]}], "+", 
   RowBox[{"p", " ", "q", " ", 
    RowBox[{"(", 
     RowBox[{"p", "+", "q", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", "Ne"}], ")"}], " ", "p", " ", "q"}]}], 
     ")"}]}]}], 
  RowBox[{"2", " ", "Ne"}]]], "Output",
 CellChangeTimes->{
  3.866558315686983*^9, {3.866558767093163*^9, 3.866558783810658*^9}, 
   3.866558974295041*^9, 3.887220350548192*^9, 3.887296260167636*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"11f8a5b9-55b9-4e67-b592-161f915ce59a"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    58, 8, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.88729626071413*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"c762d35c-98d4-4646-926c-00e39c5de188"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c1", "-", 
     RowBox[{"p", " ", "q"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "+", 
     RowBox[{"4", " ", "c1"}], "+", 
     RowBox[{"10", " ", "p"}], "+", 
     RowBox[{"10", " ", "q"}], "-", 
     RowBox[{"24", " ", "p", " ", "q"}], "+", 
     RowBox[{"2", " ", "Ne", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "q"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"2", " ", "Ne"}]]], "Output",
 CellChangeTimes->{
  3.866558315686983*^9, {3.866558767093163*^9, 3.866558783810658*^9}, 
   3.866558974295041*^9, 3.887220350548192*^9, 3.887296260729602*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"b4f36f89-d570-4c7d-be55-c6609f3bdf35"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    59, 9, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962607851543`*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"64be54f5-a190-4e65-a8fc-cfd9273949d5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], "+", 
   RowBox[{"p", " ", "q", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"4", " ", "p"}], "+", 
      RowBox[{"2", " ", "Ne", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "q"}], ")"}]}], "+", 
      RowBox[{"4", " ", "q"}], "-", 
      RowBox[{"6", " ", "p", " ", "q"}]}], ")"}]}]}], 
  RowBox[{"2", " ", "Ne"}]]], "Output",
 CellChangeTimes->{
  3.866558315686983*^9, {3.866558767093163*^9, 3.866558783810658*^9}, 
   3.866558974295041*^9, 3.887220350548192*^9, 3.8872962607996264`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"1f5e3b97-4e1d-4e13-ae1f-6f4f6c7bd2d3"]
}, Open  ]],

Cell["We can combine drift and recombination:", "Text",
 CellChangeTimes->{{3.866559040300219*^9, 
  3.866559044320545*^9}},ExpressionUUID->"d1c1167d-b45b-4a16-8537-\
b70ce73e3c52"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"pqDunsorted", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"drift", "[", 
     RowBox[{
      RowBox[{"RecombUnsorted", "[", 
       RowBox[{"Tocs", "[", "DD", "]"}], "]"}], ",", "Ne"}], "]"}], "]"}], 
   "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"pqDunsorted", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"RecombUnsorted", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", "DD", "]"}], ",", "Ne"}], "]"}], "]"}], "]"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.708103598887712*^9, 3.708103617474635*^9}, {
   3.7137115104636*^9, 3.713711514647459*^9}, 3.866559016187646*^9, {
   3.8665590463496723`*^9, 3.866559076439638*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"0305386c-2ef8-4467-85f4-dad15174e7ea"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    60, 10, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296260820136*^9},
 CellLabel->
  "During evaluation of \
In[60]:=",ExpressionUUID->"5cac536e-b26e-4e68-ad00-e186e5330678"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{3.866559078870782*^9, 3.88722035072007*^9, 
  3.8872962608248787`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"66176fa8-6630-4495-9363-646f25a5edbe"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    61, 11, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962608370037`*^9},
 CellLabel->
  "During evaluation of \
In[60]:=",ExpressionUUID->"f4005819-a8c5-4304-b2b6-9d541bbb1238"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{3.866559078870782*^9, 3.88722035072007*^9, 
  3.887296260842613*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"20215f10-b90b-4c37-a760-7aae7b1f13d7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"driftrecomb", "[", "term_", "]"}], ":=", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"drift", "[", 
    RowBox[{"term", ",", "Ne"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708104964260859*^9, 3.7081050856358433`*^9}, {
   3.708106876654913*^9, 3.708106886853663*^9}, {3.866559157656253*^9, 
   3.866559159635529*^9}, 3.866559202675125*^9, {3.866577225167461*^9, 
   3.866577228840172*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"7a0ac765-6d7f-4c38-a1d5-ec9a3ee6ec67"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"PolynomialReduce", "[", 
   RowBox[{
    RowBox[{"pqDunsorted", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"driftrecomb", "[", 
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", " ", "^", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], ",", 
      RowBox[{"DD", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "q"}]}], ")"}]}], ",", 
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "q", 
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"DD", ",", "p", ",", "q"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"PolynomialReduce", "[", 
   RowBox[{
    RowBox[{"pqDunsorted", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"driftrecomb", "[", 
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "p"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "q"}]}], ")"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], ",", 
      RowBox[{"DD", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "q"}]}], ")"}]}], ",", 
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "q", 
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"DD", ",", "p", ",", "q"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"PolynomialReduce", "[", 
   RowBox[{
    RowBox[{"pqDunsorted", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"driftrecomb", "[", 
       RowBox[{"Tocs", "[", 
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}], "q", 
         RowBox[{"(", 
          RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], ",", 
      RowBox[{"DD", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "q"}]}], ")"}]}], ",", 
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "q", 
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"DD", ",", "p", ",", "q"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.709032902872877*^9, 3.709032920840023*^9}, {
   3.713699262468418*^9, 3.713699279201479*^9}, {3.71369934380926*^9, 
   3.7136993453290243`*^9}, {3.713779768101837*^9, 3.713779771500746*^9}, 
   3.713781382818722*^9, {3.7137829715702457`*^9, 3.713783161873795*^9}, 
   3.7137832474820747`*^9, {3.713783605887744*^9, 3.713783610286479*^9}, {
   3.866559219557336*^9, 3.866559267351377*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"5e7e3695-791b-4f3e-b014-090ea8a4080d"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    63, 12, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296260998625*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"0d9b2bc6-6c39-4168-a330-d8c8a818925e"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 63, 13, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962610429497`*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"7417b692-e675-4870-9e44-5d27ec1dac7b"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["c1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{"Ne", " ", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"4", " ", "r"}]}], ")"}]}], "+", 
        RowBox[{"6", " ", "r"}]}], ")"}]}], "+", 
     RowBox[{"p", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{"p", "+", "q", "+", "r", "-", 
        RowBox[{"2", " ", "p", " ", "r"}], "-", 
        RowBox[{"2", " ", "q", " ", "r"}], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "Ne", "+", 
           RowBox[{"5", " ", "r"}], "-", 
           RowBox[{"2", " ", "Ne", " ", "r"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "q"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", 
        RowBox[{"2", " ", "p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r", "+", 
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{"5", "-", 
              RowBox[{"2", " ", "Ne"}], "-", 
              RowBox[{"8", " ", "r"}], "+", 
              RowBox[{"4", " ", "Ne", " ", "r"}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], 
    RowBox[{"2", " ", "Ne"}]], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c2", " ", "c3"}], "-", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}], ",", "p", ",", "q"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.866559227495386*^9, 3.866559267838496*^9}, 
   3.866577206876555*^9, 3.866577327601013*^9, 3.866577437214408*^9, 
   3.887220350889243*^9, 3.887296261048552*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"e0720d09-9d16-45a5-8792-8fa9d538d68d"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    64, 14, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261463957*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"e382b55d-ae30-484f-9434-5653ce60e95d"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 64, 15, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261491907*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"b35705ef-9c2a-4d7f-88d0-9111e9dc42d9"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c1", "-", 
        RowBox[{"p", " ", "q"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"5", "-", 
        RowBox[{"10", " ", "p"}], "-", 
        RowBox[{"10", " ", "q"}], "+", 
        RowBox[{"24", " ", "p", " ", "q"}], "+", 
        RowBox[{"2", " ", "Ne", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "p"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "q"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "-", 
        RowBox[{"5", " ", "r"}], "+", 
        RowBox[{"10", " ", "p", " ", "r"}], "+", 
        RowBox[{"10", " ", "q", " ", "r"}], "-", 
        RowBox[{"28", " ", "p", " ", "q", " ", "r"}], "+", 
        RowBox[{"c1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", 
           RowBox[{"8", " ", "r"}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"2", " ", "Ne"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c2", " ", "c3"}], "-", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}], ",", "p", ",", "q"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.866559227495386*^9, 3.866559267838496*^9}, 
   3.866577206876555*^9, 3.866577327601013*^9, 3.866577437214408*^9, 
   3.887220350889243*^9, 3.887296261498549*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"06ec9b74-8944-4990-bea0-6c86bcac9818"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    65, 16, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261658906*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"3dbda5e6-e9a8-436b-ad5e-da887bb9e2e2"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 65, 17, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261679639*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"bee119e9-a7f0-4f98-ad1c-83ea8380eec4"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "c1"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "q"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", 
     RowBox[{"p", " ", "q", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{"2", " ", "Ne", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}], ")"}]}], "+", 
        RowBox[{"4", " ", "q"}], "+", "r", "-", 
        RowBox[{"2", " ", "q", " ", "r"}], "+", 
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{"4", "-", 
           RowBox[{"6", " ", "q"}], "-", 
           RowBox[{"2", " ", "r"}], "+", 
           RowBox[{"4", " ", "q", " ", "r"}]}], ")"}]}]}], ")"}]}]}], 
    RowBox[{"2", " ", "Ne"}]], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c2", " ", "c3"}], "-", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}], ",", "p", ",", "q"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.866559227495386*^9, 3.866559267838496*^9}, 
   3.866577206876555*^9, 3.866577327601013*^9, 3.866577437214408*^9, 
   3.887220350889243*^9, 3.8872962616873617`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"2cd03f2e-907f-49e3-91df-8fb2e92d3481"]
}, Open  ]],

Cell[TextData[{
 "Above, there are r/Ne terms that we would ignore (as we ignored ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "2"], TraditionalForm]],ExpressionUUID->
  "5368777e-1a81-4a41-955d-79ca48b2d4be"],
 " terms and 1/",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ne", "2"], TraditionalForm]],ExpressionUUID->
  "ab423d10-2f14-4375-a655-0a174ae558bb"],
 " terms)."
}], "Text",
 CellChangeTimes->{{3.866559319592231*^9, 
  3.8665593567860727`*^9}},ExpressionUUID->"c12e1f0f-7652-4d48-a063-\
30fc9be63a73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutation", "Subtitle",
 CellChangeTimes->{{3.866562124089957*^9, 
  3.866562124677462*^9}},ExpressionUUID->"d44b79df-f145-4a93-bc50-\
9d5a6d1d4901"],

Cell["\<\
The infinite sites model (ISM), in which only a single mutation occurs at the \
left and right loci.

This construction is a bit contrived, and it\[CloseCurlyQuote]s maybe a bit \
more natural to think of a reversible mutation model in the two-locus \
setting. However, the ISM gives us a simple mutation operator, so that \
single-locus statistics p(1-p) and q(1-q) increase linearly in the mutation \
rate (balanced by drift), and two-locus statistics are unchanged by mutation \
except for the joint heterozygosity p(1-p)q(1-q), which increases as \
u(p(1-p)+q(1-q)).\
\>", "Text",
 CellChangeTimes->{{3.8665621479617357`*^9, 3.866562153075098*^9}, {
   3.866584307746313*^9, 3.866584309852542*^9}, {3.866584354318667*^9, 
   3.8665844577868156`*^9}, {3.8665845534689283`*^9, 3.866584681074524*^9}, 
   3.866584759415875*^9},ExpressionUUID->"528e3cbe-9c6b-44fc-bb4d-\
f0a2ffa0970a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMonomespqD", "[", "t_", "]"}], ":=", 
  RowBox[{"MonomialList", "[", 
   RowBox[{"t", ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.86656285474113*^9, 3.8665628692609262`*^9}, {
  3.8665763316766644`*^9, 3.8665763416032553`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"723e3d04-781a-43a4-9f42-0d74d859d996"],

Cell["\<\
The mutation operator is much simpler to apply in p-q-D space, rather than \
c-space...\
\>", "Text",
 CellChangeTimes->{{3.866584767303543*^9, 
  3.8665847865604362`*^9}},ExpressionUUID->"7571f009-14c7-4611-918a-\
162503f40d46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MutateMonomespqD", "[", 
   RowBox[{"monome_", ",", "u_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", "K", ",", "vars", ",", "coeff"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Here", ",", " ", 
      RowBox[{"a", " ", "monome", " ", "is", " ", 
       RowBox[{"p", "^", "k1"}], " ", 
       RowBox[{"q", "^", "k2"}], " ", 
       RowBox[{"D", "^", "k3"}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"Exponent", "[", 
       RowBox[{"monome", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{
       RowBox[{"p", "^", 
        RowBox[{"k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       RowBox[{"q", "^", 
        RowBox[{"k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       RowBox[{"DD", "^", 
        RowBox[{
        "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", "\[Equal]", "0"}], ",", "monome", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeff", "=", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"monome", ",", "vars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coeff", "*", 
         RowBox[{"(", 
          RowBox[{"vars", "\[IndentingNewLine]", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Equal]", "0"}], "&&", 
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"u", "*", 
              RowBox[{"q", "^", 
               RowBox[{
               "k", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             "0"}], "]"}], "\[IndentingNewLine]", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Equal]", "0"}], "&&", 
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"u", "*", 
              RowBox[{"p", "^", 
               RowBox[{
               "k", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             "0"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"mutatepqD", "[", "term_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"MutateMonomespqD", "[", 
       RowBox[{"#", ",", "u"}], "]"}], "&"}], "/@", 
     RowBox[{"ToMonomespqD", "[", "term", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.866568240983268*^9, 3.866568270416985*^9}, {
   3.866568440366432*^9, 3.866568663993638*^9}, {3.8665688232808447`*^9, 
   3.86656883466367*^9}, {3.8665694226839867`*^9, 3.866569511935463*^9}, {
   3.866569571863986*^9, 3.866569577073422*^9}, 3.866569630792643*^9, {
   3.866569964053212*^9, 3.866570030345414*^9}, {3.866570113074029*^9, 
   3.866570155255253*^9}, {3.866570496231598*^9, 3.86657065118402*^9}, {
   3.866570698190411*^9, 3.866570755816284*^9}, 3.8665708123389463`*^9, {
   3.866570908033476*^9, 3.866570918938554*^9}, {3.866570950282754*^9, 
   3.866570960158103*^9}, {3.866574412195513*^9, 3.866574515113336*^9}, {
   3.866574603774395*^9, 3.8665746309423103`*^9}, {3.866574663116518*^9, 
   3.866575026488743*^9}, {3.866575068573234*^9, 3.8665751466906557`*^9}, {
   3.866575220029718*^9, 3.866575291552993*^9}, 3.866575323304879*^9, {
   3.866575461020411*^9, 3.866575489609087*^9}, {3.8665755242884703`*^9, 
   3.866575762707724*^9}, {3.866575894207428*^9, 3.866576030995266*^9}, {
   3.8665761464790277`*^9, 3.866576164184738*^9}, {3.866576204141224*^9, 
   3.866576206670355*^9}, {3.866576259246331*^9, 3.8665762815572033`*^9}, {
   3.8665765223587103`*^9, 3.8665767050051203`*^9}, {3.866576763117721*^9, 
   3.866576770194171*^9}, {3.86657762280608*^9, 3.866577634711931*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"939b21b8-e5a3-45f7-88df-df1a8549caaa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "]"}], "-", 
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.866576011104019*^9, 3.866576053418261*^9}, {
  3.86657617820438*^9, 3.866576239133795*^9}, {3.866576748622472*^9, 
  3.866576758662352*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"6894c8c5-1be8-4978-9125-076b8f6ad6f3"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 69, 18, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261748014*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"0a91fd4c-449e-4dc7-8a57-fd2f7cb74285"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 69, 19, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261754188*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"d763dcfe-e2cc-42da-951d-7c56f1612076"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "p"}], ",", 
   RowBox[{"-", "p"}], ",", 
   RowBox[{"-", "p"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.866576759014266*^9, 3.8665767755073423`*^9}, 
   3.8665774437745953`*^9, 3.887220351430808*^9, 3.887296261759213*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"444f0a7b-e213-4938-b021-6c98d73511fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"DD", "^", "2"}], "]"}], "-", 
   RowBox[{"DD", "^", "2"}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], "]"}], "-", 
   RowBox[{"DD", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "p"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "q"}]}], ")"}]}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "-", 
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "q", 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.866576245019402*^9, 3.866576245173414*^9}, {
  3.8665763701221943`*^9, 3.866576389640358*^9}, {3.8665767218463097`*^9, 
  3.866576725563469*^9}, {3.866584480577897*^9, 3.866584516275036*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"2f491b85-e088-48ea-91af-5cb4bf6c029e"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 70, 20, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261773365*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"29d65a71-32e4-40d5-b214-f58d0ed978ec"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 70, 21, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261778615*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"746b7161-1a03-4768-8c56-fc62a12afdce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.866576245596253*^9, 3.86657628658751*^9, {3.866576347820075*^9, 
   3.866576390052059*^9}, 3.866576597725399*^9, {3.8665767094759693`*^9, 
   3.866576726021802*^9}, 3.866576777378867*^9, 3.866577445253089*^9, 
   3.866577611568569*^9, 3.866577645059973*^9, 3.866584516775796*^9, 
   3.887220351441169*^9, 3.88729626178316*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"91822092-bbe5-4560-858f-c2fc05c20b6a"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 71, 22, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261784211*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"a756dd29-23e5-4f0a-9a01-607e9837f397"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 71, 23, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261791956*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"2adda851-879c-4385-b682-b5afea7784e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c2", " ", "c3"}], "-", 
      RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c2", " ", "c3"}], "-", 
      RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c2", " ", "c3"}], "-", 
      RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.866576245596253*^9, 3.86657628658751*^9, {3.866576347820075*^9, 
   3.866576390052059*^9}, 3.866576597725399*^9, {3.8665767094759693`*^9, 
   3.866576726021802*^9}, 3.866576777378867*^9, 3.866577445253089*^9, 
   3.866577611568569*^9, 3.866577645059973*^9, 3.866584516775796*^9, 
   3.887220351441169*^9, 3.8872962617971897`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"d21c7ee7-8916-4078-ba02-dcd586e03484"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 72, 24, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261798397*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"dc0bdc6d-b17a-4619-9f45-0b3985362c02"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 72, 25, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261803299*^9},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"a4b34184-dab0-4c04-bab1-148d6009cfe7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p", " ", "q", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p", "+", "q"}], ")"}]}], ",", 
   RowBox[{"p", " ", "q", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p", "+", "q"}], ")"}]}], ",", 
   RowBox[{"p", " ", "q", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p", "+", "q"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.866576245596253*^9, 3.86657628658751*^9, {3.866576347820075*^9, 
   3.866576390052059*^9}, 3.866576597725399*^9, {3.8665767094759693`*^9, 
   3.866576726021802*^9}, 3.866576777378867*^9, 3.866577445253089*^9, 
   3.866577611568569*^9, 3.866577645059973*^9, 3.866584516775796*^9, 
   3.887220351441169*^9, 3.8872962618084183`*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"7892bde0-250a-4601-94f5-8537fd906031"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mutatepqD", "[", 
   RowBox[{
    RowBox[{"p", "^", "2"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "^", "2"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.866576289378665*^9, 3.866576298118928*^9}, {
  3.866576360064986*^9, 3.866576362370843*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"2967b2cc-04ab-4048-a8e5-1fc8b12984f3"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 73, 26, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962618251*^9},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"b189be87-86f0-4fbd-8ef8-b55880b20079"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 73, 27, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296261830655*^9},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"f6632c40-5884-4ae5-9759-af9ff35060cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["p", "4"], ",", 
   SuperscriptBox["p", "4"], ",", 
   SuperscriptBox["p", "4"]}], "}"}]], "Output",
 CellChangeTimes->{{3.866576295258511*^9, 3.866576298553335*^9}, {
   3.866576349586447*^9, 3.866576362861701*^9}, 3.866576601496724*^9, 
   3.8665767354571323`*^9, 3.8665767792179193`*^9, 3.866577446329763*^9, 
   3.866577648212039*^9, 3.887220351452739*^9, 3.8872962618353167`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"f3655733-26bd-490a-8a7b-d3e1937b9a3f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutatedriftrecomb", "[", "term_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"driftrecomb", "[", 
     RowBox[{"Tocs", "[", 
      RowBox[{"mutatepqD", "[", "term", "]"}], "]"}], "]"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.866569167261849*^9, 3.8665691690077267`*^9}, {
  3.866570317948985*^9, 3.866570360908865*^9}, {3.8665704315127*^9, 
  3.866570435706027*^9}, {3.866574536040612*^9, 3.866574575736442*^9}, {
  3.8665768176489973`*^9, 3.866576830471183*^9}, {3.866576941746621*^9, 
  3.866576959814362*^9}, {3.8665770268661118`*^9, 3.866577036421327*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"734903f8-cde0-41da-ba90-0c3e5dbe12f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "]"}], "-", 
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.866576962510611*^9, 3.86657700100712*^9}, {
  3.866577100772524*^9, 3.866577103252489*^9}, {3.8665774582779837`*^9, 
  3.866577521978351*^9}, {3.866577557127714*^9, 3.8665775606760187`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"01e69b4d-ba78-4ce4-a0e0-242331a074c5"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 75, 28, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872203515112047`*^9, 3.887296261852919*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"052b82d3-8ae9-4470-8177-4ad87424bd4d"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 75, 29, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872203515112047`*^9, 3.8872962618576107`*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"475627fc-f710-416b-9339-e36bc4ddbf63"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 75, 30, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872203515112047`*^9, 3.887296261888258*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"7d683db1-7f10-49d4-b164-5e42522c0372"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    75, 31, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872203515112047`*^9, 3.887296261893031*^9},
 CellLabel->
  "During evaluation of \
In[75]:=",ExpressionUUID->"5d46b803-46d8-491a-8fb6-4fdef95ebe33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "p"}], "+", 
  SuperscriptBox["p", "2"], "+", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pcoal$10096"}], ")"}], " ", "coeff$10096", " ", 
      "vars$10096"}], "+", 
     RowBox[{"pcoal$10096", " ", "coeff$10096", " ", "vars$10096", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "4"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "4"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kprev$10096", "=", 
           RowBox[{"k$10096", "-", 
            RowBox[{"e", "[", "i", "]"}], "+", 
            RowBox[{"e", "[", "j", "]"}]}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "kprev$10096", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "<", "1"}], "||", 
             RowBox[{
              RowBox[{
              "kprev$10096", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], ">", "K$10096"}]}], ",", "0", ",", 
            FractionBox[
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{
                 "kprev$10096", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{
                 "kprev$10096", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{
                 "cs", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
                ",", 
               RowBox[{
                RowBox[{
                "kprev$10096", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "kprev$10096", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"K$10096", " ", 
              RowBox[{"(", 
               RowBox[{"K$10096", "-", "1"}], ")"}]}]]}], "]"}]}], 
         ")"}]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"5", " ", 
          SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], " ", "c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["5", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}], 
   "]"}], "+", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pcoal$10097"}], ")"}], " ", "coeff$10097", " ", 
      "vars$10097"}], "+", 
     RowBox[{"pcoal$10097", " ", "coeff$10097", " ", "vars$10097", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "4"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "4"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kprev$10097", "=", 
           RowBox[{"k$10097", "-", 
            RowBox[{"e", "[", "i", "]"}], "+", 
            RowBox[{"e", "[", "j", "]"}]}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "kprev$10097", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "<", "1"}], "||", 
             RowBox[{
              RowBox[{
              "kprev$10097", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], ">", "K$10097"}]}], ",", "0", ",", 
            FractionBox[
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{
                 "kprev$10097", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{
                 "kprev$10097", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{
                 "cs", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
                ",", 
               RowBox[{
                RowBox[{
                "kprev$10097", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "kprev$10097", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"K$10097", " ", 
              RowBox[{"(", 
               RowBox[{"K$10097", "-", "1"}], ")"}]}]]}], "]"}]}], 
         ")"}]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"5", " ", 
          SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], " ", "c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["5", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}], 
   "]"}], "+", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pcoal$10098"}], ")"}], " ", "coeff$10098", " ", 
      "vars$10098"}], "+", 
     RowBox[{"pcoal$10098", " ", "coeff$10098", " ", "vars$10098", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "4"], 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"j", "=", "1"}], "4"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kprev$10098", "=", 
           RowBox[{"k$10098", "-", 
            RowBox[{"e", "[", "i", "]"}], "+", 
            RowBox[{"e", "[", "j", "]"}]}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "kprev$10098", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "<", "1"}], "||", 
             RowBox[{
              RowBox[{
              "kprev$10098", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], ">", "K$10098"}]}], ",", "0", ",", 
            FractionBox[
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{
                 "kprev$10098", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{
                 "kprev$10098", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], " ", 
                 RowBox[{
                 "cs", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]],
                ",", 
               RowBox[{
                RowBox[{
                "kprev$10098", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "kprev$10098", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"K$10098", " ", 
              RowBox[{"(", 
               RowBox[{"K$10098", "-", "1"}], ")"}]}]]}], "]"}]}], 
         ")"}]}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"5", " ", 
          SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], " ", "c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["5", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.8665769670750628`*^9, 3.866576997475501*^9}, 
   3.866577038328718*^9, 3.866577103648015*^9, 3.866577218150243*^9, 
   3.8665773809320297`*^9, {3.8665774483702507`*^9, 3.866577522388764*^9}, 
   3.8665775610591*^9, 3.887220351531266*^9, 3.887296261905115*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"b06d9e35-e62d-4da6-a688-abd0e1b95fed"]
}, Open  ]],

Cell[TextData[{
 "With mutation, drift, and recombination, we can get the Hill-Robertson \
system of equations for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["D", "2"], TraditionalForm]],ExpressionUUID->
  "e75c2523-e76a-49b7-89ff-1d8097bcfe16"],
 ".\n\nNote that although we don\[CloseCurlyQuote]t have 1/Ne^2 or r^2 terms, \
or higher, they contain r/Ne terms, which we would also typically ignore."
}], "Text",
 CellChangeTimes->{{3.8665838927578993`*^9, 3.866583952671402*^9}, {
  3.866584003885673*^9, 
  3.8665840869900827`*^9}},ExpressionUUID->"cfa6a3c5-db13-4001-b79e-\
44d0c775c403"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"basis1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"DD", "^", "2"}], ",", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], ",", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], ",", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], ",", 
    RowBox[{"q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.866576854805629*^9, 3.866576890693565*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"4c05ba30-55a0-4d2a-9e76-49d28066101c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}]], "Output",
 CellChangeTimes->{3.86657689204601*^9, 3.866577040684642*^9, 
  3.866577568358522*^9, 3.866583938688264*^9, 3.8872203515423307`*^9, 
  3.887296261920439*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"2b3a376a-2ee6-48b9-b0eb-bc8ee08b4f44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.866576895810225*^9, 3.866576932953076*^9}, {
  3.8665769757325907`*^9, 3.866576980012375*^9}, {3.866577048604439*^9, 
  3.866577054528633*^9}, {3.866584153285893*^9, 3.866584175726635*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"3bb69849-2be3-4eb1-b786-3f966c43c217"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 77, 32, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261933573*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"e977b1cd-852b-42fa-8a25-2df8064e2719"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 77, 33, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261937831*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"912a0b66-1554-4919-a64d-3094afc2b616"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 77, 34, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962619412127`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"e58125e9-050c-4ba4-be85-927b67488377"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    77, 35, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261944704*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"eb752298-df57-4a31-929b-4e893d3a2651"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 77, 36, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962619482517`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"30185c1b-bd90-49db-8d98-996d43963c21"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 77, 37, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261951929*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"6d04d7cc-d1f1-4221-8afe-22fe76dd3819"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10164"}], ")"}], " ", "coeff$10164", " ", 
        "vars$10164"}], "+", 
       RowBox[{"pcoal$10164", " ", "coeff$10164", " ", "vars$10164", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10164", "=", 
             RowBox[{"k$10164", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10164", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10164", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10164"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10164", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10164", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10164", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10164", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10164", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10164", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["3", "8"], " ", 
          SuperscriptBox["c1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "c1", "-", "p", "-", "q"}], ")"}], "2"]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["3", "4"]}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "q"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "c1", "-", "p", "-", "q"}], ")"}]}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          FractionBox["3", "8"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "q"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10165"}], ")"}], " ", "coeff$10165", " ", 
        "vars$10165"}], "+", 
       RowBox[{"pcoal$10165", " ", "coeff$10165", " ", "vars$10165", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10165", "=", 
             RowBox[{"k$10165", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10165", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10165", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10165"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10165", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10165", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10165", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10165", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10165", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10165", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["3", "8"], " ", 
          SuperscriptBox["c1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "c1", "-", "p", "-", "q"}], ")"}], "2"]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["3", "4"]}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "q"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "c1", "-", "p", "-", "q"}], ")"}]}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          FractionBox["3", "8"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "q"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10166"}], ")"}], " ", "coeff$10166", " ", 
        "vars$10166"}], "+", 
       RowBox[{"pcoal$10166", " ", "coeff$10166", " ", "vars$10166", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10166", "=", 
             RowBox[{"k$10166", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10166", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10166", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10166"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10166", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10166", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10166", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10166", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10166", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10166", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["3", "8"], " ", 
          SuperscriptBox["c1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "c1", "-", "p", "-", "q"}], ")"}], "2"]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["3", "4"]}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "q"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "c1", "-", "p", "-", "q"}], ")"}]}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          FractionBox["3", "8"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "q"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195579891*^9, 3.887220351561675*^9, 3.887296261957395*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"5afb6f7b-f14d-475a-aede-3810e0c1f145"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 78, 38, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261960289*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"5856e373-17df-44e4-a1fa-9adce634532a"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 78, 39, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962619641733`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"a9c8cb9c-4baa-46c8-abc7-2991c7e47cda"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "dotsh", 
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
FractionBox[\\\"1\\\", RowBox[{\\\"Multinomial\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"\
\[Infinity]\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}]}], \
\\\"]\\\"}]], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
FractionBox[\\\"1\\\", RowBox[{\\\"Multinomial\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"\
\[Infinity]\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}]}], \
\\\"]\\\"}]], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
FractionBox[\\\"1\\\", RowBox[{\\\"Multinomial\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"\
\[Infinity]\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}]}], \
\\\"]\\\"}]], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\
\", \\\"0\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \\\"0\\\", \
\\\"}\\\"}]}], \\\"}\\\"}]\\) have incompatible shapes.\"", 2, 78, 40, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962619678087`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"2c5f1333-f944-4a66-a95b-8e5d56c13bb5"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 78, 41, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261986786*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"c3a39dd9-035c-4c2a-bf78-952821652a7d"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 78, 42, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261990325*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"4dcfa65e-8fe3-4a10-ae2b-c83e0970fef7"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    78, 43, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962619934893`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"fc214b02-4869-4bcc-a23b-ae152d6c209f"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 78, 44, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296261996517*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"db2956fa-fbfd-4478-a802-09952245df2f"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 78, 45, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962619996443`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"e3e410e0-ba80-43bf-8167-c4bbb0227a35"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       FractionBox["1", 
        RowBox[{"Multinomial", "[", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}]}], "]"}]], "}"}], ",", 
      RowBox[{"{", 
       FractionBox["1", 
        RowBox[{"Multinomial", "[", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}]}], "]"}]], "}"}], ",", 
      RowBox[{"{", 
       FractionBox["1", 
        RowBox[{"Multinomial", "[", 
         RowBox[{
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}], ",", 
          RowBox[{"-", "\[Infinity]"}]}], "]"}]], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195579891*^9, 3.887220351561675*^9, 3.887296262002997*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"54de6180-3d15-4de2-bb9f-20a9e43e1f09"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 79, 46, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262004154*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"b5b349d9-1647-4e18-ba5e-f47428635604"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 79, 47, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262007365*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"ae7ce407-e609-4ae2-9514-3357ef6a448a"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "dotsh", 
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\
\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", FractionBox[\\\
\"1\\\", \\\"6\\\"]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\
\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", FractionBox[\\\
\"1\\\", \\\"6\\\"]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\
\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", FractionBox[\\\
\"1\\\", \\\"6\\\"]}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", RowBox[{\\\"2\\\", \
\\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \\\"c2\\\"}], \\\
\",\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \
\\\" \\\", \\\"c3\\\"}], \\\",\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \
\\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", \\\"c2\\\", \\\" \\\", \\\"c3\\\"}], \\\",\\\", RowBox[{SuperscriptBox[\
\\\"c1\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}], \
\\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"2\\\"], \\\" \\\", \\\"c3\\\"}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \\\"c2\\\", \\\" \\\", \
SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}], \\\",\\\", RowBox[{SuperscriptBox[\\\
\"c2\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \
\\\"4\\\"], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \\\"c2\\\"}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \
\\\", \\\"c3\\\"}], \\\",\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \
\\\" \\\", SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", \\\"c2\\\", \\\" \\\", \\\"c3\\\"}], \\\",\\\", RowBox[{SuperscriptBox[\
\\\"c1\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}], \
\\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"2\\\"], \\\" \\\", \\\"c3\\\"}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \\\"c2\\\", \\\" \\\", \
SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}], \\\",\\\", RowBox[{SuperscriptBox[\\\
\"c2\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \
\\\"4\\\"], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \\\"c2\\\"}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \
\\\", \\\"c3\\\"}], \\\",\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \
\\\" \\\", SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", \\\"c2\\\", \\\" \\\", \\\"c3\\\"}], \\\",\\\", RowBox[{SuperscriptBox[\
\\\"c1\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}], \
\\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"2\\\"], \\\" \\\", \\\"c3\\\"}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \\\"c2\\\", \\\" \\\", \
SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}], \\\",\\\", RowBox[{SuperscriptBox[\\\
\"c2\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c3\\\", \\\"2\\\"]}]}], \
\\\"}\\\"}]}], \\\"}\\\"}]\\) have incompatible shapes.\"", 2, 79, 48, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262010441*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"7445c01d-53cb-4c3b-883c-6fc7f1418649"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 79, 49, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262016214*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"14a67c6d-4e0e-4be0-8ab7-176783a395b1"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 79, 50, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620192833`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"2b394101-3cc7-4e41-b7cc-3b3b351dcafd"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    79, 51, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262022307*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"d42feb83-8c0f-4c38-acfa-188637c99da1"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "dotsh", 
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\
\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", FractionBox[\\\
\"1\\\", \\\"6\\\"]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\
\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", FractionBox[\\\
\"1\\\", \\\"6\\\"]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\
\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"12\\\"], \\\",\\\", FractionBox[\\\
\"1\\\", \\\"6\\\"]}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", RowBox[{\\\"2\\\", \
\\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\
\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}]}], \\\",\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\
\"+\\\", \\\"q\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\
\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}], \
\\\"2\\\"]}], \\\",\\\", RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \
\\\"2\\\"], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}], \
\\\"2\\\"]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", RowBox[{\\\"2\\\", \
\\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\
\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}]}], \\\",\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\
\"+\\\", \\\"q\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\
\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}], \
\\\"2\\\"]}], \\\",\\\", RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \
\\\"2\\\"], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}], \
\\\"2\\\"]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", RowBox[{\\\"2\\\", \
\\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\
\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}]}], \\\",\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\
\"+\\\", \\\"q\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\
\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"c1\\\", \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}], \
\\\"2\\\"]}], \\\",\\\", RowBox[{SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \
\\\"2\\\"], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"q\\\"}], \\\")\\\"}], \
\\\"2\\\"]}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\) have incompatible shapes.\"", 2,
    79, 52, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.88729626202538*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"5596a113-f73f-408c-b62c-1c4832adecbc"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 79, 53, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620324097`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"7f8162f5-bb49-4860-ae6f-8e30edde2052"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 79, 54, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620355577`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"5be6318f-e431-496a-a4c0-e72f091fea20"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "6"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "6"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "12"], ",", 
        FractionBox["1", "6"]}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "4"], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "q"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}], ",", 
        RowBox[{"2", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], ",", 
        RowBox[{"2", " ", "c1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "4"], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "q"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}], ",", 
        RowBox[{"2", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], ",", 
        RowBox[{"2", " ", "c1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "4"], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "q"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}], ",", 
        RowBox[{"2", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], ",", 
        RowBox[{"2", " ", "c1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "q"}], ")"}], "2"]}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195579891*^9, 3.887220351561675*^9, 3.887296262039515*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"15b97fec-d21e-454a-a169-effa3e2cca44"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 80, 55, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262041432*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"fc52b1ac-d4a8-4a2a-9608-f072973c11a9"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 80, 56, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620449247`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"53e5df1f-5e7c-43e4-bc11-f894e79330fe"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 80, 57, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262047997*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"646b329b-a81c-4a79-a7b1-577f11642b21"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    80, 58, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262051199*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"88dacda3-753d-4016-93e0-bef98310659f"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 80, 59, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620543747`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"e5fc7513-0143-4977-86fe-9d25a59d0d56"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 80, 60, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262057519*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"bfad6c27-807c-485f-8fe6-b3de84abf3d4"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10348"}], ")"}], " ", "coeff$10348", " ", 
        "vars$10348"}], "+", 
       RowBox[{"pcoal$10348", " ", "coeff$10348", " ", "vars$10348", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10348", "=", 
             RowBox[{"k$10348", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10348", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10348", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10348"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10348", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10348", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10348", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10348", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10348", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10348", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10349"}], ")"}], " ", "coeff$10349", " ", 
        "vars$10349"}], "+", 
       RowBox[{"pcoal$10349", " ", "coeff$10349", " ", "vars$10349", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10349", "=", 
             RowBox[{"k$10349", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10349", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10349", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10349"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10349", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10349", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10349", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10349", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10349", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10349", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10350"}], ")"}], " ", "coeff$10350", " ", 
        "vars$10350"}], "+", 
       RowBox[{"pcoal$10350", " ", "coeff$10350", " ", "vars$10350", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10350", "=", 
             RowBox[{"k$10350", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10350", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10350", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10350"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10350", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10350", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10350", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10350", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10350", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10350", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195579891*^9, 3.887220351561675*^9, 3.887296262061607*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"eb5aedc5-93ab-40d5-8f90-d91f14752141"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 81, 61, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620637207`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"894f3e04-b6e4-4ce1-b2b8-7d47deb8e554"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 81, 62, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.8872962620671577`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"c6f845d4-597e-4582-b39d-aad551211cdd"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 81, 63, 
   32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262070545*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"ab84e97f-6637-4f80-a23e-e723eb13be50"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    81, 64, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262074046*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"f7738715-1c38-4ead-a73e-3bb059b18946"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 81, 65, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262078426*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"a0f29f33-7e29-4a48-a538-b2cf0bfcdd60"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 81, 66, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351623376*^9, 3.887296262083067*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"e9d7297d-790b-4a7c-b9e4-b4dcee949e28"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10408"}], ")"}], " ", "coeff$10408", " ", 
        "vars$10408"}], "+", 
       RowBox[{"pcoal$10408", " ", "coeff$10408", " ", "vars$10408", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10408", "=", 
             RowBox[{"k$10408", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10408", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10408", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10408"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10408", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10408", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10408", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10408", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10408", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10408", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "q"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10409"}], ")"}], " ", "coeff$10409", " ", 
        "vars$10409"}], "+", 
       RowBox[{"pcoal$10409", " ", "coeff$10409", " ", "vars$10409", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10409", "=", 
             RowBox[{"k$10409", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10409", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10409", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10409"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10409", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10409", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10409", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10409", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10409", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10409", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "q"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10410"}], ")"}], " ", "coeff$10410", " ", 
        "vars$10410"}], "+", 
       RowBox[{"pcoal$10410", " ", "coeff$10410", " ", "vars$10410", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10410", "=", 
             RowBox[{"k$10410", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10410", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10410", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10410"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10410", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10410", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10410", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10410", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10410", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10410", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "q"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "q"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195579891*^9, 3.887220351561675*^9, 3.8872962620881166`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"f6b5b3c4-a093-410a-a49d-5b9e24f97c9d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection", "Subtitle",
 CellChangeTimes->{{3.866584255934545*^9, 
  3.866584256930895*^9}},ExpressionUUID->"745cca63-c79f-4d37-90a4-\
f9f1c533ecc9"],

Cell[TextData[{
 "Now for the fun part! Above, we saw that the two-locus statistics that we \
considered (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["D", "2"], TraditionalForm]],ExpressionUUID->
  "35d852f6-b843-4f7c-bc99-6cae0fffdb94"],
 " and \[OpenCurlyDoubleQuote]friends\[CloseCurlyDoubleQuote]) all close \
under drift, recombination, and mutation. What does \
\[OpenCurlyDoubleQuote]closure\[CloseCurlyDoubleQuote] mean? It means that we \
can compute the evolution of the expected ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["D", "2"], TraditionalForm]],ExpressionUUID->
  "0184b803-eaed-4b3d-b817-d31654c5b125"],
 " exactly with a finite number of additional terms, each of which depend \
only on each other and no additional statistics. This emits a finite (linear) \
system of equations.\n\nWhy do these statistics close? It likely has to do \
with the symmetries of the statistics. There is a symmetry across loci (left \
and right locus are both neutral, in the above equations), and a symmetry \
between derived and ancestral states at both loci.\n\nSelection will break \
this symmetry, both between the left and right loci, as one locus will carry \
negatively selected mutations and the other will be neutral. And the selected \
locus will no longer have that symmetry between ancestral and derived \
states."
}], "Text",
 CellChangeTimes->{{3.866584800013844*^9, 3.86658496123209*^9}, {
  3.8665850430968246`*^9, 
  3.8665851483230124`*^9}},ExpressionUUID->"8a196890-91b8-40e9-b01d-\
c3c2d8a11938"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectMonomes", "[", 
   RowBox[{"monome_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "monome", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"monome", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
             RowBox[{"K", " ", "p"}]}], ")"}], "s"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"select", "[", "term_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SelectMonomes", "[", 
       RowBox[{"#", ",", "s"}], "]"}], "&"}], "/@", 
     RowBox[{"ToMonomes", "[", "term", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.866636930142332*^9, 3.866637055146299*^9}, {
   3.866637103116914*^9, 3.866637198904436*^9}, {3.866637295947781*^9, 
   3.866637302940421*^9}, {3.8666373943849773`*^9, 3.866637415594205*^9}, 
   3.866637526740471*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"bde2a0cc-355e-412a-8c75-6b62573f33a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", "p", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.866637662597911*^9, 3.866637687045638*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"ac5a3ffa-d33c-4371-aeee-b88cb230802e"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    84, 67, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262105249*^9},
 CellLabel->
  "During evaluation of \
In[84]:=",ExpressionUUID->"ba4fe9f6-eb4d-4e5c-8b8d-f32d2afdcc02"],

Cell[BoxData[
 RowBox[{"p", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "s", "-", 
    RowBox[{"p", " ", "s"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.86663767097022*^9, 3.8666376873489037`*^9}, 
   3.887220351666038*^9, 3.887296262109372*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"eb2d3a5c-e389-4b27-a95e-e17c261bcd65"]
}, Open  ]],

Cell["\<\
Above, we see that p\[CloseCurlyQuote]=p+sp(1-p), or \
\[CapitalDelta]p=sp(1-p), as expected.
Below, let\[CloseCurlyQuote]s check some of the terms in the Hill-Robertson \
system. (PoynomialReduce can be an annoying function..)\
\>", "Text",
 CellChangeTimes->{{3.866637733196657*^9, 3.866637785691969*^9}, {
  3.86663820391868*^9, 3.866638214860268*^9}, {3.8667125651025953`*^9, 
  3.866712567052301*^9}},ExpressionUUID->"7d06efee-3590-46d1-a231-\
cbaa84101b22"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pqDunsorted", "[", 
   RowBox[{"select", "[", 
    RowBox[{"Tocs", "[", 
     RowBox[{"DD", "^", "2"}], "]"}], "]"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", "^", "2"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.8666377891956377`*^9, 
   3.86663790835636*^9}, 3.866638061284276*^9, {3.8666381107313128`*^9, 
   3.866638118510091*^9}, {3.86663845523435*^9, 3.866638478831828*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"15365c87-047f-4812-b26e-1655d50cc175"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    85, 68, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262122406*^9},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"7a0bec6f-2ec9-4ff2-adf9-9eb1aa972238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], "2"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"4", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866637790359427*^9, 3.866637809578174*^9}, {
   3.8666378545134077`*^9, 3.866637908682248*^9}, 3.866638061720067*^9, {
   3.866638460531949*^9, 3.8666384793569527`*^9}, 3.887220351680307*^9, 
   3.8872962621273537`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"3d454a08-84ca-4d05-b535-69bc591866fe"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 86, 69, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262128578*^9},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"d7cb0c53-355a-4173-a384-f5460a5f0df5"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"c1", "-", 
        RowBox[{"p", " ", "q"}]}], ")"}], "2"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"4", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "p"}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866637790359427*^9, 3.866637809578174*^9}, {
   3.8666378545134077`*^9, 3.866637908682248*^9}, 3.866638061720067*^9, {
   3.866638460531949*^9, 3.8666384793569527`*^9}, 3.887220351680307*^9, 
   3.887296262133193*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"e427525b-6736-424d-88ae-884880ed379e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637822182878*^9}, {3.8666380667396708`*^9, 3.8666381970772343`*^9}, 
   3.8666384516621733`*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"6ae9592b-e847-47b3-8e13-9ba64edc6b19"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    87, 70, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962621467237`*^9},
 CellLabel->
  "During evaluation of \
In[87]:=",ExpressionUUID->"b45c3b51-9721-4a9e-9553-558ae48725d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"c1", "-", 
    RowBox[{"p", " ", "q"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "s", "-", 
    RowBox[{"2", " ", "c1", " ", "s"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["p", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"3", "-", 
       RowBox[{"8", " ", "q"}]}], ")"}], " ", "s"}], "-", 
    RowBox[{"2", " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "s"}], ")"}]}], "+", 
    RowBox[{"2", " ", "p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"3", " ", "s"}], "+", 
       RowBox[{"2", " ", "c1", " ", "s"}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"7", " ", "s"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.8666378267369204`*^9, {3.8666380682711554`*^9, 3.8666381974673777`*^9}, 
   3.866638487098866*^9, 3.887220351699642*^9, 3.887296262151311*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"30bb7ca0-e70a-443c-990e-3e8dbe7afc65"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 88, 71, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262152409*^9},
 CellLabel->
  "During evaluation of \
In[87]:=",ExpressionUUID->"37b60cb8-2e43-4b42-b585-8e611f461eee"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "s", "-", 
      RowBox[{"2", " ", "c1", " ", "s"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["p", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"8", " ", "q"}]}], ")"}], " ", "s"}], "-", 
      RowBox[{"2", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "s"}], ")"}]}], "+", 
      RowBox[{"2", " ", "p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"3", " ", "s"}], "+", 
         RowBox[{"2", " ", "c1", " ", "s"}], "+", 
         RowBox[{"q", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"7", " ", "s"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "p"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c2"}], " ", "c3"}], "+", 
         RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8666378267369204`*^9, {3.8666380682711554`*^9, 3.8666381974673777`*^9}, 
   3.866638487098866*^9, 3.887220351699642*^9, 3.8872962621564903`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"dcffc994-c0c8-4df2-ba2e-3faddccdf6db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "q", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "q", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637824828907*^9}, {3.866638356502575*^9, 3.8666384063818207`*^9}, 
   3.8666384506424417`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"b6316d7d-c51e-49f6-bc37-ef5cffbeb405"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    89, 72, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262170354*^9},
 CellLabel->
  "During evaluation of \
In[89]:=",ExpressionUUID->"0e1c3bfc-70e1-4985-8196-3d4e6d6a8580"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c1", " ", "s"}], "+", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "s", "-", 
         RowBox[{"2", " ", "c1", " ", "s"}], "-", 
         RowBox[{"3", " ", "p", " ", "s"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"4", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]}], 
     ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8666378293433867`*^9, {3.866638357155648*^9, 3.866638406751561*^9}, 
   3.866638490046873*^9, 3.887220351719208*^9, 3.8872962621749287`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"57c06228-b3f6-49e6-bd89-78bf22f38c65"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 90, 73, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262175954*^9},
 CellLabel->
  "During evaluation of \
In[89]:=",ExpressionUUID->"fe04e8f8-38cd-4fb2-ae07-ccc6e4ea3990"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", " ", "s"}], "+", 
        RowBox[{"q", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "s", "-", 
           RowBox[{"2", " ", "c1", " ", "s"}], "-", 
           RowBox[{"3", " ", "p", " ", "s"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"4", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]}], 
       ")"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "p"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8666378293433867`*^9, {3.866638357155648*^9, 3.866638406751561*^9}, 
   3.866638490046873*^9, 3.887220351719208*^9, 3.887296262179988*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"e69718d4-447d-4466-9668-4f227fbcca46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637824828907*^9}, {3.866638431625868*^9, 3.866638448631967*^9}, {
   3.86663849806496*^9, 3.866638536155611*^9}, 3.866638971944365*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"a512e250-1730-4882-8d2a-9b304ee02bf0"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    91, 74, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262192251*^9},
 CellLabel->
  "During evaluation of \
In[91]:=",ExpressionUUID->"46451492-ec34-4a42-bdc5-ac37e50820c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.866638973979842*^9, 3.8872203517355947`*^9, 
  3.8872962621963377`*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"287b3880-e6a2-4d3a-9a79-15b46a8aa41f"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 92, 75, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262197201*^9},
 CellLabel->
  "During evaluation of \
In[91]:=",ExpressionUUID->"6cf6606a-cc5d-4b06-92bb-30e64f615cc6"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.866638973979842*^9, 3.8872203517355947`*^9, 
  3.887296262200767*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"01c8d15b-e7a8-4318-a986-0790f2738d05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637824828907*^9}, {3.866638431625868*^9, 3.866638448631967*^9}, {
   3.86663849806496*^9, 3.866638536155611*^9}, 3.866638971944365*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"00193dc3-f3f0-4a73-b7b8-cde59018157d"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    93, 76, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262212522*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"a87b9857-7952-4fe7-8de3-a71f76d6113d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c1", " ", "s"}], "-", 
  RowBox[{"q", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "c1", " ", "s"}], "+", 
     RowBox[{"p", " ", "s"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "p", " ", "s"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.866637202818655*^9, 3.866637216502874*^9}, {
   3.866637304590226*^9, 3.866637351028487*^9}, {3.866637398410342*^9, 
   3.86663742319895*^9}, {3.866637490642033*^9, 3.866637535219789*^9}, {
   3.866637568712727*^9, 3.8666376201363487`*^9}, 3.8666378178735657`*^9, 
   3.866638418191743*^9, {3.866638499785995*^9, 3.866638542277114*^9}, 
   3.8666389751391993`*^9, 3.887220351748919*^9, 3.887296262216784*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"f5cc7c3a-53ba-4b02-86d1-991e4b39c2d7"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 94, 77, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262217744*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"cef52f34-a38a-4ed2-9e10-b99e1f3fe7ac"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", " ", "s"}], "-", 
    RowBox[{"q", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "c1", " ", "s"}], "+", 
       RowBox[{"p", " ", "s"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "p", " ", "s"}]}], ")"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.866637202818655*^9, 3.866637216502874*^9}, {
   3.866637304590226*^9, 3.866637351028487*^9}, {3.866637398410342*^9, 
   3.86663742319895*^9}, {3.866637490642033*^9, 3.866637535219789*^9}, {
   3.866637568712727*^9, 3.8666376201363487`*^9}, 3.8666378178735657`*^9, 
   3.866638418191743*^9, {3.866638499785995*^9, 3.866638542277114*^9}, 
   3.8666389751391993`*^9, 3.887220351748919*^9, 3.887296262221485*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"b23a2cd0-c6c0-40d1-a4ed-0c09dc38b790"]
}, Open  ]],

Cell["\<\
Already with just p(1-p) and q(1-q) we see some interesting effects of \
selection. The heterozygosity at the left locus, p(1-p) has a factor of \
p(1-p)(1-2p), while heterozygosity at the right neutral locus q(1-q) changes \
with an extra factor of s*D*(1-2q)
How do these factors change?\
\>", "Text",
 CellChangeTimes->{{3.8666385596155043`*^9, 3.866638645074163*^9}, {
  3.8666389534248257`*^9, 
  3.8666389576026487`*^9}},ExpressionUUID->"25f86d65-94b6-43bd-b347-\
c6f9e3fd7a7d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "^", "2"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "^", "2"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.866638964237423*^9, 3.866639029271097*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"270935a7-a516-4431-99f9-ba56fcf456a4"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    95, 78, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262233554*^9},
 CellLabel->
  "During evaluation of \
In[95]:=",ExpressionUUID->"f57d1ef4-1798-490d-a07b-ba38ff7879f0"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "s", "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["p", "2"], " ", "s"}], "-", 
      RowBox[{"2", " ", "p", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", "s"}]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8666389771899767`*^9, 3.866639029623913*^9}, 
   3.88722035176061*^9, 3.887296262237762*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"19e0802a-d66a-4924-9bc1-9d65e47fa445"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 96, 79, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262238696*^9},
 CellLabel->
  "During evaluation of \
In[95]:=",ExpressionUUID->"52f72612-6c43-49d2-b776-79951b8af646"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "s", "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["p", "2"], " ", "s"}], "-", 
        RowBox[{"2", " ", "p", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "s"}]}], ")"}]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
      SuperscriptBox["p", "2"]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8666389771899767`*^9, 3.866639029623913*^9}, 
   3.88722035176061*^9, 3.887296262242577*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"6e1a2042-47e9-4b7c-a33d-23d82c0faf37"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", "^", "2"}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.866638964237423*^9, 3.8666389696446857`*^9}, {
  3.86663903857583*^9, 3.866639065286956*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"f4d15c1d-6a9d-4584-ae09-bd823693eed3"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    97, 80, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887296262254425*^9},
 CellLabel->
  "During evaluation of \
In[97]:=",ExpressionUUID->"4fad2bb0-4aad-4525-9128-e22f5f832512"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"p", " ", "q"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "c1"}], "+", 
         RowBox[{"2", " ", "p"}]}], ")"}], " ", "s"}], "+", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"6", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]}], 
     ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8666390413923693`*^9, 3.866639065951536*^9}, 
   3.8872203517720337`*^9, 3.88729626225876*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"31565d84-9a00-4026-b77f-5049ceaac8b5"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 98, 81, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8872962622597313`*^9},
 CellLabel->
  "During evaluation of \
In[97]:=",ExpressionUUID->"d42da15c-a2a2-4937-acc9-17ba37b1817f"],

Cell[BoxData[
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c1", "-", 
        RowBox[{"p", " ", "q"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "c1"}], "+", 
           RowBox[{"2", " ", "p"}]}], ")"}], " ", "s"}], "+", 
        RowBox[{"q", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"6", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]}], 
       ")"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], "2"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "p"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c2"}], " ", "c3"}], "+", 
        RowBox[{"c1", " ", "c4"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "q"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", "c3"}], "+", 
      RowBox[{"c1", " ", "c4"}]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8666390413923693`*^9, 3.866639065951536*^9}, 
   3.8872203517720337`*^9, 3.887296262263544*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"24fb9de0-d15d-47c0-9de6-56d1328c1da0"]
}, Open  ]],

Cell["Looking at just the left locus, we can explore some of the ", "Text",
 CellChangeTimes->{{3.866712589144649*^9, 
  3.866712599110935*^9}},ExpressionUUID->"65a9d9f8-2802-4167-8944-\
4345b2704e7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"basisp", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "^", "4"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "4"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "^", "3"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "3"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p", "^", "3"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "3"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "^", "2"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "2"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p", "^", "2"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "2"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "^", "1"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "1"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p", "^", "1"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "1"}]}], ",", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "p"}]}], ")"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8666391555843887`*^9, 3.8666392212558327`*^9}, {
  3.866639589701285*^9, 3.8666395931798*^9}, {3.866640646317593*^9, 
  3.8666406504297113`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"df96cdd2-e556-49de-9a6e-147f4b52f94a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "4"], " ", 
    SuperscriptBox["p", "4"]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
    SuperscriptBox["p", "3"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
    SuperscriptBox["p", "3"]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
    SuperscriptBox["p", "2"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
    SuperscriptBox["p", "2"]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8666392221260567`*^9, 3.866639594123672*^9, 
  3.866640650955319*^9, 3.887220351782926*^9, 3.887296262275467*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"a520a587-3d96-4ecb-a794-fe54d8d27861"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "basisp", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term", "=", 
     RowBox[{"basisp", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Length", "[", "basisp", "]"}], "-", "i", "+", "1"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "term", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"PolynomialReduce", "[", 
      RowBox[{
       RowBox[{"pqDunsorted", "[", 
        RowBox[{"select", "[", 
         RowBox[{"Tocs", "[", "term", "]"}], "]"}], "]"}], ",", "basisp", ",", 
       RowBox[{"{", "p", "}"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"PolynomialReduce", "[", 
      RowBox[{
       RowBox[{"mutatedriftrecomb", "[", "term", "]"}], ",", "basisp", ",", 
       RowBox[{"{", "p", "}"}]}], "]"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.866639227527409*^9, 3.866639392286223*^9}, {
  3.866639480495675*^9, 3.866639483839568*^9}, {3.8667126225562077`*^9, 
  3.866712698801776*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"73fa5fe8-cc63-4b6c-9dbe-7708653c2360"],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"2", " ", "p"}]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262292296*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"ef472db8-453c-40c3-8f1a-994a404d7f7b"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    100, 82, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262293363*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"05bd8306-6b53-44b6-b13b-21a339e63b7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "s"}], ",", "1"}], "}"}], ",", "0"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262297456*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"05d4715a-61ef-428f-a4e7-80fe2f50320e"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 100, 83, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262298224*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"5e2b316b-634e-4428-8f7e-70dd7416b702"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"0\\\"}]\\) is not a valid variable.\"", 2, 100, 84,
    32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262302182*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"78878189-0385-4397-8809-37c28b46e78e"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 100, 85,
    32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262305964*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"f7311a60-d188-4040-82d9-67d550631cd2"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 100, 86,
    32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262309677*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"54da784b-4ecf-4dc0-9a7c-a808709a5ed8"],

Cell[BoxData[
 TemplateBox[{
  "Coefficient", "ivar", 
   "\"\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a valid variable.\"", 2, 100, 87,
    32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262313533*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"27f36da5-1d3d-4ab1-a455-5b050e9f4fdb"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Coefficient\\\", \\\"::\
\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 100, 88, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262317334*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"4893d4fd-aa27-4d1b-8421-5d58c670210f"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    100, 89, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262321115*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"7693994f-06f1-49d4-9aad-2ed8aeb15b85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10844"}], ")"}], " ", "coeff$10844", " ", 
        "vars$10844"}], "+", 
       RowBox[{"pcoal$10844", " ", "coeff$10844", " ", "vars$10844", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10844", "=", 
             RowBox[{"k$10844", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10844", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10844", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10844"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10844", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10844", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10844", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10844", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10844", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10844", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", "c1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", "u"}], "}"}]}], "}"}]}], "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10847"}], ")"}], " ", "coeff$10847", " ", 
        "vars$10847"}], "+", 
       RowBox[{"pcoal$10847", " ", "coeff$10847", " ", "vars$10847", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10847", "=", 
             RowBox[{"k$10847", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10847", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10847", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10847"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10847", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10847", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10847", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10847", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10847", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10847", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", "c1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", "u"}], "}"}]}], "}"}]}], "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10850"}], ")"}], " ", "coeff$10850", " ", 
        "vars$10850"}], "+", 
       RowBox[{"pcoal$10850", " ", "coeff$10850", " ", "vars$10850", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10850", "=", 
             RowBox[{"k$10850", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10850", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10850", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10850"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10850", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10850", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10850", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10850", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10850", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10850", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", "c1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], " ", "u"}], "}"}]}], "}"}]}], "]"}]}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262325769*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"fc1a5fac-01a8-4c8e-a962-1c111b0a9f68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262328974*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"fe389a7e-fed9-4257-afad-63d4721aba39"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    100, 90, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262331045*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"c3536c93-c79e-4417-b006-2623771c5afc"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Solve\\\", \\\"::\\\", \
\\\"svars\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 100, 91, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262335061*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"d9ba59ca-864f-469a-bcee-0683413c9f7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "s", ",", "1", ",", 
     "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262338574*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"0c6e3493-d949-442f-8505-51b9d252f756"],

Cell[BoxData[
 TemplateBox[{
  "General", "ivar", 
   "\"\\!\\(\\*RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"c2\\\"}], \\\" \\\", \\\
\"c3\\\"}], \\\"+\\\", RowBox[{\\\"c1\\\", \\\" \\\", \\\"c4\\\"}]}]\\) is \
not a valid variable.\"", 2, 100, 92, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.8872962623392773`*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"4691b117-b1df-4f52-9e5c-c01d7b20e4d1"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ivar\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 100, 93, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262342782*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"b95ec85a-885b-4c43-a68e-dd67108d08b4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10936"}], ")"}], " ", "coeff$10936", " ", 
        "vars$10936"}], "+", 
       RowBox[{"pcoal$10936", " ", "coeff$10936", " ", "vars$10936", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10936", "=", 
             RowBox[{"k$10936", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10936", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10936", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10936"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10936", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10936", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10936", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10936", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10936", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10936", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10937"}], ")"}], " ", "coeff$10937", " ", 
        "vars$10937"}], "+", 
       RowBox[{"pcoal$10937", " ", "coeff$10937", " ", "vars$10937", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10937", "=", 
             RowBox[{"k$10937", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10937", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10937", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10937"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10937", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10937", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10937", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10937", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10937", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10937", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ">", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pcoal$10938"}], ")"}], " ", "coeff$10938", " ", 
        "vars$10938"}], "+", 
       RowBox[{"pcoal$10938", " ", "coeff$10938", " ", "vars$10938", " ", 
        RowBox[{
         UnderoverscriptBox["\[Sum]", 
          RowBox[{"i", "=", "1"}], "4"], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"j", "=", "1"}], "4"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kprev$10938", "=", 
             RowBox[{"k$10938", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev$10938", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev$10938", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K$10938"}]}], ",", "0", ",", 
              FractionBox[
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                   "kprev$10938", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "kprev$10938", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{
                  "cs", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]], ",", 
                 RowBox[{
                  RowBox[{
                  "kprev$10938", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "kprev$10938", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
               RowBox[{"K$10938", " ", 
                RowBox[{"(", 
                 RowBox[{"K$10938", "-", "1"}], ")"}]}]]}], "]"}]}], 
           ")"}]}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", 
            SuperscriptBox["c1", "2"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "5"}], " ", "c1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["5", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "c1"}], "+", "p"}], ")"}], "2"]}], "}"}]}], "}"}]}],
      "]"}]}]}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262347269*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"7619c26d-9f9c-4b1c-967f-bb84a1539b40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262349337*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"923d98c9-84b6-40be-94d7-b2a18a5135d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "6"}], " ", "s"}], ",", "1", ",", "s", ",", "0"}], "}"}], 
   ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262351221*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"2fdb901b-2ea2-4e1f-a582-4b7ce476d30d"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Dot", "dotsh", 
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \
\\\"3\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\
\",\\\", FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"3\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \
\\\"3\\\"]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", \\\"c2\\\"}], \\\",\\\", \
RowBox[{\\\"6\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \
\\\", SuperscriptBox[\\\"c2\\\", \\\"3\\\"]}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \
\\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", \\\"c2\\\"}], \\\",\\\
\", RowBox[{\\\"6\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \
\\\", SuperscriptBox[\\\"c2\\\", \\\"3\\\"]}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"2\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"3\\\"]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \
\\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", \\\"c2\\\"}], \\\",\\\
\", RowBox[{\\\"6\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", RowBox[{\\\"2\\\", \\\" \
\\\", SuperscriptBox[\\\"c2\\\", \\\"3\\\"]}]}], \\\"}\\\"}]}], \
\\\"}\\\"}]\\) have incompatible shapes.\"", 2, 100, 94, 32908912481691598928,
    "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262351987*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"361a830c-fd0a-484b-bd96-5f28bee12aff"],

Cell[BoxData[
 TemplateBox[{
  "Dot", "dotsh", 
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \
\\\"3\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", \
\\\"1\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\
\",\\\", FractionBox[\\\"1\\\", \\\"3\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"3\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \
\\\"3\\\"]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \
\\\")\\\"}]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \\\"c1\\\", \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \
\\\"3\\\"]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\
\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"]}], \\\",\\\", \
RowBox[{\\\"6\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \\\"c1\\\
\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \
\\\"3\\\"]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\
\"2\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"]}], \\\",\\\", \
RowBox[{\\\"6\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \
\\\"p\\\"}], \\\")\\\"}]}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \\\"c1\\\
\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"c1\\\"}], \\\"+\\\", \\\"p\\\"}], \\\")\\\"}], \
\\\"3\\\"]}]}], \\\"}\\\"}]}], \\\"}\\\"}]\\) have incompatible shapes.\"", 2,
    100, 95, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262356907*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"60a5d3f4-3563-4275-b171-337ebc6c853f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "3"], ",", 
        FractionBox["1", "3"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "3"], ",", 
        FractionBox["1", "3"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "3"], ",", 
        FractionBox["1", "3"], ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"6", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"6", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"6", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}]}], "}"}]}], 
     "}"}]}]}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262361657*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"03c75f06-9523-4c10-83a6-65817189b5b6"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
  SuperscriptBox["p", "2"]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262362752*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"4e7cea36-1638-4340-a6ef-2014664b054a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"2", " ", "s"}], ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}],
    ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.8872962623641033`*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"af3735de-1b32-4994-9740-78d5ec6bc5f4"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Dot", "dotsh", 
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \\\"4\
\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\
\\\", RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", FractionBox[\\\"1\\\", \
\\\"4\\\"], \\\",\\\", FractionBox[\\\"1\\\", \\\"6\\\"], \\\",\\\", \
FractionBox[\\\"1\\\", \\\"4\\\"], \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", RowBox[{\\\"4\\\", \
\\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \\\", \\\"c2\\\"}], \\\
\",\\\", RowBox[{\\\"6\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \
\\\" \\\", SuperscriptBox[\\\"c2\\\", \\\"2\\\"]}], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"3\\\"]}], \\\",\\\", \
SuperscriptBox[\\\"c2\\\", \\\"4\\\"]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \
\\\", \\\"c2\\\"}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c2\\\", \
\\\"2\\\"]}], \\\",\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"3\\\"]}], \\\",\\\", \
SuperscriptBox[\\\"c2\\\", \\\"4\\\"]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{SuperscriptBox[\\\"c1\\\", \\\"4\\\"], \\\",\\\", \
RowBox[{\\\"4\\\", \\\" \\\", SuperscriptBox[\\\"c1\\\", \\\"3\\\"], \\\" \
\\\", \\\"c2\\\"}], \\\",\\\", RowBox[{\\\"6\\\", \\\" \\\", \
SuperscriptBox[\\\"c1\\\", \\\"2\\\"], \\\" \\\", SuperscriptBox[\\\"c2\\\", \
\\\"2\\\"]}], \\\",\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"c1\\\", \\\" \\\", \
SuperscriptBox[\\\"c2\\\", \\\"3\\\"]}], \\\",\\\", \
SuperscriptBox[\\\"c2\\\", \\\"4\\\"]}], \\\"}\\\"}]}], \\\"}\\\"}]\\) have \
incompatible shapes.\"", 2, 100, 96, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262364778*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"2c64d3f9-dfb2-41a1-a48b-57da8d785fa5"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Dot\\\", \\\"::\\\", \\\
\"dotsh\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 100, 97, 32908912481691598928, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.887220351797452*^9, 3.887296262369576*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"8b4ca573-558f-4708-8f74-401086cdcafb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "4"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "4"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "4"], ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "4"], ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "4"], ",", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"4", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], "4"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "4"], ",", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"4", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], "4"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "4"], ",", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"4", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], "4"]}], "}"}]}], "}"}]}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.8872962623731213`*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"89f74b33-9781-4cfc-8b07-e9a868584dbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
  SuperscriptBox["p", "2"]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.8872962623742523`*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"e102d016-8de6-4dc7-ae6a-27a0b72c7044"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "10"}], " ", "s"}], ",", "1", ",", 
     RowBox[{"2", " ", "s"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.88729626237568*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"37c95908-1294-40b8-a7d3-bdc2b1ff562f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "5"], ",", 
        FractionBox["1", "10"], ",", 
        FractionBox["1", "10"], ",", 
        FractionBox["1", "5"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "5"], ",", 
        FractionBox["1", "10"], ",", 
        FractionBox["1", "10"], ",", 
        FractionBox["1", "5"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "5"], ",", 
        FractionBox["1", "10"], ",", 
        FractionBox["1", "10"], ",", 
        FractionBox["1", "5"], ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["c1", "5"]}], ",", 
        RowBox[{"10", " ", 
         SuperscriptBox["c1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "20"}], " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"20", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "3"]}], ",", 
        RowBox[{
         RowBox[{"-", "10"}], " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "5"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["c1", "5"]}], ",", 
        RowBox[{"10", " ", 
         SuperscriptBox["c1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "20"}], " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"20", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "3"]}], ",", 
        RowBox[{
         RowBox[{"-", "10"}], " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "5"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["c1", "5"]}], ",", 
        RowBox[{"10", " ", 
         SuperscriptBox["c1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "20"}], " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"20", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "3"]}], ",", 
        RowBox[{
         RowBox[{"-", "10"}], " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "5"]}]}], "}"}]}], "}"}]}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262376748*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"89f7d994-140c-4772-a5e4-714827b96eee"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
  SuperscriptBox["p", "3"]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.8872962623781557`*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"77802244-44ba-4631-87d7-3c3b777be8dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"3", " ", "s"}], ",", "1", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.88729626237884*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"e483521f-b040-4f08-bf07-94c7d98b2f11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "15"], ",", 
        FractionBox["1", "20"], ",", 
        FractionBox["1", "15"], ",", 
        FractionBox["1", "6"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "15"], ",", 
        FractionBox["1", "20"], ",", 
        FractionBox["1", "15"], ",", 
        FractionBox["1", "6"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "6"], ",", 
        FractionBox["1", "15"], ",", 
        FractionBox["1", "20"], ",", 
        FractionBox["1", "15"], ",", 
        FractionBox["1", "6"], ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["c1", "6"]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "5"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "15"}], " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"20", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "3"]}], ",", 
        RowBox[{
         RowBox[{"-", "15"}], " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"6", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["c1", "6"]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "5"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "15"}], " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"20", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "3"]}], ",", 
        RowBox[{
         RowBox[{"-", "15"}], " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"6", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["c1", "6"]}], ",", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "5"], " ", 
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "15"}], " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"20", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "3"]}], ",", 
        RowBox[{
         RowBox[{"-", "15"}], " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"6", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}]}], "}"}]}], "}"}]}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262379937*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"ed254c3a-52a4-48f3-abae-8fcddcf5edfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
  SuperscriptBox["p", "3"]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262381343*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"1e70123d-4e55-4efc-b67b-ef64ea09d4f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "14"}], " ", "s"}], ",", "1", ",", 
     RowBox[{"3", " ", "s"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262382032*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"3eae6a60-e24a-4fbe-a194-40d0f663b459"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "7"], ",", 
        FractionBox["1", "21"], ",", 
        FractionBox["1", "35"], ",", 
        FractionBox["1", "35"], ",", 
        FractionBox["1", "21"], ",", 
        FractionBox["1", "7"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "7"], ",", 
        FractionBox["1", "21"], ",", 
        FractionBox["1", "35"], ",", 
        FractionBox["1", "35"], ",", 
        FractionBox["1", "21"], ",", 
        FractionBox["1", "7"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "7"], ",", 
        FractionBox["1", "21"], ",", 
        FractionBox["1", "35"], ",", 
        FractionBox["1", "35"], ",", 
        FractionBox["1", "21"], ",", 
        FractionBox["1", "7"], ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "7"]}], ",", 
        RowBox[{"14", " ", 
         SuperscriptBox["c1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"42", " ", 
         SuperscriptBox["c1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"42", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"14", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "7"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "7"]}], ",", 
        RowBox[{"14", " ", 
         SuperscriptBox["c1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"42", " ", 
         SuperscriptBox["c1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"42", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"14", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "7"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "7"]}], ",", 
        RowBox[{"14", " ", 
         SuperscriptBox["c1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"42", " ", 
         SuperscriptBox["c1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"42", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"14", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}], ",", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "7"]}]}], "}"}]}], 
     "}"}]}]}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262383239*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"85d89466-6b67-4fd6-9cbd-d0e61e5a3083"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "4"], " ", 
  SuperscriptBox["p", "4"]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262384715*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"bbe55955-509b-4e26-81c8-c80c0296beb4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      RowBox[{"4", " ", "s"}], "-", 
      RowBox[{"8", " ", "p", " ", "s"}]}], ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262385397*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"51ef6ed5-a481-4725-b5eb-6e6ca5f8b1dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "8"], ",", 
        FractionBox["1", "28"], ",", 
        FractionBox["1", "56"], ",", 
        FractionBox["1", "70"], ",", 
        FractionBox["1", "56"], ",", 
        FractionBox["1", "28"], ",", 
        FractionBox["1", "8"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "8"], ",", 
        FractionBox["1", "28"], ",", 
        FractionBox["1", "56"], ",", 
        FractionBox["1", "70"], ",", 
        FractionBox["1", "56"], ",", 
        FractionBox["1", "28"], ",", 
        FractionBox["1", "8"], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        FractionBox["1", "8"], ",", 
        FractionBox["1", "28"], ",", 
        FractionBox["1", "56"], ",", 
        FractionBox["1", "70"], ",", 
        FractionBox["1", "56"], ",", 
        FractionBox["1", "28"], ",", 
        FractionBox["1", "8"], ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "8"], ",", 
        RowBox[{"8", " ", 
         SuperscriptBox["c1", "7"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"28", " ", 
         SuperscriptBox["c1", "6"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"56", " ", 
         SuperscriptBox["c1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"56", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"28", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}], ",", 
        RowBox[{"8", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "7"]}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], "8"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "8"], ",", 
        RowBox[{"8", " ", 
         SuperscriptBox["c1", "7"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"28", " ", 
         SuperscriptBox["c1", "6"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"56", " ", 
         SuperscriptBox["c1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"56", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"28", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}], ",", 
        RowBox[{"8", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "7"]}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], "8"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["c1", "8"], ",", 
        RowBox[{"8", " ", 
         SuperscriptBox["c1", "7"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "c1"}], "+", "p"}], ")"}]}], ",", 
        RowBox[{"28", " ", 
         SuperscriptBox["c1", "6"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "2"]}], ",", 
        RowBox[{"56", " ", 
         SuperscriptBox["c1", "5"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "3"]}], ",", 
        RowBox[{"70", " ", 
         SuperscriptBox["c1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "4"]}], ",", 
        RowBox[{"56", " ", 
         SuperscriptBox["c1", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "5"]}], ",", 
        RowBox[{"28", " ", 
         SuperscriptBox["c1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", "-", "p"}], ")"}], "6"]}], ",", 
        RowBox[{"8", " ", "c1", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "c1"}], "+", "p"}], ")"}], "7"]}], ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", "-", "p"}], ")"}], "8"]}], "}"}]}], "}"}]}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9, 3.8872203517954893`*^9, 
  3.887296262386636*^9},
 CellLabel->
  "During evaluation of \
In[100]:=",ExpressionUUID->"dd47fa0f-6bc3-4ef0-9c0f-8eaf3cc1713c"]
}, Open  ]]
}, Open  ]],

Cell["\<\
What are some closure options for the selection operator?
1. Truncation: terms of higher order are just ignored, and their contribution \
to terms in our system are set to zero. For example, above the selection \
operator has p^4(1-p)^4 = p^4(1-p)^4 + 4s p^4(1-p)^4(1-2p). Instead, this \
second term would just be dropped.
2. Nonlinear estimation: the (expectation of) p^4(1-p)^4(1-2p) could be \
estimated as the product of (expectations of) lower order terms: \
E[p^4(1-p)^4(1-2p)] \\approx E[p^2(1-p)^2(1-2p)] E[p^2(1-p)^2]. Some \
experimentation would be needed.
3. Extrapolation: p^4(1-p)^4(1-2p) is estimated as a linear combination of \
p(1-p)(1-2p), p^2(1-p)^2(1-2p), and p^3(1-p)^3(1-2p), where we fit some curve \
to those statistics. We could devise either a jackknife approximation, or use \
a more crude but effective Richardson extrapolation approach.\
\>", "Text",
 CellChangeTimes->{{3.86671288736236*^9, 3.866712895378562*^9}, {
  3.866712931590663*^9, 3.866712953310708*^9}, {3.866713126217853*^9, 
  3.866713151520421*^9}, {3.866713183726655*^9, 3.866713185020811*^9}, {
  3.8667134716899643`*^9, 
  3.866713765396693*^9}},ExpressionUUID->"efde2a9e-349d-41b7-bda1-\
519adcc67d0b"]
}, Open  ]]
},
WindowSize->{1440., 758.25},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1a9edc5b-92f0-4e4f-b688-61f7f57132b2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 350, 6, 80, "Subtitle",ExpressionUUID->"584ef30d-dc91-40b3-9f41-a306b58dc2d7",
 CellGroupingRules->{"TitleGrouping", Inherited}],
Cell[933, 30, 509, 9, 58, "Text",ExpressionUUID->"3a9b7c18-bd38-4904-8530-abbc673e9b30"],
Cell[1445, 41, 2165, 59, 170, "Input",ExpressionUUID->"4e0090fa-45e8-4cda-974d-929309f812ec",
 InitializationCell->True],
Cell[3613, 102, 2103, 38, 242, "Text",ExpressionUUID->"04348e1a-2180-4a53-b92d-5a9833bf3ad2"],
Cell[5719, 142, 5806, 163, 335, "Input",ExpressionUUID->"a7c5e36c-2590-4bdc-bd5e-d7b5c36b4395",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[11550, 309, 603, 11, 113, "Input",ExpressionUUID->"200426a1-d1a0-4ce9-91f4-25681ce49157"],
Cell[12156, 322, 567, 17, 64, "Output",ExpressionUUID->"359fe9d8-a610-4fad-9a0a-f4848540040b"],
Cell[12726, 341, 388, 11, 61, "Output",ExpressionUUID->"83236b33-a281-467d-94d7-c569d7d75eda"],
Cell[13117, 354, 1668, 50, 64, "Output",ExpressionUUID->"7e049b15-08b1-41bb-9c71-11a102df1000"],
Cell[14788, 406, 485, 13, 46, "Output",ExpressionUUID->"d4e92c21-fc9e-4c09-a83d-27ca1a6e6e00"],
Cell[15276, 421, 1886, 61, 64, "Output",ExpressionUUID->"63f7c4bf-2fde-44ad-b734-d506ed3d9da8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17199, 487, 196, 3, 41, "Subsubtitle",ExpressionUUID->"073e83c6-35d4-48b9-b551-d122f7bfe12e"],
Cell[17398, 492, 1897, 45, 127, "Text",ExpressionUUID->"3dd74df5-3c33-4b9c-84e5-50f55027dafc"],
Cell[19298, 539, 3392, 84, 211, "Input",ExpressionUUID->"bdf6ebda-0f0f-4262-ab5b-9ae9bebd1489",
 InitializationCell->True],
Cell[22693, 625, 902, 24, 67, "Input",ExpressionUUID->"97e1f496-ae00-4724-9c6c-1b0e1137b128",
 InitializationCell->True],
Cell[23598, 651, 156, 3, 35, "Text",ExpressionUUID->"d1cf5acb-d0b7-433e-87a9-6c1a2a946414"],
Cell[CellGroupData[{
Cell[23779, 658, 799, 19, 71, "Input",ExpressionUUID->"034ef1cc-3c5b-463b-b2e8-96889599980c"],
Cell[24581, 679, 361, 9, 28, "Message",ExpressionUUID->"90b10ca8-33b5-4aaf-be43-d1042b3f5a18"],
Cell[24945, 690, 437, 7, 33, "Output",ExpressionUUID->"8dd88d5e-a324-445b-8fd9-9aea6ffd8d6a"],
Cell[25385, 699, 1289, 31, 49, "Output",ExpressionUUID->"750283b3-fa23-479d-aac9-ba48f637cc16"],
Cell[26677, 732, 359, 9, 28, "Message",ExpressionUUID->"7464d501-9967-447f-b7a0-e74eeeb7d303"],
Cell[27039, 743, 607, 14, 33, "Output",ExpressionUUID->"72d8f104-2555-4133-b470-b8843f108f98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27683, 762, 715, 15, 71, "Input",ExpressionUUID->"72e27084-2e02-49ef-8d28-102c3e91fd85"],
Cell[28401, 779, 358, 9, 28, "Message",ExpressionUUID->"d8b9d692-a8e7-432f-9111-56ab91c987da"],
Cell[28762, 790, 607, 14, 33, "Output",ExpressionUUID->"3a6fecc2-c87e-4ec4-88b9-7f600cb44a22"],
Cell[29372, 806, 361, 9, 28, "Message",ExpressionUUID->"d7e12fc3-efc9-4c90-925b-1ac7a6f42ceb"],
Cell[29736, 817, 629, 15, 33, "Output",ExpressionUUID->"9de28326-8fa6-4da9-a892-df7225585343"],
Cell[30368, 834, 361, 9, 28, "Message",ExpressionUUID->"292aa1fe-9f2f-417f-8814-490c52ca8ea0"],
Cell[30732, 845, 626, 15, 33, "Output",ExpressionUUID->"9a7c81dd-5949-4ffb-b612-ecc9887c5ab0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31407, 866, 186, 3, 41, "Subsubtitle",ExpressionUUID->"eea14446-08e9-4e7b-a065-3ec4042ca706"],
Cell[31596, 871, 2839, 67, 174, "Text",ExpressionUUID->"6c96e922-cdcc-45f5-9e7f-7974be5f4680"],
Cell[34438, 940, 6185, 143, 464, "Input",ExpressionUUID->"bb04c2bc-caa1-4e68-9131-f6cbe1aed486"],
Cell[CellGroupData[{
Cell[40648, 1087, 400, 8, 29, "Input",ExpressionUUID->"9e4959c5-c31a-4c04-b8da-8723e3d3d420"],
Cell[41051, 1097, 359, 9, 28, "Message",ExpressionUUID->"a63758eb-ff54-4582-92cc-d2cc117fe2be"],
Cell[41413, 1108, 854, 19, 49, "Output",ExpressionUUID->"e74345ab-401a-4b7b-a197-6ac89ff108a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42304, 1132, 459, 9, 29, "Input",ExpressionUUID->"1272e920-5f03-4f43-ba36-3c0f2182e2e8"],
Cell[42766, 1143, 1200, 32, 55, "Output",ExpressionUUID->"6e42c060-8c00-4e4c-a49e-68ed81f5b6d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44003, 1180, 1576, 43, 71, "Input",ExpressionUUID->"73e67e94-e5e9-4ad5-9df8-d1e7677914cf"],
Cell[45582, 1225, 359, 9, 28, "Message",ExpressionUUID->"f013b91c-ad97-49da-89cd-75f980d514f3"],
Cell[45944, 1236, 1020, 30, 51, "Output",ExpressionUUID->"11f8a5b9-55b9-4e67-b592-161f915ce59a"],
Cell[46967, 1268, 358, 9, 28, "Message",ExpressionUUID->"c762d35c-98d4-4646-926c-00e39c5de188"],
Cell[47328, 1279, 902, 26, 49, "Output",ExpressionUUID->"b4f36f89-d570-4c7d-be55-c6609f3bdf35"],
Cell[48233, 1307, 361, 9, 28, "Message",ExpressionUUID->"64be54f5-a190-4e65-a8fc-cfd9273949d5"],
Cell[48597, 1318, 1012, 30, 49, "Output",ExpressionUUID->"1f5e3b97-4e1d-4e13-ae1f-6f4f6c7bd2d3"]
}, Open  ]],
Cell[49624, 1351, 181, 3, 35, "Text",ExpressionUUID->"d1c1167d-b45b-4a16-8537-b70ce73e3c52"],
Cell[CellGroupData[{
Cell[49830, 1358, 834, 20, 51, "Input",ExpressionUUID->"0305386c-2ef8-4467-85f4-dad15174e7ea"],
Cell[50667, 1380, 360, 9, 28, "Message",ExpressionUUID->"5cac536e-b26e-4e68-ad00-e186e5330678"],
Cell[51030, 1391, 547, 17, 49, "Output",ExpressionUUID->"66176fa8-6630-4495-9363-646f25a5edbe"],
Cell[51580, 1410, 362, 9, 28, "Message",ExpressionUUID->"f4005819-a8c5-4304-b2b6-9d541bbb1238"],
Cell[51945, 1421, 545, 17, 49, "Output",ExpressionUUID->"20215f10-b90b-4c37-a760-7aae7b1f13d7"]
}, Open  ]],
Cell[52505, 1441, 514, 10, 29, "Input",ExpressionUUID->"7a0ac765-6d7f-4c38-a1d5-ec9a3ee6ec67"],
Cell[CellGroupData[{
Cell[53044, 1455, 3251, 94, 71, "Input",ExpressionUUID->"5e7e3695-791b-4f3e-b014-090ea8a4080d"],
Cell[56298, 1551, 360, 9, 28, "Message",ExpressionUUID->"0d9b2bc6-6c39-4168-a330-d8c8a818925e"],
Cell[56661, 1562, 465, 10, 28, "Message",ExpressionUUID->"7417b692-e675-4870-9e44-5d27ec1dac7b"],
Cell[57129, 1574, 2809, 85, 79, "Output",ExpressionUUID->"e0720d09-9d16-45a5-8792-8fa9d538d68d"],
Cell[59941, 1661, 360, 9, 28, "Message",ExpressionUUID->"e382b55d-ae30-484f-9434-5653ce60e95d"],
Cell[60304, 1672, 463, 10, 28, "Message",ExpressionUUID->"b35705ef-9c2a-4d7f-88d0-9111e9dc42d9"],
Cell[60770, 1684, 2400, 72, 77, "Output",ExpressionUUID->"06ec9b74-8944-4990-bea0-6c86bcac9818"],
Cell[63173, 1758, 360, 9, 28, "Message",ExpressionUUID->"3dbda5e6-e9a8-436b-ad5e-da887bb9e2e2"],
Cell[63536, 1769, 463, 10, 28, "Message",ExpressionUUID->"bee119e9-a7f0-4f98-ad1c-83ea8380eec4"],
Cell[64002, 1781, 2392, 74, 77, "Output",ExpressionUUID->"2cd03f2e-907f-49e3-91df-8fb2e92d3481"]
}, Open  ]],
Cell[66409, 1858, 521, 15, 35, "Text",ExpressionUUID->"c12e1f0f-7652-4d48-a063-30fc9be63a73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66979, 1879, 154, 3, 53, "Subtitle",ExpressionUUID->"d44b79df-f145-4a93-bc50-9d5a6d1d4901"],
Cell[67136, 1884, 895, 16, 127, "Text",ExpressionUUID->"528e3cbe-9c6b-44fc-bb4d-f0a2ffa0970a"],
Cell[68034, 1902, 419, 9, 29, "Input",ExpressionUUID->"723e3d04-781a-43a4-9f42-0d74d859d996"],
Cell[68456, 1913, 239, 6, 35, "Text",ExpressionUUID->"7571f009-14c7-4611-918a-162503f40d46"],
Cell[68698, 1921, 4832, 109, 360, "Input",ExpressionUUID->"939b21b8-e5a3-45f7-88df-df1a8549caaa"],
Cell[CellGroupData[{
Cell[73555, 2034, 502, 13, 29, "Input",ExpressionUUID->"6894c8c5-1be8-4978-9125-076b8f6ad6f3"],
Cell[74060, 2049, 463, 10, 28, "Message",ExpressionUUID->"0a91fd4c-449e-4dc7-8a57-fd2f7cb74285"],
Cell[74526, 2061, 352, 9, 28, "Message",ExpressionUUID->"d763dcfe-e2cc-42da-951d-7c56f1612076"],
Cell[74881, 2072, 359, 8, 33, "Output",ExpressionUUID->"444f0a7b-e213-4938-b021-6c98d73511fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75277, 2085, 1318, 40, 71, "Input",ExpressionUUID->"2f491b85-e088-48ea-91af-5cb4bf6c029e"],
Cell[76598, 2127, 463, 10, 28, "Message",ExpressionUUID->"29d65a71-32e4-40d5-b214-f58d0ed978ec"],
Cell[77064, 2139, 352, 9, 28, "Message",ExpressionUUID->"746b7161-1a03-4768-8c56-fc62a12afdce"],
Cell[77419, 2150, 513, 9, 33, "Output",ExpressionUUID->"91822092-bbe5-4560-858f-c2fc05c20b6a"],
Cell[77935, 2161, 463, 10, 28, "Message",ExpressionUUID->"a756dd29-23e5-4f0a-9a01-607e9837f397"],
Cell[78401, 2173, 352, 9, 28, "Message",ExpressionUUID->"2adda851-879c-4385-b682-b5afea7784e3"],
Cell[78756, 2184, 1545, 48, 33, "Output",ExpressionUUID->"d21c7ee7-8916-4078-ba02-dcd586e03484"],
Cell[80304, 2234, 463, 10, 28, "Message",ExpressionUUID->"dc0bdc6d-b17a-4619-9f45-0b3985362c02"],
Cell[80770, 2246, 352, 9, 28, "Message",ExpressionUUID->"a4b34184-dab0-4c04-bab1-148d6009cfe7"],
Cell[81125, 2257, 867, 21, 33, "Output",ExpressionUUID->"7892bde0-250a-4601-94f5-8537fd906031"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82029, 2283, 412, 11, 29, "Input",ExpressionUUID->"2967b2cc-04ab-4048-a8e5-1fc8b12984f3"],
Cell[82444, 2296, 461, 10, 28, "Message",ExpressionUUID->"b189be87-86f0-4fbd-8ef8-b55880b20079"],
Cell[82908, 2308, 352, 9, 28, "Message",ExpressionUUID->"f6632c40-5884-4ae5-9759-af9ff35060cd"],
Cell[83263, 2319, 521, 10, 36, "Output",ExpressionUUID->"f3655733-26bd-490a-8a7b-d3e1937b9a3f"]
}, Open  ]],
Cell[83799, 2332, 731, 14, 29, "Input",ExpressionUUID->"734903f8-cde0-41da-ba90-0c3e5dbe12f5"],
Cell[CellGroupData[{
Cell[84555, 2350, 560, 13, 29, "Input",ExpressionUUID->"01e69b4d-ba78-4ce4-a0e0-242331a074c5"],
Cell[85118, 2365, 487, 10, 28, "Message",ExpressionUUID->"052b82d3-8ae9-4470-8177-4ad87424bd4d"],
Cell[85608, 2377, 378, 9, 28, "Message",ExpressionUUID->"475627fc-f710-416b-9339-e36bc4ddbf63"],
Cell[85989, 2388, 380, 9, 28, "Message",ExpressionUUID->"7d683db1-7f10-49d4-b164-5e42522c0372"],
Cell[86372, 2399, 384, 9, 28, "Message",ExpressionUUID->"5d46b803-46d8-491a-8fb6-4fdef95ebe33"],
Cell[86759, 2410, 9912, 278, 434, "Output",ExpressionUUID->"b06d9e35-e62d-4da6-a688-abd0e1b95fed"]
}, Open  ]],
Cell[96686, 2691, 596, 13, 81, "Text",ExpressionUUID->"cfa6a3c5-db13-4001-b79e-44d0c775c403"],
Cell[CellGroupData[{
Cell[97307, 2708, 762, 24, 29, "Input",ExpressionUUID->"4c05ba30-55a0-4d2a-9e76-49d28066101c"],
Cell[98072, 2734, 1116, 35, 36, "Output",ExpressionUUID->"2b3a376a-2ee6-48b9-b0eb-bc8ee08b4f44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99225, 2774, 1662, 39, 113, "Input",ExpressionUUID->"3bb69849-2be3-4eb1-b786-3f966c43c217"],
Cell[100890, 2815, 485, 10, 28, "Message",ExpressionUUID->"e977b1cd-852b-42fa-8a25-2df8064e2719"],
Cell[101378, 2827, 374, 9, 28, "Message",ExpressionUUID->"912a0b66-1554-4919-a64d-3094afc2b616"],
Cell[101755, 2838, 380, 9, 28, "Message",ExpressionUUID->"e58125e9-050c-4ba4-be85-927b67488377"],
Cell[102138, 2849, 382, 9, 28, "Message",ExpressionUUID->"eb752298-df57-4a31-929b-4e893d3a2651"],
Cell[102523, 2860, 487, 10, 28, "Message",ExpressionUUID->"30185c1b-bd90-49db-8d98-996d43963c21"],
Cell[103013, 2872, 474, 10, 28, "Message",ExpressionUUID->"6d04d7cc-d1f1-4221-8afe-22fe76dd3819"],
Cell[103490, 2884, 12910, 354, 509, "Output",ExpressionUUID->"5afb6f7b-f14d-475a-aede-3810e0c1f145"],
Cell[116403, 3240, 485, 10, 28, "Message",ExpressionUUID->"5856e373-17df-44e4-a1fa-9adce634532a"],
Cell[116891, 3252, 376, 9, 28, "Message",ExpressionUUID->"a9c8cb9c-4baa-46c8-abc7-2991c7e47cda"],
Cell[117270, 3263, 1629, 27, 40, "Message",ExpressionUUID->"2c5f1333-f944-4a66-a95b-8e5d56c13bb5"],
Cell[118902, 3292, 378, 9, 28, "Message",ExpressionUUID->"c3a39dd9-035c-4c2a-bf78-952821652a7d"],
Cell[119283, 3303, 378, 9, 28, "Message",ExpressionUUID->"4dcfa65e-8fe3-4a10-ae2b-c83e0970fef7"],
Cell[119664, 3314, 384, 9, 28, "Message",ExpressionUUID->"fc214b02-4869-4bcc-a23b-ae152d6c209f"],
Cell[120051, 3325, 485, 10, 28, "Message",ExpressionUUID->"db2956fa-fbfd-4478-a802-09952245df2f"],
Cell[120539, 3337, 476, 10, 28, "Message",ExpressionUUID->"e3e410e0-ba80-43bf-8167-c4bbb0227a35"],
Cell[121018, 3349, 2642, 76, 78, "Output",ExpressionUUID->"54de6180-3d15-4de2-bb9f-20a9e43e1f09"],
Cell[123663, 3427, 485, 10, 28, "Message",ExpressionUUID->"b5b349d9-1647-4e18-ba5e-f47428635604"],
Cell[124151, 3439, 374, 9, 28, "Message",ExpressionUUID->"ae7ce407-e609-4ae2-9514-3357ef6a448a"],
Cell[124528, 3450, 4911, 70, 87, "Message",ExpressionUUID->"7445c01d-53cb-4c3b-883c-6fc7f1418649"],
Cell[129442, 3522, 378, 9, 28, "Message",ExpressionUUID->"14a67c6d-4e0e-4be0-8ab7-176783a395b1"],
Cell[129823, 3533, 380, 9, 28, "Message",ExpressionUUID->"2b394101-3cc7-4e41-b7cc-3b3b351dcafd"],
Cell[130206, 3544, 382, 9, 28, "Message",ExpressionUUID->"d42feb83-8c0f-4c38-acfa-188637c99da1"],
Cell[130591, 3555, 8060, 115, 80, "Message",ExpressionUUID->"5596a113-f73f-408c-b62c-1c4832adecbc"],
Cell[138654, 3672, 487, 10, 28, "Message",ExpressionUUID->"7f8162f5-bb49-4860-ae6f-8e30edde2052"],
Cell[139144, 3684, 476, 10, 28, "Message",ExpressionUUID->"5be6318f-e431-496a-a4c0-e72f091fea20"],
Cell[139623, 3696, 7760, 229, 144, "Output",ExpressionUUID->"15b97fec-d21e-454a-a169-effa3e2cca44"],
Cell[147386, 3927, 485, 10, 28, "Message",ExpressionUUID->"fc52b1ac-d4a8-4a2a-9608-f072973c11a9"],
Cell[147874, 3939, 376, 9, 28, "Message",ExpressionUUID->"53e5df1f-5e7c-43e4-bc11-f894e79330fe"],
Cell[148253, 3950, 378, 9, 28, "Message",ExpressionUUID->"646b329b-a81c-4a79-a7b1-577f11642b21"],
Cell[148634, 3961, 382, 9, 28, "Message",ExpressionUUID->"88dacda3-753d-4016-93e0-bef98310659f"],
Cell[149019, 3972, 487, 10, 28, "Message",ExpressionUUID->"e5fc7513-0143-4977-86fe-9d25a59d0d56"],
Cell[149509, 3984, 474, 10, 28, "Message",ExpressionUUID->"bfad6c27-807c-485f-8fe6-b3de84abf3d4"],
Cell[149986, 3996, 11548, 315, 434, "Output",ExpressionUUID->"eb5aedc5-93ab-40d5-8f90-d91f14752141"],
Cell[161537, 4313, 487, 10, 28, "Message",ExpressionUUID->"894f3e04-b6e4-4ce1-b2b8-7d47deb8e554"],
Cell[162027, 4325, 376, 9, 28, "Message",ExpressionUUID->"c6f845d4-597e-4582-b39d-aad551211cdd"],
Cell[162406, 4336, 378, 9, 28, "Message",ExpressionUUID->"ab84e97f-6637-4f80-a23e-e723eb13be50"],
Cell[162787, 4347, 382, 9, 28, "Message",ExpressionUUID->"f7738715-1c38-4ead-a73e-3bb059b18946"],
Cell[163172, 4358, 485, 10, 28, "Message",ExpressionUUID->"a0f29f33-7e29-4a48-a538-b2cf0bfcdd60"],
Cell[163660, 4370, 474, 10, 28, "Message",ExpressionUUID->"e9d7297d-790b-4a7c-b9e4-b4dcee949e28"],
Cell[164137, 4382, 11550, 315, 434, "Output",ExpressionUUID->"f6b5b3c4-a093-410a-a49d-5b9e24f97c9d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175736, 4703, 155, 3, 53, "Subtitle",ExpressionUUID->"745cca63-c79f-4d37-90a4-f9f1c533ecc9"],
Cell[175894, 4708, 1523, 29, 196, "Text",ExpressionUUID->"8a196890-91b8-40e9-b01d-c3c2d8a11938"],
Cell[177420, 4739, 1707, 43, 195, "Input",ExpressionUUID->"bde2a0cc-355e-412a-8c75-6b62573f33a1"],
Cell[CellGroupData[{
Cell[179152, 4786, 274, 5, 29, "Input",ExpressionUUID->"ac5a3ffa-d33c-4371-aeee-b88cb230802e"],
Cell[179429, 4793, 360, 9, 28, "Message",ExpressionUUID->"ba4fe9f6-eb4d-4e5c-8b8d-f32d2afdcc02"],
Cell[179792, 4804, 326, 7, 33, "Output",ExpressionUUID->"eb2d3a5c-e389-4b27-a95e-e17c261bcd65"]
}, Open  ]],
Cell[180133, 4814, 473, 9, 58, "Text",ExpressionUUID->"7d06efee-3590-46d1-a231-cbaa84101b22"],
Cell[CellGroupData[{
Cell[180631, 4827, 1024, 23, 51, "Input",ExpressionUUID->"15365c87-047f-4812-b26e-1655d50cc175"],
Cell[181658, 4852, 360, 9, 28, "Message",ExpressionUUID->"7a0bec6f-2ec9-4ff2-adf9-9eb1aa972238"],
Cell[182021, 4863, 689, 19, 33, "Output",ExpressionUUID->"3d454a08-84ca-4d05-b535-69bc591866fe"],
Cell[182713, 4884, 463, 10, 28, "Message",ExpressionUUID->"d7cb0c53-355a-4173-a384-f5460a5f0df5"],
Cell[183179, 4896, 1255, 38, 36, "Output",ExpressionUUID->"e427525b-6736-424d-88ae-884880ed379e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184471, 4939, 1651, 48, 51, "Input",ExpressionUUID->"6ae9592b-e847-47b3-8e13-9ba64edc6b19"],
Cell[186125, 4989, 362, 9, 28, "Message",ExpressionUUID->"b45c3b51-9721-4a9e-9553-558ae48725d7"],
Cell[186490, 5000, 1051, 30, 36, "Output",ExpressionUUID->"30bb7ca0-e70a-443c-990e-3e8dbe7afc65"],
Cell[187544, 5032, 463, 10, 28, "Message",ExpressionUUID->"37b60cb8-2e43-4b42-b585-8e611f461eee"],
Cell[188010, 5044, 2671, 83, 58, "Output",ExpressionUUID->"dcffc994-c0c8-4df2-ba2e-3faddccdf6db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190718, 5132, 1660, 47, 51, "Input",ExpressionUUID->"b6316d7d-c51e-49f6-bc37-ef5cffbeb405"],
Cell[192381, 5181, 360, 9, 28, "Message",ExpressionUUID->"0e1c3bfc-70e1-4985-8196-3d4e6d6a8580"],
Cell[192744, 5192, 991, 29, 36, "Output",ExpressionUUID->"57c06228-b3f6-49e6-bd89-78bf22f38c65"],
Cell[193738, 5223, 463, 10, 28, "Message",ExpressionUUID->"fe04e8f8-38cd-4fb2-ae07-ccc6e4ea3990"],
Cell[194204, 5235, 2384, 74, 58, "Output",ExpressionUUID->"e69718d4-447d-4466-9668-4f227fbcca46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196625, 5314, 1172, 29, 51, "Input",ExpressionUUID->"a512e250-1730-4882-8d2a-9b304ee02bf0"],
Cell[197800, 5345, 360, 9, 28, "Message",ExpressionUUID->"46451492-ec34-4a42-bdc5-ac37e50820c4"],
Cell[198163, 5356, 495, 15, 33, "Output",ExpressionUUID->"287b3880-e6a2-4d3a-9a79-15b46a8aa41f"],
Cell[198661, 5373, 463, 10, 28, "Message",ExpressionUUID->"6cf6606a-cc5d-4b06-92bb-30e64f615cc6"],
Cell[199127, 5385, 1063, 34, 33, "Output",ExpressionUUID->"01c8d15b-e7a8-4318-a986-0790f2738d05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200227, 5424, 1118, 27, 51, "Input",ExpressionUUID->"00193dc3-f3f0-4a73-b7b8-cde59018157d"],
Cell[201348, 5453, 360, 9, 28, "Message",ExpressionUUID->"a87b9857-7952-4fe7-8de3-a71f76d6113d"],
Cell[201711, 5464, 914, 21, 33, "Output",ExpressionUUID->"f5cc7c3a-53ba-4b02-86d1-991e4b39c2d7"],
Cell[202628, 5487, 463, 10, 28, "Message",ExpressionUUID->"cef52f34-a38a-4ed2-9e10-b99e1f3fe7ac"],
Cell[203094, 5499, 1565, 43, 35, "Output",ExpressionUUID->"b23a2cd0-c6c0-40d1-a4ed-0c09dc38b790"]
}, Open  ]],
Cell[204674, 5545, 494, 10, 81, "Text",ExpressionUUID->"25f86d65-94b6-43bd-b347-c6f9e3fd7a7d"],
Cell[CellGroupData[{
Cell[205193, 5559, 1023, 32, 51, "Input",ExpressionUUID->"270935a7-a516-4431-99f9-ba56fcf456a4"],
Cell[206219, 5593, 360, 9, 28, "Message",ExpressionUUID->"f57d1ef4-1798-490d-a07b-ba38ff7879f0"],
Cell[206582, 5604, 630, 17, 36, "Output",ExpressionUUID->"19e0802a-d66a-4924-9bc1-9d65e47fa445"],
Cell[207215, 5623, 463, 10, 28, "Message",ExpressionUUID->"52f72612-6c43-49d2-b776-79951b8af646"],
Cell[207681, 5635, 1353, 41, 36, "Output",ExpressionUUID->"6e1a2042-47e9-4b7c-a33d-23d82c0faf37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209071, 5681, 966, 29, 51, "Input",ExpressionUUID->"f4d15c1d-6a9d-4584-ae09-bd823693eed3"],
Cell[210040, 5712, 360, 9, 28, "Message",ExpressionUUID->"4fad2bb0-4aad-4525-9128-e22f5f832512"],
Cell[210403, 5723, 846, 26, 33, "Output",ExpressionUUID->"31565d84-9a00-4026-b77f-5049ceaac8b5"],
Cell[211252, 5751, 465, 10, 28, "Message",ExpressionUUID->"d42da15c-a2a2-4937-acc9-17ba37b1817f"],
Cell[211720, 5763, 1960, 63, 36, "Output",ExpressionUUID->"24fb9de0-d15d-47c0-9de6-56d1328c1da0"]
}, Open  ]],
Cell[213695, 5829, 201, 3, 35, "Text",ExpressionUUID->"65a9d9f8-2802-4167-8944-4345b2704e7f"],
Cell[CellGroupData[{
Cell[213921, 5836, 1697, 57, 92, "Input",ExpressionUUID->"df96cdd2-e556-49de-9a6e-147f4b52f94a"],
Cell[215621, 5895, 1455, 47, 36, "Output",ExpressionUUID->"a520a587-3d96-4ecb-a794-fe54d8d27861"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217113, 5947, 1326, 32, 133, "Input",ExpressionUUID->"73fa5fe8-cc63-4b6c-9dbe-7708653c2360"],
Cell[218442, 5981, 271, 7, 23, "Print",ExpressionUUID->"ef472db8-453c-40c3-8f1a-994a404d7f7b"],
Cell[218716, 5990, 384, 9, 28, "Message",ExpressionUUID->"05bd8306-6b53-44b6-b13b-21a339e63b7f"],
Cell[219103, 6001, 431, 12, 23, "Print",ExpressionUUID->"05d4715a-61ef-428f-a4e7-80fe2f50320e"],
Cell[219537, 6015, 487, 10, 28, "Message",ExpressionUUID->"5e2b316b-634e-4428-8f7e-70dd7416b702"],
Cell[220027, 6027, 376, 9, 28, "Message",ExpressionUUID->"78878189-0385-4397-8809-37c28b46e78e"],
Cell[220406, 6038, 380, 9, 28, "Message",ExpressionUUID->"f7311a60-d188-4040-82d9-67d550631cd2"],
Cell[220789, 6049, 380, 9, 28, "Message",ExpressionUUID->"54da784b-4ecf-4dc0-9a7c-a808709a5ed8"],
Cell[221172, 6060, 380, 9, 28, "Message",ExpressionUUID->"27f36da5-1d3d-4ab1-a455-5b050e9f4fdb"],
Cell[221555, 6071, 480, 10, 28, "Message",ExpressionUUID->"4893d4fd-aa27-4d1b-8421-5d58c670210f"],
Cell[222038, 6083, 384, 9, 28, "Message",ExpressionUUID->"7693994f-06f1-49d4-9aad-2ed8aeb15b85"],
Cell[CellGroupData[{
Cell[222447, 6096, 9686, 259, 378, "Print",ExpressionUUID->"fc1a5fac-01a8-4c8e-a962-1c111b0a9f68"],
Cell[232136, 6357, 295, 8, 23, "Print",ExpressionUUID->"fe389a7e-fed9-4257-afad-63d4721aba39"]
}, Open  ]],
Cell[232446, 6368, 384, 9, 28, "Message",ExpressionUUID->"c3536c93-c79e-4417-b006-2623771c5afc"],
Cell[232833, 6379, 475, 10, 28, "Message",ExpressionUUID->"d9ba59ca-864f-469a-bcee-0683413c9f7f"],
Cell[233311, 6391, 391, 11, 23, "Print",ExpressionUUID->"0c6e3493-d949-442f-8505-51b9d252f756"],
Cell[233705, 6404, 489, 10, 28, "Message",ExpressionUUID->"4691b117-b1df-4f52-9e5c-c01d7b20e4d1"],
Cell[234197, 6416, 476, 10, 28, "Message",ExpressionUUID->"b95ec85a-885b-4c43-a68e-dd67108d08b4"],
Cell[CellGroupData[{
Cell[234698, 6430, 10397, 282, 378, "Print",ExpressionUUID->"7619c26d-9f9c-4b1c-967f-bb84a1539b40"],
Cell[245098, 6714, 377, 11, 23, "Print",ExpressionUUID->"923d98c9-84b6-40be-94d7-b2a18a5135d0"],
Cell[245478, 6727, 432, 12, 23, "Print",ExpressionUUID->"2fdb901b-2ea2-4e1f-a582-4b7ce476d30d"]
}, Open  ]],
Cell[245925, 6742, 2274, 36, 39, "Message",ExpressionUUID->"361a830c-fd0a-484b-bd96-5f28bee12aff"],
Cell[248202, 6780, 3057, 45, 39, "Message",ExpressionUUID->"60a5d3f4-3563-4275-b171-337ebc6c853f"],
Cell[CellGroupData[{
Cell[251284, 6829, 2679, 83, 64, "Print",ExpressionUUID->"03c75f06-9523-4c10-83a6-65817189b5b6"],
Cell[253966, 6914, 345, 10, 23, "Print",ExpressionUUID->"4e7cea36-1638-4340-a6ef-2014664b054a"],
Cell[254314, 6926, 412, 11, 23, "Print",ExpressionUUID->"af3735de-1b32-4994-9740-78d5ec6bc5f4"]
}, Open  ]],
Cell[254741, 6940, 2622, 40, 39, "Message",ExpressionUUID->"2c64d3f9-dfb2-41a1-a48b-57da8d785fa5"],
Cell[257366, 6982, 473, 10, 28, "Message",ExpressionUUID->"8b4ca573-558f-4708-8f74-401086cdcafb"],
Cell[CellGroupData[{
Cell[257864, 6996, 3131, 95, 64, "Print",ExpressionUUID->"89f74b33-9781-4cfc-8b07-e9a868584dbf"],
Cell[260998, 7093, 429, 13, 23, "Print",ExpressionUUID->"e102d016-8de6-4dc7-ae6a-27a0b72c7044"],
Cell[261430, 7108, 458, 13, 23, "Print",ExpressionUUID->"37c95908-1294-40b8-a7d3-bdc2b1ff562f"],
Cell[261891, 7123, 4032, 122, 64, "Print",ExpressionUUID->"89f7d994-140c-4772-a5e4-714827b96eee"],
Cell[265926, 7247, 347, 10, 23, "Print",ExpressionUUID->"77802244-44ba-4631-87d7-3c3b777be8dc"],
Cell[266276, 7259, 411, 11, 23, "Print",ExpressionUUID->"e483521f-b040-4f08-bf07-94c7d98b2f11"],
Cell[266690, 7272, 4566, 137, 90, "Print",ExpressionUUID->"ed254c3a-52a4-48f3-abae-8fcddcf5edfe"],
Cell[271259, 7411, 427, 13, 23, "Print",ExpressionUUID->"1e70123d-4e55-4efc-b67b-ef64ea09d4f6"],
Cell[271689, 7426, 461, 13, 23, "Print",ExpressionUUID->"3eae6a60-e24a-4fbe-a194-40d0f663b459"],
Cell[272153, 7441, 5433, 161, 85, "Print",ExpressionUUID->"85d89466-6b67-4fd6-9cbd-d0e61e5a3083"],
Cell[277589, 7604, 345, 10, 23, "Print",ExpressionUUID->"bbe55955-509b-4e26-81c8-c80c0296beb4"],
Cell[277937, 7616, 486, 13, 23, "Print",ExpressionUUID->"51ef6ed5-a481-4725-b5eb-6e6ca5f8b1dd"],
Cell[278426, 7631, 5883, 173, 107, "Print",ExpressionUUID->"dd47fa0f-6bc3-4ef0-9c0f-8eaf3cc1713c"]
}, Open  ]]
}, Open  ]],
Cell[284336, 7808, 1211, 20, 173, "Text",ExpressionUUID->"efde2a9e-349d-41b7-bda1-519adcc67d0b"]
}, Open  ]]
}
]
*)

