(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    118706,       3257]
NotebookOptionsPosition[    105343,       3057]
NotebookOutlinePosition[    105742,       3073]
CellTagsIndexPosition[    105699,       3070]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Computing transition probabilities for two-locus \
statistics with selection", "Title"]], "Subtitle",
 CellGroupingRules->{"TitleGrouping", Inherited},
 CellChangeTimes->{{3.866550413739953*^9, 3.866550478770227*^9}, {
  3.866555479967609*^9, 
  3.866555480947106*^9}},ExpressionUUID->"584ef30d-dc91-40b3-9f41-\
a306b58dc2d7"],

Cell["\<\
This notebook derives transitions for expected two-locus statistics due to \
recombination (r), drift (Ne), mutation (u, under an infinite sites model, \
assumed to be equal at both loci), and selection (s). Selection occurs at one \
locus, here the left locus, and the right locus is a linked neutral locus.\
\>", "Text",
 CellChangeTimes->{{3.866550428618734*^9, 3.866550428995473*^9}, {
  3.8665504807375393`*^9, 
  3.866550592945072*^9}},ExpressionUUID->"3a9b7c18-bd38-4904-8530-\
abbc673e9b30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"some", " ", "definitions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "2", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "3", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "4", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"c1", ",", " ", "c2", ",", " ", "c3", ",", " ", "c4"}], "}"}]}],
     ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "cs", " ", "are", " ", "the", " ", "allele", " ", "frequencies", " ", 
       "of", " ", "AB"}], ",", " ", "Ab", ",", " ", "aB", ",", " ", 
      RowBox[{"and", " ", "ab"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"exp", "[", "monome_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"monome", ",", 
         RowBox[{
         "cs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extracts", " ", "the", " ", "exponents", " ", "of", " ", "the", " ", 
       RowBox[{"\[Product]", " ", 
        RowBox[{"c_i", "^", "k_i"}]}]}], " ", "*)"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
  3.866550892865244*^9, 3.866551059208465*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"4e0090fa-45e8-4cda-974d-929309f812ec"],

Cell[TextData[{
 "While the \[OpenCurlyDoubleQuote]cs\[CloseCurlyDoubleQuote] give the \
two-locus allele frequencies, many of the statistics we are interested in are \
given in terms of p=c1+c2 (the frequency of A), q=c1+c3 (the frequency of B), \
and D=c1c4-c2c3 (standard covariance measure of LD). Thus, we will need to \
convert between \[OpenCurlyDoubleQuote]c-space\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]pqD-space\[CloseCurlyDoubleQuote].\n\nTo give a \
probabilistic meaning to a given monome (i.e., ",
 Cell[BoxData[
  RowBox[{"\[Product]", " ", 
   RowBox[{"c_i", "^", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "0e0415a0-67a4-4203-9bf3-e8ee1d005396"],
 "), we think of this as denoting the probability of drawing a sample of size \
\[Sum]k_i and observing the ",
 StyleBox["ordered",
  FontSlant->"Italic"],
 " sample of k_1 of type 1, k_2 of type 2, etc. For example, the monome c1c2 \
means the probability that we draw a type 1 (AB) haplotype, followed by a \
type 2 (Ab) haplotype. This is in contrast to the typical ",
 StyleBox["unsorted",
  FontSlant->"Italic"],
 " notion of drawing haplotype configurations.\n\nNote: terms should always \
be thought of as ",
 StyleBox["in expectation",
  FontSlant->"Italic"],
 ". These are genome- or region-wide average statistics, where averages are \
taken over a large set of exchangeable loci.\n\nWhy do we play this \
\[OpenCurlyDoubleQuote]sorted\[CloseCurlyDoubleQuote] vs \
\[OpenCurlyDoubleQuote]unsorted\[CloseCurlyDoubleQuote] sampling game? ..."
}], "Text",
 CellChangeTimes->{{3.866550611790963*^9, 3.866550614930521*^9}, {
  3.8665511023831167`*^9, 3.8665511378617907`*^9}, {3.866551210619643*^9, 
  3.86655131254775*^9}, {3.866551380667603*^9, 3.866551563018952*^9}, {
  3.8665516472621517`*^9, 3.86655170343577*^9}, {3.866584691138134*^9, 
  3.866584739949698*^9}},ExpressionUUID->"04348e1a-2180-4a53-b92d-\
5a9833bf3ad2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ToMonomes", "[", "t_", "]"}], ":=", 
   RowBox[{"MonomialList", "[", 
    RowBox[{"t", ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}]}], "]"}]}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
   "Takes", " ", "an", " ", "expression", " ", "and", " ", "returns", " ", 
    "a", " ", "list", " ", "of", " ", "all", " ", "monomials", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", "c1c4"}], "-", 
      RowBox[{"c2c3", " ", "gets", " ", "returned", " ", "as", " ", 
       RowBox[{"{", 
        RowBox[{"c1c4", ",", 
         RowBox[{"-", "c2c3"}]}], "}"}]}]}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scale", "[", "monome_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Multinomial", "@@", "k"}]}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "scaling", " ", "factor", " ", "to", " ", "convert", " ", 
    "from", " ", "sorted", " ", "to", " ", "unsorted"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "following", " ", "functions", " ", "convert", " ", "from", 
     " ", "unsorted", " ", "to", " ", "sorted"}], ",", " ", 
    RowBox[{"and", " ", "vice", " ", "versa"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToSorted", "[", "term_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "monomes", "}"}], ",", 
     RowBox[{
      RowBox[{"monomes", "=", 
       RowBox[{"ToMonomes", "[", "term", "]"}]}], ";", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"scale", "/@", "monomes"}], ")"}], ",", "monomes"}], 
       "]"}]}]}], "]"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToUnsorted", "[", "term_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "monomes", "}"}], ",", 
    RowBox[{
     RowBox[{"monomes", "=", 
      RowBox[{"ToMonomes", "[", "term", "]"}]}], ";", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"scale", "/@", "monomes"}]}], ")"}], ",", "monomes"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pqDsorted", "[", "term_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"term", "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"c1", "+", "c2"}], "\[Equal]", "p"}], ",", 
          RowBox[{
           RowBox[{"c1", "+", "c3"}], "\[Equal]", "q"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"c1", " ", "c4"}], "-", 
            RowBox[{"c2", " ", "c3"}]}], "\[Equal]", "DD"}], ",", 
          RowBox[{
           RowBox[{"c1", "+", "c2", "+", "c3", "+", "c4"}], "\[Equal]", 
           "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "takes", " ", "cs", " ", "unsorted", " ", "term", " ", "and", " ", 
     "converts", " ", "to", " ", "p"}], ",", "q", ",", "D"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pqDunsorted", "[", "term_", "]"}], ":=", 
  RowBox[{"pqDsorted", "[", 
   RowBox[{"ToSorted", "[", "term", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tocs", "[", "pqDterm_", "]"}], ":=", 
  RowBox[{"ToUnsorted", "[", 
   RowBox[{"pqDterm", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "\[Rule]", 
       RowBox[{
        RowBox[{"c1", " ", "c4"}], "-", 
        RowBox[{"c2", " ", "c3"}]}]}], ",", " ", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"c1", "+", "c2"}]}], ",", " ", 
      RowBox[{"q", "\[Rule]", 
       RowBox[{"c1", "+", "c3"}]}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Define", " ", "D", " ", "and", " ", 
     RowBox[{"D", "^", "2"}]}], ",", " ", 
    RowBox[{
    "based", " ", "on", " ", "whether", " ", "cs", " ", "are", " ", 
     "unsorted", " ", "or", " ", "sorted"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8665512981585293`*^9, 3.866551298722571*^9}, 
   3.866551369430169*^9, {3.8665516162189693`*^9, 3.866551621368041*^9}, 
   3.8665517510462933`*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"a7c5e36c-2590-4bdc-bd5e-d7b5c36b4395"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DDUnsorted", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", " ", "c4"}], " ", "-", " ", 
       RowBox[{"c2", " ", "c3"}]}], ")"}], "/", "2"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"factor", " ", "of", " ", 
     RowBox[{"1", "/", "2"}], " ", "because", " ", "c1", " ", "c4", " ", "is",
      " ", "unsorted"}], ",", " ", 
    RowBox[{
    "but", " ", "usual", " ", "definition", " ", "of", " ", "D", " ", "is", 
     " ", 
     RowBox[{"sorted", "!"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.8665512981585293`*^9, 3.866551298722571*^9}, 
   3.866551369430169*^9, {3.8665516162189693`*^9, 3.866551621368041*^9}, {
   3.8665517510462933`*^9, 3.866551784079095*^9}, {3.866551818338913*^9, 
   3.866551819595964*^9}, {3.8665519045932083`*^9, 3.866551908896893*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"e78dec6b-9141-479c-b47a-2fb8fccccea9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToSorted", "[", "DDUnsorted", "]"}]], "Input",
 CellChangeTimes->{{3.866551824241177*^9, 3.866551896337113*^9}, 
   3.866551931222519*^9},
 CellLabel->
  "In[249]:=",ExpressionUUID->"a34127a2-e5d4-4d0c-8ee4-32a82c9232fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c2"}], " ", "c3"}], "+", 
  RowBox[{"c1", " ", "c4"}]}]], "Output",
 CellChangeTimes->{{3.866551833519046*^9, 3.866551896658763*^9}, 
   3.8665519316757107`*^9, 3.866558724039908*^9, 3.866558819397183*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"439bee88-d88a-43e8-a4d4-1502d62e3bd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Recombination", "Subtitle"]], "Subsubtitle",
 CellChangeTimes->{{3.866551289484717*^9, 
  3.8665512905726213`*^9}},ExpressionUUID->"073e83c6-35d4-48b9-b551-\
d122f7bfe12e"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ll take a random union of gametes model, so that the \
recombination operator is unaffected by drift.\n\nUsing E[c1]_{t+1} = E[c1]_t \
- rD, E[c2]_{t+1} = E[c2]_t + rD, E[c3]_{t+1} = E[c3]_t + rD, E[c4]_{t+1} = \
E[c4]_t - rD. Taking any term ",
 Cell[BoxData[
  RowBox[{"\[Product]", " ", 
   RowBox[{"c_i", "^", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "d6dda336-d452-4823-b696-ea9272b06fbc"],
 ", and neglicting terms of order ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "2"], TraditionalForm]],ExpressionUUID->
  "e82bf7b3-83bb-441c-b178-a44dd38130ba"],
 " and higher, we get ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Product]", " ", 
    RowBox[{"c_i", "^", "k_i"}]}], "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"r", " ", "DD", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k1"}], "/", "c1"}], "+", 
         RowBox[{"k2", "/", "c2"}], "+", 
         RowBox[{"k3", "/", "c3"}], "-", 
         RowBox[{"k4", "/", "c4"}]}], ")"}]}]}], ")"}], 
    RowBox[{"\[Product]", " ", 
     RowBox[{"c_i", "^", "k_i"}]}]}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "0139fac3-85e2-40b4-af64-768e1ea61930"],
 ". The following function applies this operation, and then we can write a \
function (RecombUnsorted) that applies the function sequentially to unsorted \
statistics in c-space."
}], "Text",
 CellChangeTimes->{{3.866551997070841*^9, 3.866552015653597*^9}, {
  3.866554230383066*^9, 3.866554250638155*^9}, {3.866554632782934*^9, 
  3.866554880196154*^9}},ExpressionUUID->"3dd74df5-3c33-4b9c-84e5-\
50f55027dafc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Eta]", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "1", ",", " ", 
      RowBox[{"-", "1"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Coefficients", " ", "of", " ", "transition", " ", "for", " ", 
     RowBox[{"cs", ":", " ", "c_i"}]}], " ", "\[Rule]", " ", 
    RowBox[{"c_i", " ", "+", " ", 
     RowBox[{"\[Eta]", " ", "r", " ", "D"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RecombMonome", "[", "monome_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", ",", "k", ",", "vars", ",", "DD", ",", "coeff"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cs", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
          "^", 
         RowBox[{
         "k", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeff", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"monome", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DD", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", " ", "c4"}], "-", 
        RowBox[{"c2", " ", "c3"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", ">", "0"}], ",", 
       RowBox[{"coeff", "*", "vars", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"K", ">", "0"}], ",", 
            RowBox[{"r", " ", "DD", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{
                 "k", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "/", "c1"}], "+", 
               RowBox[{
                RowBox[{
                "k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "/", "c2"}], "+", 
               RowBox[{
                RowBox[{
                "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "/", "c3"}], "-", 
               RowBox[{
                RowBox[{
                "k", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                "/", "c4"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}], ",", 
       "monome"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.866553491639883*^9, 3.866553540375498*^9}, {
   3.8665539509942093`*^9, 3.866554083493705*^9}, {3.866554216088108*^9, 
   3.866554220787105*^9}, {3.8665543684676723`*^9, 3.866554386556026*^9}, {
   3.866554472443677*^9, 3.866554472996256*^9}, 3.866555780833953*^9, {
   3.86657716747234*^9, 3.866577188785802*^9}, {3.866577416484889*^9, 
   3.866577423697749*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"bdf6ebda-0f0f-4262-ab5b-9ae9bebd1489"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Recomb", "[", "term_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{"RecombMonome", "/@", 
     RowBox[{"ToMonomes", "[", 
      RowBox[{"ToSorted", "[", "term", "]"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RecombUnsorted", "[", "term_", "]"}], ":=", 
  RowBox[{"ToUnsorted", "[", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", " ", 
     RowBox[{"RecombMonome", "/@", 
      RowBox[{"ToMonomes", "[", 
       RowBox[{"ToSorted", "[", "term", "]"}], "]"}]}], ")"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.866554085001419*^9, 3.8665541272545357`*^9}, {
  3.8665557833848753`*^9, 3.8665557859918137`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"97e1f496-ae00-4724-9c6c-1b0e1137b128"],

Cell["Test this out:", "Text",
 CellChangeTimes->{{3.866554937278434*^9, 
  3.866554940656447*^9}},ExpressionUUID->"d1cf5acb-d0b7-433e-87a9-\
6c1a2a946414"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Tocs", "[", "DD", "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"Tocs", "[", "DD", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RecombUnsorted", "[", 
  RowBox[{
   RowBox[{"c1", " ", 
    RowBox[{"c4", "/", "2"}]}], "-", 
   RowBox[{"c2", " ", 
    RowBox[{"c3", "/", "2"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{
    RowBox[{"c1", " ", 
     RowBox[{"c4", "/", "2"}]}], "-", 
    RowBox[{"c2", " ", 
     RowBox[{"c3", "/", "2"}]}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8665548879917173`*^9, 3.866554912518565*^9}, {
  3.8665549441560307`*^9, 3.866554976767127*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"034ef1cc-3c5b-463b-b2e8-96889599980c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c2", " ", "c3"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c4"}], "2"]}]], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.866561771950226*^9},
 CellLabel->
  "Out[273]=",ExpressionUUID->"791ce684-e8b4-423d-ada9-e763a9dc4c52"],

Cell[BoxData["DD"], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.8665617719521503`*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"e205bfb1-bcfe-4101-bbb5-6c34d8286e91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"c2", " ", "c3"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"c1", " ", "c4"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c2", " ", "c3", " ", "r"}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c2", "2"], " ", "c3", " ", "r"}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", "c2", " ", 
   SuperscriptBox["c3", "2"], " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["c1", "2"], " ", "c4", " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c2", " ", "c4", " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "6"], " ", "c1", " ", "c3", " ", "c4", " ", "r"}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", "c2", " ", "c3", " ", "c4", " ", "r"}], "-", 
  RowBox[{
   FractionBox["1", "3"], " ", "c1", " ", 
   SuperscriptBox["c4", "2"], " ", "r"}]}]], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.866561771954598*^9},
 CellLabel->
  "Out[275]=",ExpressionUUID->"63700385-10cf-4fd7-bda0-4bc788b58fb4"],

Cell[BoxData[
 RowBox[{"DD", "-", 
  RowBox[{"DD", " ", "r"}]}]], "Output",
 CellChangeTimes->{{3.8665548972952127`*^9, 3.866554912807499*^9}, {
   3.866554945389195*^9, 3.866554977232297*^9}, 3.8665557910979424`*^9, 
   3.866558728389688*^9, 3.866561771986215*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"71c6482d-73b1-4909-8000-3e21f45245a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"Tocs", "[", "DD", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", "^", "2"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", "^", "3"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.866554404162075*^9, 3.8665544635907993`*^9}, {
  3.866554512172394*^9, 3.8665546130428534`*^9}, {3.866554989800791*^9, 
  3.866554992510648*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"72e27084-2e02-49ef-8d28-102c3e91fd85"],

Cell[BoxData[
 RowBox[{"DD", "-", 
  RowBox[{"DD", " ", "r"}]}]], "Output",
 CellChangeTimes->{{3.866554397473692*^9, 3.866554464838044*^9}, {
   3.866554519172106*^9, 3.866554623449513*^9}, {3.866554982152773*^9, 
   3.866554993244667*^9}, 3.866555793070587*^9, 3.866558729830947*^9, 
   3.8665617741091413`*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"959d4f4e-4e5a-455d-8e9c-2f3d56a27f59"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["DD", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "r"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866554397473692*^9, 3.866554464838044*^9}, {
   3.866554519172106*^9, 3.866554623449513*^9}, {3.866554982152773*^9, 
   3.866554993244667*^9}, 3.866555793070587*^9, 3.866558729830947*^9, 
   3.866561774136018*^9},
 CellLabel->
  "Out[278]=",ExpressionUUID->"fc4dced9-7158-4a8f-b302-bb204f108310"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["DD", "3"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"3", " ", "r"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866554397473692*^9, 3.866554464838044*^9}, {
   3.866554519172106*^9, 3.866554623449513*^9}, {3.866554982152773*^9, 
   3.866554993244667*^9}, 3.866555793070587*^9, 3.866558729830947*^9, 
   3.8665617741370773`*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"f5c5d474-6033-4e80-949e-46e5e0a26349"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Drift", "Subtitle"]], "Subsubtitle",
 CellChangeTimes->{{3.866555463767095*^9, 
  3.866555464759981*^9}},ExpressionUUID->"eea14446-08e9-4e7b-a065-\
3ec4042ca706"],

Cell[TextData[{
 "We can think of a statistic ",
 Cell[BoxData[
  RowBox[{"\[Product]", " ", 
   RowBox[{"c_i", "^", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "fac95b05-761f-460d-a8fd-50ee2a39aa78"],
 " as the probability of drawing a given configuration of two-locus \
haplotypes from  ",
 Cell[BoxData[
  RowBox[{"K", "=", 
   RowBox[{"\[Sum]", "k_i"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "ca5b507d-0071-40ee-9694-89b098e63166"],
 " lineages. A \[OpenCurlyDoubleQuote]drift event\[CloseCurlyDoubleQuote] \
occurs within our K lineages when one of those lineages copies itself twice, \
replacing one of the other K-1 lineages. This will cause that copied type to \
increase in count and the replace type to decrease in count.\n\nWhat goes \
into the drift operator? The probability that a drift event does ",
 StyleBox["not",
  FontSlant->"Italic"],
 " occur among K lineages is ",
 Cell[BoxData[
  RowBox[{
   SubsuperscriptBox["\[Product]", 
    RowBox[{"i", "=", "1"}], "K"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "-", "1"}], ")"}], "/", "2"}], "/", "Ne"}]}], ")"}]}]], 
  "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "5921310d-6a62-4603-bafb-23c01758b3f6"],
 "which is approximately ",
 Cell[BoxData[
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"K", ",", "2"}], "]"}], "/", "2"}], "/", "Ne"}]}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "62b78835-d550-4eb4-8377-3a164ed26828"],
 ", and the probability of one drift event occurring is ",
 Cell[BoxData[
  RowBox[{"Binomial", "[", 
   RowBox[{"K", ",", "2"}], "]"}]], "Input",
  CellChangeTimes->{{3.866550594382571*^9, 3.866550595391045*^9}, {
   3.866550892865244*^9, 3.866551059208465*^9}},ExpressionUUID->
  "b7c45c19-eb8f-4aca-b177-e0fe226da03b"],
 ". We ignore more than one drift event occurring, which is O(1/",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ne", "2"], TraditionalForm]],ExpressionUUID->
  "84eb9521-2683-4612-86c5-d2a509bfc813"],
 "), just as we ignored higher order terms in r.\n\nThen in the even that \
probability occurs, we determine the expected increase/decrease in haplotype \
counts, given the term provided."
}], "Text",
 CellChangeTimes->{{3.8665612445192432`*^9, 3.866561404152478*^9}, {
  3.866561784452128*^9, 
  3.866562107792262*^9}},ExpressionUUID->"6c96e922-cdcc-45f5-9e7f-\
7974be5f4680"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DriftMonome", "[", 
   RowBox[{"monome_", ",", "Ne_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "K", ",", "k", ",", "vars", ",", "coeff", ",", "pcoal", ",", "kprev"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pcoal", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"K", ",", "2"}], "]"}], "/", "2"}], "/", "Ne"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cs", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
          "^", 
         RowBox[{
         "k", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeff", "=", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"monome", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", ">", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pcoal"}], ")"}], "*", "coeff", "*", "vars"}], 
        "+", "\[IndentingNewLine]", 
        RowBox[{
        "pcoal", "*", "coeff", "*", "vars", "*", "\[IndentingNewLine]", 
         RowBox[{"Sum", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"kprev", "=", 
             RowBox[{"k", "-", 
              RowBox[{"e", "[", "i", "]"}], "+", 
              RowBox[{"e", "[", "j", "]"}]}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"i", " ", "increased", " ", "1"}], ",", " ", 
              RowBox[{"j", " ", "decreased", " ", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"i", ".", "e", ".", " ", "copy"}], " ", "type", " ", 
               "i", " ", "over", " ", "j"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "kprev", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "<", "1"}], "||", 
               RowBox[{
                RowBox[{
                "kprev", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ">", "K"}]}], ",", 
              "\[IndentingNewLine]", "0", ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{"transition", " ", "not", " ", "possible"}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "\[NotEqual]", "j"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "kprev", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "kprev", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                    RowBox[{
                    "cs", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "/", 
                    RowBox[{
                    "cs", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                  RowBox[{"(*", " ", 
                   RowBox[{"transition", " ", "occurs"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "kprev", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "kprev", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], "]"}], 
                RowBox[{"(*", " ", 
                 RowBox[{"coalescence", " ", "but", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "change", " ", "state"}], 
                 " ", "*)"}], "\[IndentingNewLine]", "/", "K"}], "/", 
               RowBox[{"(", 
                RowBox[{"K", "-", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "monome"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drift", "[", 
   RowBox[{"term_", ",", "Ne_"}], "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"DriftMonome", "[", 
       RowBox[{"#", ",", "Ne"}], "]"}], "&"}], "/@", 
     RowBox[{"ToMonomes", "[", "term", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.866555794980392*^9, 3.8665559577422657`*^9}, {
   3.866556006977648*^9, 3.8665560128287582`*^9}, {3.866556076298017*^9, 
   3.866556088232374*^9}, {3.8665561379210453`*^9, 3.866556166714699*^9}, {
   3.866556518466511*^9, 3.866556689697435*^9}, {3.866556750527295*^9, 
   3.866556807913457*^9}, {3.8665571094926977`*^9, 3.866557113562207*^9}, {
   3.8665571512679443`*^9, 3.866557154237097*^9}, {3.866557231853441*^9, 
   3.866557232089779*^9}, 3.86655728730099*^9, {3.866557509965497*^9, 
   3.866557552482807*^9}, {3.86655758600814*^9, 3.866557598089033*^9}, {
   3.866557628660087*^9, 3.866557643525772*^9}, {3.866558577523831*^9, 
   3.866558579052698*^9}, {3.866558749154615*^9, 3.8665587511983643`*^9}, 
   3.866558879741498*^9, {3.866558949506627*^9, 3.86655896974541*^9}, {
   3.866570394553712*^9, 3.8665704092615213`*^9}, {3.866577284921359*^9, 
   3.866577304286643*^9}},
 CellLabel->
  "In[541]:=",ExpressionUUID->"bb04c2bc-caa1-4e68-9131-f6cbe1aed486"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"drift", "[", 
   RowBox[{
    RowBox[{"Tocs", "[", "DD", "]"}], ",", "Ne"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.866557057302205*^9, 3.866557071914991*^9}, {
  3.8665576524683447`*^9, 3.866557668755521*^9}, {3.866558599469614*^9, 
  3.866558606713876*^9}},
 CellLabel->
  "In[543]:=",ExpressionUUID->"9e4959c5-c31a-4c04-b8da-8723e3d3d420"],

Cell[BoxData[
 RowBox[{"DD", "-", 
  FractionBox["DD", 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{
  3.866557072306365*^9, 3.866557242239599*^9, 3.866557291165021*^9, 
   3.8665574583716497`*^9, {3.866557512438797*^9, 3.866557518337215*^9}, {
   3.866557591693758*^9, 3.866557600494104*^9}, {3.866557646679381*^9, 
   3.866557669060481*^9}, {3.866558581492558*^9, 3.866558613551693*^9}, 
   3.8665587330658197`*^9, 3.8665587819537773`*^9, {3.8665589556546173`*^9, 
   3.866558972272105*^9}, 3.8665704193933496`*^9, 3.866577316437666*^9},
 CellLabel->
  "Out[543]=",ExpressionUUID->"bad6a46a-14bd-4ab9-a5b5-27ea94781d71"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DriftMonome", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "^", "2"}], " ", 
    RowBox[{"c4", "^", "2"}]}], ",", "NN"}], "]"}]], "Input",
 CellChangeTimes->{{3.866558241257471*^9, 3.8665582944618483`*^9}, 
   3.866558345194829*^9, {3.8665583809713984`*^9, 3.866558381987627*^9}, 
   3.866558478351883*^9, {3.8665586233045683`*^9, 3.866558624681019*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"1272e920-5f03-4f43-ba36-3c0f2182e2e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["c1", "2"], " ", 
   SuperscriptBox["c4", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox["3", "NN"]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["c1", "2"], " ", 
    SuperscriptBox["c4", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "3"], "+", 
      FractionBox["c2", 
       RowBox[{"12", " ", "c1"}]], "+", 
      FractionBox["c3", 
       RowBox[{"12", " ", "c1"}]], "+", 
      FractionBox["c1", 
       RowBox[{"4", " ", "c4"}]], "+", 
      FractionBox["c2", 
       RowBox[{"12", " ", "c4"}]], "+", 
      FractionBox["c3", 
       RowBox[{"12", " ", "c4"}]], "+", 
      FractionBox["c4", 
       RowBox[{"4", " ", "c1"}]]}], ")"}]}], "NN"]}]], "Output",
 CellChangeTimes->{{3.866558278196961*^9, 3.866558294784658*^9}, 
   3.866558346164052*^9, 3.866558382571268*^9, 3.866558479123199*^9, {
   3.866558614646224*^9, 3.8665586319727087`*^9}, 3.866558735311784*^9, 
   3.8665587828097477`*^9, {3.866558956770631*^9, 3.866558973289125*^9}},
 CellLabel->
  "Out[257]=",ExpressionUUID->"1dc58842-7b75-4d34-b15f-ed80f2234e04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", "^", "2"}], "]"}], ",", "Ne"}], "]"}], "]"}], "]"}], 
   ",", "DD"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "p"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "q"}]}], ")"}]}], "]"}], ",", "Ne"}], "]"}], "]"}], 
    "]"}], ",", "DD"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", 
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}], "q", 
         RowBox[{"(", 
          RowBox[{"1", "-", "q"}], ")"}]}], "]"}], ",", "Ne"}], "]"}], "]"}], 
    "]"}], ",", "DD"}], "]"}]}], "Input",
 CellChangeTimes->{{3.709032902872877*^9, 3.709032920840023*^9}, {
  3.713699262468418*^9, 3.713699279201479*^9}, {3.71369934380926*^9, 
  3.7136993453290243`*^9}, {3.713779768101837*^9, 3.713779771500746*^9}, {
  3.713781382818722*^9, 3.7137814007705173`*^9}, {3.866558307258851*^9, 
  3.86655831483249*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"73e67e94-e5e9-4ad5-9df8-d1e7677914cf"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["DD", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q"}], 
   RowBox[{"2", " ", "Ne"}]], "+", 
  FractionBox[
   RowBox[{"DD", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{
  3.866558315686983*^9, {3.866558767093163*^9, 3.866558783810658*^9}, 
   3.866558974295041*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"3a94dc42-bf28-402a-9660-213af0b78033"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["DD", "2"]}], "Ne"], "+", 
  FractionBox[
   RowBox[{"DD", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "5"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{
  3.866558315686983*^9, {3.866558767093163*^9, 3.866558783810658*^9}, 
   3.866558974379283*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"0d770b95-8ab0-43a7-9249-1c17d5110379"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "Ne"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "q"}], ")"}], " ", "q"}], "Ne"], "+", 
  FractionBox[
   RowBox[{"DD", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{
  3.866558315686983*^9, {3.866558767093163*^9, 3.866558783810658*^9}, 
   3.866558974477433*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"abdb2f2b-6940-4e26-99fe-e789cadc1f56"]
}, Open  ]],

Cell["We can combine drift and recombination:", "Text",
 CellChangeTimes->{{3.866559040300219*^9, 
  3.866559044320545*^9}},ExpressionUUID->"d1c1167d-b45b-4a16-8537-\
b70ce73e3c52"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"pqDunsorted", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"drift", "[", 
     RowBox[{
      RowBox[{"RecombUnsorted", "[", 
       RowBox[{"Tocs", "[", "DD", "]"}], "]"}], ",", "Ne"}], "]"}], "]"}], 
   "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"pqDunsorted", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"RecombUnsorted", "[", 
     RowBox[{"drift", "[", 
      RowBox[{
       RowBox[{"Tocs", "[", "DD", "]"}], ",", "Ne"}], "]"}], "]"}], "]"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.708103598887712*^9, 3.708103617474635*^9}, {
   3.7137115104636*^9, 3.713711514647459*^9}, 3.866559016187646*^9, {
   3.8665590463496723`*^9, 3.866559076439638*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"0305386c-2ef8-4467-85f4-dad15174e7ea"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"DD", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{3.866559078870782*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"955a00de-ecfc-44a0-b902-2e1c67b90213"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"DD", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
   RowBox[{"2", " ", "Ne"}]]}]], "Output",
 CellChangeTimes->{3.8665590788974037`*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"4f2b6f9a-e7f1-42f4-8129-ab2afdd70897"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"driftrecomb", "[", "term_", "]"}], ":=", 
  RowBox[{"RecombUnsorted", "[", 
   RowBox[{"drift", "[", 
    RowBox[{"term", ",", "Ne"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708104964260859*^9, 3.7081050856358433`*^9}, {
   3.708106876654913*^9, 3.708106886853663*^9}, {3.866559157656253*^9, 
   3.866559159635529*^9}, 3.866559202675125*^9, {3.866577225167461*^9, 
   3.866577228840172*^9}},
 CellLabel->
  "In[559]:=",ExpressionUUID->"7a0ac765-6d7f-4c38-a1d5-ec9a3ee6ec67"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"PolynomialReduce", "[", 
   RowBox[{
    RowBox[{"pqDunsorted", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"driftrecomb", "[", 
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", " ", "^", "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], ",", 
      RowBox[{"DD", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "q"}]}], ")"}]}], ",", 
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "q", 
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"DD", ",", "p", ",", "q"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"PolynomialReduce", "[", 
   RowBox[{
    RowBox[{"pqDunsorted", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"driftrecomb", "[", 
       RowBox[{"Tocs", "[", 
        RowBox[{"DD", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "p"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "q"}]}], ")"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], ",", 
      RowBox[{"DD", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "q"}]}], ")"}]}], ",", 
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "q", 
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"DD", ",", "p", ",", "q"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"PolynomialReduce", "[", 
   RowBox[{
    RowBox[{"pqDunsorted", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"driftrecomb", "[", 
       RowBox[{"Tocs", "[", 
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}], "q", 
         RowBox[{"(", 
          RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], ",", 
      RowBox[{"DD", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "q"}]}], ")"}]}], ",", 
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "q", 
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"DD", ",", "p", ",", "q"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.709032902872877*^9, 3.709032920840023*^9}, {
   3.713699262468418*^9, 3.713699279201479*^9}, {3.71369934380926*^9, 
   3.7136993453290243`*^9}, {3.713779768101837*^9, 3.713779771500746*^9}, 
   3.713781382818722*^9, {3.7137829715702457`*^9, 3.713783161873795*^9}, 
   3.7137832474820747`*^9, {3.713783605887744*^9, 3.713783610286479*^9}, {
   3.866559219557336*^9, 3.866559267351377*^9}},
 CellLabel->
  "In[560]:=",ExpressionUUID->"5e7e3695-791b-4f3e-b014-090ea8a4080d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"Ne", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"4", " ", "r"}]}], ")"}]}], "+", 
       RowBox[{"6", " ", "r"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], 
       RowBox[{"2", " ", "Ne"}]]}], ",", 
     FractionBox["1", 
      RowBox[{"2", " ", "Ne"}]]}], "}"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.866559227495386*^9, 3.866559267838496*^9}, 
   3.866577206876555*^9, 3.866577327601013*^9, 3.866577437214408*^9},
 CellLabel->
  "Out[560]=",ExpressionUUID->"d1a9f030-e24b-4774-b8b6-11577886de16"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "-", 
       RowBox[{"4", " ", "r"}]}], "Ne"], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"2", " ", "Ne"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}]}], 
       RowBox[{"2", " ", "Ne"}]]}], ",", "0"}], "}"}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.866559227495386*^9, 3.866559267838496*^9}, 
   3.866577206876555*^9, 3.866577327601013*^9, 3.866577437243473*^9},
 CellLabel->
  "Out[561]=",ExpressionUUID->"1cb345db-7013-40a4-b32d-93930271fd32"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], 
       RowBox[{"2", " ", "Ne"}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "Ne"}], "Ne"]}], "}"}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.866559227495386*^9, 3.866559267838496*^9}, 
   3.866577206876555*^9, 3.866577327601013*^9, 3.866577437273452*^9},
 CellLabel->
  "Out[562]=",ExpressionUUID->"1832a20d-6352-4183-92a3-0fe5390d314e"]
}, Open  ]],

Cell[TextData[{
 "Above, there are r/Ne terms that we would ignore (as we ignored ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "2"], TraditionalForm]],ExpressionUUID->
  "5368777e-1a81-4a41-955d-79ca48b2d4be"],
 " terms and 1/",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ne", "2"], TraditionalForm]],ExpressionUUID->
  "ab423d10-2f14-4375-a655-0a174ae558bb"],
 " terms)."
}], "Text",
 CellChangeTimes->{{3.866559319592231*^9, 
  3.8665593567860727`*^9}},ExpressionUUID->"c12e1f0f-7652-4d48-a063-\
30fc9be63a73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutation", "Subtitle",
 CellChangeTimes->{{3.866562124089957*^9, 
  3.866562124677462*^9}},ExpressionUUID->"d44b79df-f145-4a93-bc50-\
9d5a6d1d4901"],

Cell["\<\
The infinite sites model (ISM), in which only a single mutation occurs at the \
left and right loci.

This construction is a bit contrived, and it\[CloseCurlyQuote]s maybe a bit \
more natural to think of a reversible mutation model in the two-locus \
setting. However, the ISM gives us a simple mutation operator, so that \
single-locus statistics p(1-p) and q(1-q) increase linearly in the mutation \
rate (balanced by drift), and two-locus statistics are unchanged by mutation \
except for the joint heterozygosity p(1-p)q(1-q), which increases as \
u(p(1-p)+q(1-q)).\
\>", "Text",
 CellChangeTimes->{{3.8665621479617357`*^9, 3.866562153075098*^9}, {
   3.866584307746313*^9, 3.866584309852542*^9}, {3.866584354318667*^9, 
   3.8665844577868156`*^9}, {3.8665845534689283`*^9, 3.866584681074524*^9}, 
   3.866584759415875*^9},ExpressionUUID->"528e3cbe-9c6b-44fc-bb4d-\
f0a2ffa0970a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMonomespqD", "[", "t_", "]"}], ":=", 
  RowBox[{"MonomialList", "[", 
   RowBox[{"t", ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.86656285474113*^9, 3.8665628692609262`*^9}, {
  3.8665763316766644`*^9, 3.8665763416032553`*^9}},
 CellLabel->
  "In[563]:=",ExpressionUUID->"723e3d04-781a-43a4-9f42-0d74d859d996"],

Cell["\<\
The mutation operator is much simpler to apply in p-q-D space, rather than \
c-space...\
\>", "Text",
 CellChangeTimes->{{3.866584767303543*^9, 
  3.8665847865604362`*^9}},ExpressionUUID->"7571f009-14c7-4611-918a-\
162503f40d46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MutateMonomespqD", "[", 
   RowBox[{"monome_", ",", "u_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", "K", ",", "vars", ",", "coeff"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Here", ",", " ", 
      RowBox[{"a", " ", "monome", " ", "is", " ", 
       RowBox[{"p", "^", "k1"}], " ", 
       RowBox[{"q", "^", "k2"}], " ", 
       RowBox[{"D", "^", "k3"}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"Exponent", "[", 
       RowBox[{"monome", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{
       RowBox[{"p", "^", 
        RowBox[{"k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       RowBox[{"q", "^", 
        RowBox[{"k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       RowBox[{"DD", "^", 
        RowBox[{
        "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", "\[Equal]", "0"}], ",", "monome", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeff", "=", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"monome", ",", "vars"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coeff", "*", 
         RowBox[{"(", 
          RowBox[{"vars", "\[IndentingNewLine]", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Equal]", "0"}], "&&", 
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"u", "*", 
              RowBox[{"q", "^", 
               RowBox[{
               "k", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             "0"}], "]"}], "\[IndentingNewLine]", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Equal]", "0"}], "&&", 
              RowBox[{
               RowBox[{
               "k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"u", "*", 
              RowBox[{"p", "^", 
               RowBox[{
               "k", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             "0"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"mutatepqD", "[", "term_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"MutateMonomespqD", "[", 
       RowBox[{"#", ",", "u"}], "]"}], "&"}], "/@", 
     RowBox[{"ToMonomespqD", "[", "term", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.866568240983268*^9, 3.866568270416985*^9}, {
   3.866568440366432*^9, 3.866568663993638*^9}, {3.8665688232808447`*^9, 
   3.86656883466367*^9}, {3.8665694226839867`*^9, 3.866569511935463*^9}, {
   3.866569571863986*^9, 3.866569577073422*^9}, 3.866569630792643*^9, {
   3.866569964053212*^9, 3.866570030345414*^9}, {3.866570113074029*^9, 
   3.866570155255253*^9}, {3.866570496231598*^9, 3.86657065118402*^9}, {
   3.866570698190411*^9, 3.866570755816284*^9}, 3.8665708123389463`*^9, {
   3.866570908033476*^9, 3.866570918938554*^9}, {3.866570950282754*^9, 
   3.866570960158103*^9}, {3.866574412195513*^9, 3.866574515113336*^9}, {
   3.866574603774395*^9, 3.8665746309423103`*^9}, {3.866574663116518*^9, 
   3.866575026488743*^9}, {3.866575068573234*^9, 3.8665751466906557`*^9}, {
   3.866575220029718*^9, 3.866575291552993*^9}, 3.866575323304879*^9, {
   3.866575461020411*^9, 3.866575489609087*^9}, {3.8665755242884703`*^9, 
   3.866575762707724*^9}, {3.866575894207428*^9, 3.866576030995266*^9}, {
   3.8665761464790277`*^9, 3.866576164184738*^9}, {3.866576204141224*^9, 
   3.866576206670355*^9}, {3.866576259246331*^9, 3.8665762815572033`*^9}, {
   3.8665765223587103`*^9, 3.8665767050051203`*^9}, {3.866576763117721*^9, 
   3.866576770194171*^9}, {3.86657762280608*^9, 3.866577634711931*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"939b21b8-e5a3-45f7-88df-df1a8549caaa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "]"}], "-", 
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.866576011104019*^9, 3.866576053418261*^9}, {
  3.86657617820438*^9, 3.866576239133795*^9}, {3.866576748622472*^9, 
  3.866576758662352*^9}},
 CellLabel->
  "In[566]:=",ExpressionUUID->"6894c8c5-1be8-4978-9125-076b8f6ad6f3"],

Cell[BoxData["u"], "Output",
 CellChangeTimes->{{3.866576759014266*^9, 3.8665767755073423`*^9}, 
   3.8665774437745953`*^9},
 CellLabel->
  "Out[566]=",ExpressionUUID->"676eac02-0f9e-465b-93e1-8b2aadb73057"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"DD", "^", "2"}], "]"}], "-", 
   RowBox[{"DD", "^", "2"}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], "]"}], "-", 
   RowBox[{"DD", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "p"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "q"}]}], ")"}]}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mutatepqD", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "-", 
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "q", 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.866576245019402*^9, 3.866576245173414*^9}, {
  3.8665763701221943`*^9, 3.866576389640358*^9}, {3.8665767218463097`*^9, 
  3.866576725563469*^9}, {3.866584480577897*^9, 3.866584516275036*^9}},
 CellLabel->
  "In[616]:=",ExpressionUUID->"2f491b85-e088-48ea-91af-5cb4bf6c029e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.866576245596253*^9, 3.86657628658751*^9, {3.866576347820075*^9, 
   3.866576390052059*^9}, 3.866576597725399*^9, {3.8665767094759693`*^9, 
   3.866576726021802*^9}, 3.866576777378867*^9, 3.866577445253089*^9, 
   3.866577611568569*^9, 3.866577645059973*^9, 3.866584516775796*^9},
 CellLabel->
  "Out[616]=",ExpressionUUID->"acb51416-59e6-4a21-b486-db7fef56358f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.866576245596253*^9, 3.86657628658751*^9, {3.866576347820075*^9, 
   3.866576390052059*^9}, 3.866576597725399*^9, {3.8665767094759693`*^9, 
   3.866576726021802*^9}, 3.866576777378867*^9, 3.866577445253089*^9, 
   3.866577611568569*^9, 3.866577645059973*^9, 3.866584516779985*^9},
 CellLabel->
  "Out[617]=",ExpressionUUID->"4b8d7cdd-90f4-493c-9886-c739029dfe2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", "-", 
    SuperscriptBox["p", "2"], "+", "q", "-", 
    SuperscriptBox["q", "2"]}], ")"}], " ", "u"}]], "Output",
 CellChangeTimes->{
  3.866576245596253*^9, 3.86657628658751*^9, {3.866576347820075*^9, 
   3.866576390052059*^9}, 3.866576597725399*^9, {3.8665767094759693`*^9, 
   3.866576726021802*^9}, 3.866576777378867*^9, 3.866577445253089*^9, 
   3.866577611568569*^9, 3.866577645059973*^9, 3.8665845167831984`*^9},
 CellLabel->
  "Out[618]=",ExpressionUUID->"b9b67d63-6f48-4219-bf63-da1b921430d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mutatepqD", "[", 
   RowBox[{
    RowBox[{"p", "^", "2"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "^", "2"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.866576289378665*^9, 3.866576298118928*^9}, {
  3.866576360064986*^9, 3.866576362370843*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"2967b2cc-04ab-4048-a8e5-1fc8b12984f3"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], "2"], " ", 
  SuperscriptBox["p", "2"]}]], "Output",
 CellChangeTimes->{{3.866576295258511*^9, 3.866576298553335*^9}, {
   3.866576349586447*^9, 3.866576362861701*^9}, 3.866576601496724*^9, 
   3.8665767354571323`*^9, 3.8665767792179193`*^9, 3.866577446329763*^9, 
   3.866577648212039*^9},
 CellLabel->
  "Out[589]=",ExpressionUUID->"317e60e4-fa9b-4ab1-bf1f-6d597c0aea99"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutatedriftrecomb", "[", "term_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"pqDunsorted", "[", 
    RowBox[{"driftrecomb", "[", 
     RowBox[{"Tocs", "[", 
      RowBox[{"mutatepqD", "[", "term", "]"}], "]"}], "]"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.866569167261849*^9, 3.8665691690077267`*^9}, {
  3.866570317948985*^9, 3.866570360908865*^9}, {3.8665704315127*^9, 
  3.866570435706027*^9}, {3.866574536040612*^9, 3.866574575736442*^9}, {
  3.8665768176489973`*^9, 3.866576830471183*^9}, {3.866576941746621*^9, 
  3.866576959814362*^9}, {3.8665770268661118`*^9, 3.866577036421327*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"734903f8-cde0-41da-ba90-0c3e5dbe12f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "]"}], "-", 
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.866576962510611*^9, 3.86657700100712*^9}, {
  3.866577100772524*^9, 3.866577103252489*^9}, {3.8665774582779837`*^9, 
  3.866577521978351*^9}, {3.866577557127714*^9, 3.8665775606760187`*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"01e69b4d-ba78-4ce4-a0e0-242331a074c5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "p"}], "+", 
   SuperscriptBox["p", "2"], "+", 
   RowBox[{"2", " ", "Ne", " ", "u"}]}], 
  RowBox[{"2", " ", "Ne"}]]], "Output",
 CellChangeTimes->{{3.8665769670750628`*^9, 3.866576997475501*^9}, 
   3.866577038328718*^9, 3.866577103648015*^9, 3.866577218150243*^9, 
   3.8665773809320297`*^9, {3.8665774483702507`*^9, 3.866577522388764*^9}, 
   3.8665775610591*^9},
 CellLabel->
  "Out[577]=",ExpressionUUID->"b7450d56-14d4-4317-bf5e-0c2e96c4cb17"]
}, Open  ]],

Cell[TextData[{
 "With mutation, drift, and recombination, we can get the Hill-Robertson \
system of equations for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["D", "2"], TraditionalForm]],ExpressionUUID->
  "e75c2523-e76a-49b7-89ff-1d8097bcfe16"],
 ".\n\nNote that although we don\[CloseCurlyQuote]t have 1/Ne^2 or r^2 terms, \
or higher, they contain r/Ne terms, which we would also typically ignore."
}], "Text",
 CellChangeTimes->{{3.8665838927578993`*^9, 3.866583952671402*^9}, {
  3.866584003885673*^9, 
  3.8665840869900827`*^9}},ExpressionUUID->"cfa6a3c5-db13-4001-b79e-\
44d0c775c403"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"basis1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"DD", "^", "2"}], ",", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], ",", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], ",", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], ",", 
    RowBox[{"q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.866576854805629*^9, 3.866576890693565*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"4c05ba30-55a0-4d2a-9e76-49d28066101c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["DD", "2"], ",", 
   RowBox[{"DD", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "q"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}], " ", "q"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}], " ", "q"}]}], "}"}]], "Output",
 CellChangeTimes->{3.86657689204601*^9, 3.866577040684642*^9, 
  3.866577568358522*^9, 3.866583938688264*^9},
 CellLabel->
  "Out[595]=",ExpressionUUID->"7bac531a-5cb7-4bde-9436-f1e6e3991a41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{
   RowBox[{"mutatedriftrecomb", "[", 
    RowBox[{"basis1", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", "basis1", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.866576895810225*^9, 3.866576932953076*^9}, {
  3.8665769757325907`*^9, 3.866576980012375*^9}, {3.866577048604439*^9, 
  3.866577054528633*^9}, {3.866584153285893*^9, 3.866584175726635*^9}},
 CellLabel->
  "In[611]:=",ExpressionUUID->"3bb69849-2be3-4eb1-b786-3f966c43c217"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", "Ne"}], "+", 
       RowBox[{"6", " ", "r"}], "-", 
       RowBox[{"4", " ", "Ne", " ", "r"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     FractionBox[
      RowBox[{"1", "-", "r"}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     FractionBox["1", 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", "0"}], "}"}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195579891*^9},
 CellLabel->
  "Out[611]=",ExpressionUUID->"d33ece22-ddc3-4a81-b600-52dd93dca90e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"4", "-", 
       RowBox[{"8", " ", "r"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "5"}], "+", 
       RowBox[{"2", " ", "Ne"}], "+", 
       RowBox[{"5", " ", "r"}], "-", 
       RowBox[{"2", " ", "Ne", " ", "r"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195613516*^9},
 CellLabel->
  "Out[612]=",ExpressionUUID->"c942c627-19a2-48f7-8114-6a730e6ad8ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"1", "-", "r"}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "u"}], "+", 
       RowBox[{"2", " ", "Ne", " ", "u"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "u"}], "+", 
       RowBox[{"2", " ", "Ne", " ", "u"}]}], 
      RowBox[{"2", " ", "Ne"}]]}], "}"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195651154*^9},
 CellLabel->
  "Out[613]=",ExpressionUUID->"76c38813-6b2d-46ed-a5bd-1c61592131d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0"}], "}"}], ",", "u"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195664979*^9},
 CellLabel->
  "Out[614]=",ExpressionUUID->"2c27feb3-e9a4-4a68-aae7-c7d7bf847e1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]]}], "}"}], ",", "u"}], "}"}]], "Output",
 CellChangeTimes->{{3.866576914232785*^9, 3.866576924892727*^9}, 
   3.8665769804028807`*^9, {3.866577041734146*^9, 3.866577054909589*^9}, 
   3.8665775895804768`*^9, 3.866577650658745*^9, 3.866583939945566*^9, 
   3.866584195677643*^9},
 CellLabel->
  "Out[615]=",ExpressionUUID->"25ff548e-5456-4b8f-8761-90a620c6fb39"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection", "Subtitle",
 CellChangeTimes->{{3.866584255934545*^9, 
  3.866584256930895*^9}},ExpressionUUID->"745cca63-c79f-4d37-90a4-\
f9f1c533ecc9"],

Cell[TextData[{
 "Now for the fun part! Above, we saw that the two-locus statistics that we \
considered (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["D", "2"], TraditionalForm]],ExpressionUUID->
  "35d852f6-b843-4f7c-bc99-6cae0fffdb94"],
 " and \[OpenCurlyDoubleQuote]friends\[CloseCurlyDoubleQuote]) all close \
under drift, recombination, and mutation. What does \
\[OpenCurlyDoubleQuote]closure\[CloseCurlyDoubleQuote] mean? It means that we \
can compute the evolution of the expected ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["D", "2"], TraditionalForm]],ExpressionUUID->
  "0184b803-eaed-4b3d-b817-d31654c5b125"],
 " exactly with a finite number of additional terms, each of which depend \
only on each other and no additional statistics. This emits a finite (linear) \
system of equations.\n\nWhy do these statistics close? It likely has to do \
with the symmetries of the statistics. There is a symmetry across loci (left \
and right locus are both neutral, in the above equations), and a symmetry \
between derived and ancestral states at both loci.\n\nSelection will break \
this symmetry, both between the left and right loci, as one locus will carry \
negatively selected mutations and the other will be neutral. And the selected \
locus will no longer have that symmetry between ancestral and derived \
states."
}], "Text",
 CellChangeTimes->{{3.866584800013844*^9, 3.86658496123209*^9}, {
  3.8665850430968246`*^9, 
  3.8665851483230124`*^9}},ExpressionUUID->"8a196890-91b8-40e9-b01d-\
c3c2d8a11938"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SelectMonomes", "[", 
   RowBox[{"monome_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"exp", "[", "monome", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"Plus", "@@", "k"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"K", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", "monome", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"monome", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "k", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "k", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
             RowBox[{"K", " ", "p"}]}], ")"}], "s"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"select", "[", "term_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SelectMonomes", "[", 
       RowBox[{"#", ",", "s"}], "]"}], "&"}], "/@", 
     RowBox[{"ToMonomes", "[", "term", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.866636930142332*^9, 3.866637055146299*^9}, {
   3.866637103116914*^9, 3.866637198904436*^9}, {3.866637295947781*^9, 
   3.866637302940421*^9}, {3.8666373943849773`*^9, 3.866637415594205*^9}, 
   3.866637526740471*^9},
 CellLabel->
  "In[650]:=",ExpressionUUID->"bde2a0cc-355e-412a-8c75-6b62573f33a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", "p", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.866637662597911*^9, 3.866637687045638*^9}},
 CellLabel->
  "In[662]:=",ExpressionUUID->"ac5a3ffa-d33c-4371-aeee-b88cb230802e"],

Cell[BoxData[
 RowBox[{"p", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "s", "-", 
    RowBox[{"p", " ", "s"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.86663767097022*^9, 3.8666376873489037`*^9}},
 CellLabel->
  "Out[662]=",ExpressionUUID->"7cb656c6-82bc-4961-87fe-5433feb14b4a"]
}, Open  ]],

Cell["\<\
Above, we see that p\[CloseCurlyQuote]=p+sp(1-p), or \
\[CapitalDelta]p=sp(1-p), as expected.
Below, let\[CloseCurlyQuote]s check some of the terms in the Hill-Robertson \
system. (PoynomialReduce can be an annoying function..)\
\>", "Text",
 CellChangeTimes->{{3.866637733196657*^9, 3.866637785691969*^9}, {
  3.86663820391868*^9, 3.866638214860268*^9}, {3.8667125651025953`*^9, 
  3.866712567052301*^9}},ExpressionUUID->"7d06efee-3590-46d1-a231-\
cbaa84101b22"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pqDunsorted", "[", 
   RowBox[{"select", "[", 
    RowBox[{"Tocs", "[", 
     RowBox[{"DD", "^", "2"}], "]"}], "]"}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", "^", "2"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.8666377891956377`*^9, 
   3.86663790835636*^9}, 3.866638061284276*^9, {3.8666381107313128`*^9, 
   3.866638118510091*^9}, {3.86663845523435*^9, 3.866638478831828*^9}},
 CellLabel->
  "In[735]:=",ExpressionUUID->"15365c87-047f-4812-b26e-1655d50cc175"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["DD", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"4", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.866637790359427*^9, 3.866637809578174*^9}, {
   3.8666378545134077`*^9, 3.866637908682248*^9}, 3.866638061720067*^9, {
   3.866638460531949*^9, 3.8666384793569527`*^9}},
 CellLabel->
  "Out[735]=",ExpressionUUID->"abc2f3bd-f10f-4db1-bdb3-3644033f1383"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", " ", "s"}], "}"}], ",", 
   SuperscriptBox["DD", "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.866637790359427*^9, 3.866637809578174*^9}, {
   3.8666378545134077`*^9, 3.866637908682248*^9}, 3.866638061720067*^9, {
   3.866638460531949*^9, 3.866638479359993*^9}},
 CellLabel->
  "Out[736]=",ExpressionUUID->"93e255fe-c4bb-491d-98e7-42cbb7f492f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"DD", "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637822182878*^9}, {3.8666380667396708`*^9, 3.8666381970772343`*^9}, 
   3.8666384516621733`*^9},
 CellLabel->
  "In[737]:=",ExpressionUUID->"6ae9592b-e847-47b3-8e13-9ba64edc6b19"],

Cell[BoxData[
 RowBox[{"DD", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "s", "-", 
    RowBox[{"2", " ", "DD", " ", "s"}], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["p", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "q"}]}], ")"}], " ", "s"}], "-", 
    RowBox[{"2", " ", "q", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "s"}], ")"}]}], "+", 
    RowBox[{"2", " ", "p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"3", " ", "s"}], "+", 
       RowBox[{"2", " ", "DD", " ", "s"}], "+", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"6", " ", "s"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.8666378267369204`*^9, {3.8666380682711554`*^9, 3.8666381974673777`*^9}, 
   3.866638487098866*^9},
 CellLabel->
  "Out[737]=",ExpressionUUID->"ad22d588-3e0d-4bca-9aa9-49b9b092a4c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "s"}], "2"], ",", "1", ",", 
     RowBox[{"-", 
      FractionBox["s", "2"]}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "s"}]}], "}"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8666378267369204`*^9, {3.8666380682711554`*^9, 3.8666381974673777`*^9}, 
   3.866638487101223*^9},
 CellLabel->
  "Out[738]=",ExpressionUUID->"57810e3a-1f0d-4507-ac0c-a5f60a96a04e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "q", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "q", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "p"}]}], ")"}], "^", "2"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637824828907*^9}, {3.866638356502575*^9, 3.8666384063818207`*^9}, 
   3.8666384506424417`*^9},
 CellLabel->
  "In[739]:=",ExpressionUUID->"b6316d7d-c51e-49f6-bc37-ef5cffbeb405"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}]}], " ", "p", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"DD", " ", "s"}], "+", 
    RowBox[{"q", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "s", "-", 
       RowBox[{"2", " ", "DD", " ", "s"}], "-", 
       RowBox[{"2", " ", "p", " ", "s"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.8666378293433867`*^9, {3.866638357155648*^9, 3.866638406751561*^9}, 
   3.866638490046873*^9},
 CellLabel->
  "Out[739]=",ExpressionUUID->"bcda8de8-8241-4746-bbae-062cd4b69bc5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "1", ",", 
     RowBox[{"-", 
      FractionBox["s", "4"]}], ",", 
     FractionBox["s", "4"]}], "}"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8666378293433867`*^9, {3.866638357155648*^9, 3.866638406751561*^9}, 
   3.866638490049594*^9},
 CellLabel->
  "Out[740]=",ExpressionUUID->"0ae6149e-e4a2-40b8-9627-c875c2f23c35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637824828907*^9}, {3.866638431625868*^9, 3.866638448631967*^9}, {
   3.86663849806496*^9, 3.866638536155611*^9}, 3.866638971944365*^9},
 CellLabel->
  "In[768]:=",ExpressionUUID->"a512e250-1730-4882-8d2a-9b304ee02bf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.866638973979842*^9},
 CellLabel->
  "Out[768]=",ExpressionUUID->"8c6ec0ee-6e2d-4a1a-89f9-47b24cf5427b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "1"}], "}"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.86663897398326*^9},
 CellLabel->
  "Out[769]=",ExpressionUUID->"ecf3f8bf-7fda-4be9-a943-c5a2536efb20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"q", 
     RowBox[{"(", 
      RowBox[{"1", "-", "q"}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", 
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8666372003236217`*^9, 3.86663721622692*^9}, {
   3.866637317290097*^9, 3.8666373498219433`*^9}, {3.866637400652334*^9, 
   3.8666374007866497`*^9}, {3.866637490138772*^9, 3.8666375348376293`*^9}, {
   3.8666375679944687`*^9, 3.866637654561969*^9}, {3.866637813415248*^9, 
   3.866637824828907*^9}, {3.866638431625868*^9, 3.866638448631967*^9}, {
   3.86663849806496*^9, 3.866638536155611*^9}, 3.866638971944365*^9},
 CellLabel->
  "In[770]:=",ExpressionUUID->"00193dc3-f3f0-4a73-b7b8-cde59018157d"],

Cell[BoxData[
 RowBox[{"q", "-", 
  SuperscriptBox["q", "2"], "+", 
  RowBox[{"DD", " ", "s"}], "-", 
  RowBox[{"2", " ", "DD", " ", "q", " ", "s"}]}]], "Output",
 CellChangeTimes->{{3.866637202818655*^9, 3.866637216502874*^9}, {
   3.866637304590226*^9, 3.866637351028487*^9}, {3.866637398410342*^9, 
   3.86663742319895*^9}, {3.866637490642033*^9, 3.866637535219789*^9}, {
   3.866637568712727*^9, 3.8666376201363487`*^9}, 3.8666378178735657`*^9, 
   3.866638418191743*^9, {3.866638499785995*^9, 3.866638542277114*^9}, 
   3.8666389751391993`*^9},
 CellLabel->
  "Out[770]=",ExpressionUUID->"e9d6b5a2-a659-4c9f-8645-9ade4526d568"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "s"}], "}"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.866637202818655*^9, 3.866637216502874*^9}, {
   3.866637304590226*^9, 3.866637351028487*^9}, {3.866637398410342*^9, 
   3.86663742319895*^9}, {3.866637490642033*^9, 3.866637535219789*^9}, {
   3.866637568712727*^9, 3.8666376201363487`*^9}, 3.8666378178735657`*^9, 
   3.866638418191743*^9, {3.866638499785995*^9, 3.866638542277114*^9}, 
   3.866638975142417*^9},
 CellLabel->
  "Out[771]=",ExpressionUUID->"2e771468-fe4c-44cd-9b08-81d8bd192419"]
}, Open  ]],

Cell["\<\
Already with just p(1-p) and q(1-q) we see some interesting effects of \
selection. The heterozygosity at the left locus, p(1-p) has a factor of \
p(1-p)(1-2p), while heterozygosity at the right neutral locus q(1-q) changes \
with an extra factor of s*D*(1-2q)
How do these factors change?\
\>", "Text",
 CellChangeTimes->{{3.8666385596155043`*^9, 3.866638645074163*^9}, {
  3.8666389534248257`*^9, 
  3.8666389576026487`*^9}},ExpressionUUID->"25f86d65-94b6-43bd-b347-\
c6f9e3fd7a7d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "^", "2"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], "^", "2"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}]}], ",", 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.866638964237423*^9, 3.866639029271097*^9}},
 CellLabel->
  "In[784]:=",ExpressionUUID->"270935a7-a516-4431-99f9-ba56fcf456a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}]}], " ", "p", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "s", "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["p", "2"], " ", "s"}], "-", 
    RowBox[{"2", " ", "p", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", " ", "s"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8666389771899767`*^9, 3.866639029623913*^9}},
 CellLabel->
  "Out[784]=",ExpressionUUID->"3025993b-12e8-42ba-935c-0b21d13ab0a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "6"}], " ", "s"}], ",", "1", ",", "s"}], "}"}], ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.8666389771899767`*^9, 3.866639029627035*^9}},
 CellLabel->
  "Out[785]=",ExpressionUUID->"4f0bd5f3-c512-41de-ba49-f96814d4ddbf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pqDunsorted", "[", 
  RowBox[{"select", "[", 
   RowBox[{"Tocs", "[", 
    RowBox[{"DD", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "q"}]}], ")"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PolynomialReduce", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DD", "^", "2"}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "p"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}], ",", 
     RowBox[{"DD", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "q"}]}], ")"}]}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"p", ",", "q", ",", "DD"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.866638964237423*^9, 3.8666389696446857`*^9}, {
  3.86663903857583*^9, 3.866639065286956*^9}},
 CellLabel->
  "In[794]:=",ExpressionUUID->"f4d15c1d-6a9d-4584-ae09-bd823693eed3"],

Cell[BoxData[
 RowBox[{"DD", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", "s", "-", 
    RowBox[{"2", " ", "DD", " ", "s"}], "-", 
    RowBox[{"2", " ", "p", " ", "s"}], "+", 
    RowBox[{"q", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"4", " ", "p"}]}], ")"}], " ", "s"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.8666390413923693`*^9, 3.866639065951536*^9}},
 CellLabel->
  "Out[794]=",ExpressionUUID->"7be3e4ae-461a-4e5c-90a8-679040e835ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "s"}], ",", "s", ",", "1"}], "}"}], ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.8666390413923693`*^9, 3.866639065957611*^9}},
 CellLabel->
  "Out[795]=",ExpressionUUID->"c08990f9-71dd-4cbb-b8c2-2f5fd03496ec"]
}, Open  ]],

Cell["Looking at just the left locus, we can explore some of the ", "Text",
 CellChangeTimes->{{3.866712589144649*^9, 
  3.866712599110935*^9}},ExpressionUUID->"65a9d9f8-2802-4167-8944-\
4345b2704e7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"basisp", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "^", "4"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "4"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "^", "3"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "3"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p", "^", "3"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "3"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "^", "2"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "2"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p", "^", "2"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "2"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "^", "1"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "1"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "p"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"p", "^", "1"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "^", "1"}]}], ",", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", "p"}]}], ")"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8666391555843887`*^9, 3.8666392212558327`*^9}, {
  3.866639589701285*^9, 3.8666395931798*^9}, {3.866640646317593*^9, 
  3.8666406504297113`*^9}},
 CellLabel->
  "In[812]:=",ExpressionUUID->"df96cdd2-e556-49de-9a6e-147f4b52f94a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "4"], " ", 
    SuperscriptBox["p", "4"]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
    SuperscriptBox["p", "3"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
    SuperscriptBox["p", "3"]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
    SuperscriptBox["p", "2"]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
    SuperscriptBox["p", "2"]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "p"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], ",", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8666392221260567`*^9, 3.866639594123672*^9, 
  3.866640650955319*^9},
 CellLabel->
  "Out[812]=",ExpressionUUID->"1bb4fb88-d103-4819-a2da-1da3aae410bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "basisp", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term", "=", 
     RowBox[{"basisp", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Length", "[", "basisp", "]"}], "-", "i", "+", "1"}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "term", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"PolynomialReduce", "[", 
      RowBox[{
       RowBox[{"pqDunsorted", "[", 
        RowBox[{"select", "[", 
         RowBox[{"Tocs", "[", "term", "]"}], "]"}], "]"}], ",", "basisp", ",", 
       RowBox[{"{", "p", "}"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"PolynomialReduce", "[", 
      RowBox[{
       RowBox[{"mutatedriftrecomb", "[", "term", "]"}], ",", "basisp", ",", 
       RowBox[{"{", "p", "}"}]}], "]"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.866639227527409*^9, 3.866639392286223*^9}, {
  3.866639480495675*^9, 3.866639483839568*^9}, {3.8667126225562077`*^9, 
  3.866712698801776*^9}},
 CellLabel->
  "In[850]:=",ExpressionUUID->"73fa5fe8-cc63-4b6c-9dbe-7708653c2360"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"2", " ", "p"}]}]], "Print",
 CellChangeTimes->{3.8667127041810226`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"419073f3-1696-413f-9c9e-a635b4a3558d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "s"}], ",", "1"}], "}"}], ",", "0"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127041832237`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"22e6c433-2767-43a9-86e4-89984faf7b2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1"}], "}"}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "u"}]}], "}"}]], "Print",
 CellChangeTimes->{3.866712704214069*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"ed34b940-8022-484b-b3e7-0c5e46dc0de1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]], "Print",
 CellChangeTimes->{3.866712704215433*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"0c9ad708-2bfe-49af-bea2-7546c10fca30"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "s", ",", "1", ",", 
     "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.866712704216737*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"5ce749b9-0294-43df-92fa-0b740f1a31b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0"}], "}"}], ",", "u"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.8667127042180853`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"caf860ba-37dd-4421-a873-115849f217a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "p"}], ")"}], " ", "p"}]], "Print",
 CellChangeTimes->{3.866712704219338*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"8a5de303-3bb2-4d3d-8911-52af545182eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "6"}], " ", "s"}], ",", "1", ",", "s", ",", "0"}], "}"}], 
   ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127042408743`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"77d5cdf4-d7dc-4963-85b5-37ba2ca84411"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", "0"}], "}"}], ",", "u"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.866712704242197*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"05928672-9d65-4363-8448-8180913f8b63"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
  SuperscriptBox["p", "2"]}]], "Print",
 CellChangeTimes->{3.8667127042434797`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"728efd3f-e2a6-49ad-9276-5fa3e7caf052"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"2", " ", "s"}], ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}],
    ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.866712704265011*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"4d3b4dea-157f-4fb0-baab-e7e9ba72711a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "6"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", 
     FractionBox["1", 
      RowBox[{"2", " ", "Ne"}]], ",", "0"}], "}"}], ",", "0"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.866712704266423*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"465ac1be-edd4-4ea7-9f57-81ab9ebe2a64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "2"], " ", 
  SuperscriptBox["p", "2"]}]], "Print",
 CellChangeTimes->{3.866712704267626*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"859c35b5-f66c-462a-bcf6-cbe6b996e444"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "10"}], " ", "s"}], ",", "1", ",", 
     RowBox[{"2", " ", "s"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   "0"}], "}"}]], "Print",
 CellChangeTimes->{3.866712704289105*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"c86a4f28-9f51-4c70-a90a-72b5b436e9bf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "10"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", 
     FractionBox["1", 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", "0"}], "}"}], ",", "0"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.866712704311603*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"00933948-dcfb-48ed-80fd-73c343bdbbe7"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
  SuperscriptBox["p", "3"]}]], "Print",
 CellChangeTimes->{3.866712704312977*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"407b5f48-4575-4a07-87c3-31182a650304"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"3", " ", "s"}], ",", "1", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.866712704313986*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"1a323e07-52df-46be-be3e-09bece50d6d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "15"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", 
     FractionBox["3", 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   "0"}], "}"}]], "Print",
 CellChangeTimes->{3.866712704337207*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"6b811f85-9171-4fcf-8dec-47f3ca2cd394"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "p"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "3"], " ", 
  SuperscriptBox["p", "3"]}]], "Print",
 CellChangeTimes->{3.866712704338736*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"b298bb6c-fcdc-4267-a37e-30244ab38e9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "14"}], " ", "s"}], ",", "1", ",", 
     RowBox[{"3", " ", "s"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.866712704359363*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"da10746f-1c61-4d1a-9369-ec419b3c5713"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "21"}], "+", 
       RowBox[{"2", " ", "Ne"}]}], 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", 
     FractionBox["3", 
      RowBox[{"2", " ", "Ne"}]], ",", "0", ",", "0", ",", "0", ",", "0"}], 
    "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127043846283`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"9f55840e-8987-4dea-8cac-59499becfa84"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], "4"], " ", 
  SuperscriptBox["p", "4"]}]], "Print",
 CellChangeTimes->{3.8667127043860703`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"9ba6dc7e-e10a-4fd1-bb18-dd5228efdcc8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      RowBox[{"4", " ", "s"}], "-", 
      RowBox[{"8", " ", "p", " ", "s"}]}], ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127044062357`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"e226625f-6892-4694-b64a-34308e7c20e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "14"}], "+", "Ne"}], "Ne"], ",", "0", ",", 
     FractionBox["3", "Ne"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8667127044366198`*^9},
 CellLabel->
  "During evaluation of \
In[850]:=",ExpressionUUID->"a40da077-0978-4bd7-a1be-a72364e83897"]
}, Open  ]]
}, Open  ]],

Cell["\<\
What are some closure options for the selection operator?
1. Truncation: terms of higher order are just ignored, and their contribution \
to terms in our system are set to zero. For example, above the selection \
operator has p^4(1-p)^4 = p^4(1-p)^4 + 4s p^4(1-p)^4(1-2p). Instead, this \
second term would just be dropped.
2. Nonlinear estimation: the (expectation of) p^4(1-p)^4(1-2p) could be \
estimated as the product of (expectations of) lower order terms: \
E[p^4(1-p)^4(1-2p)] \\approx E[p^2(1-p)^2(1-2p)] E[p^2(1-p)^2]. Some \
experimentation would be needed.
3. Extrapolation: p^4(1-p)^4(1-2p) is estimated as a linear combination of \
p(1-p)(1-2p), p^2(1-p)^2(1-2p), and p^3(1-p)^3(1-2p), where we fit some curve \
to those statistics. We could devise either a jackknife approximation, or use \
a more crude but effective Richardson extrapolation approach.\
\>", "Text",
 CellChangeTimes->{{3.86671288736236*^9, 3.866712895378562*^9}, {
  3.866712931590663*^9, 3.866712953310708*^9}, {3.866713126217853*^9, 
  3.866713151520421*^9}, {3.866713183726655*^9, 3.866713185020811*^9}, {
  3.8667134716899643`*^9, 
  3.866713765396693*^9}},ExpressionUUID->"efde2a9e-349d-41b7-bda1-\
519adcc67d0b"]
}, Open  ]]
},
WindowSize->{1094.25, 714.75},
WindowMargins->{{24, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1a9edc5b-92f0-4e4f-b688-61f7f57132b2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 350, 6, 142, "Subtitle",ExpressionUUID->"584ef30d-dc91-40b3-9f41-a306b58dc2d7",
 CellGroupingRules->{"TitleGrouping", Inherited}],
Cell[933, 30, 509, 9, 58, "Text",ExpressionUUID->"3a9b7c18-bd38-4904-8530-abbc673e9b30"],
Cell[1445, 41, 2192, 60, 170, "Input",ExpressionUUID->"4e0090fa-45e8-4cda-974d-929309f812ec",
 InitializationCell->True],
Cell[3640, 103, 2022, 37, 265, "Text",ExpressionUUID->"04348e1a-2180-4a53-b92d-5a9833bf3ad2"],
Cell[5665, 142, 4714, 132, 278, "Input",ExpressionUUID->"a7c5e36c-2590-4bdc-bd5e-d7b5c36b4395"],
Cell[10382, 276, 955, 23, 29, "Input",ExpressionUUID->"e78dec6b-9141-479c-b47a-2fb8fccccea9"],
Cell[CellGroupData[{
Cell[11362, 303, 245, 5, 29, "Input",ExpressionUUID->"a34127a2-e5d4-4d0c-8ee4-32a82c9232fc"],
Cell[11610, 310, 340, 8, 33, "Output",ExpressionUUID->"439bee88-d88a-43e8-a4d4-1502d62e3bd7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11987, 323, 196, 3, 41, "Subsubtitle",ExpressionUUID->"073e83c6-35d4-48b9-b551-d122f7bfe12e"],
Cell[12186, 328, 1849, 44, 127, "Text",ExpressionUUID->"3dd74df5-3c33-4b9c-84e5-50f55027dafc"],
Cell[14038, 374, 3290, 83, 195, "Input",ExpressionUUID->"bdf6ebda-0f0f-4262-ab5b-9ae9bebd1489"],
Cell[17331, 459, 783, 21, 51, "Input",ExpressionUUID->"97e1f496-ae00-4724-9c6c-1b0e1137b128"],
Cell[18117, 482, 156, 3, 35, "Text",ExpressionUUID->"d1cf5acb-d0b7-433e-87a9-6c1a2a946414"],
Cell[CellGroupData[{
Cell[18298, 489, 788, 20, 92, "Input",ExpressionUUID->"034ef1cc-3c5b-463b-b2e8-96889599980c"],
Cell[19089, 511, 437, 11, 48, "Output",ExpressionUUID->"791ce684-e8b4-423d-ada9-e763a9dc4c52"],
Cell[19529, 524, 304, 5, 33, "Output",ExpressionUUID->"e205bfb1-bcfe-4101-bbb5-6c34d8286e91"],
Cell[19836, 531, 1197, 31, 49, "Output",ExpressionUUID->"63700385-10cf-4fd7-bda0-4bc788b58fb4"],
Cell[21036, 564, 348, 7, 33, "Output",ExpressionUUID->"71c6482d-73b1-4909-8000-3e21f45245a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21421, 576, 719, 16, 71, "Input",ExpressionUUID->"72e27084-2e02-49ef-8d28-102c3e91fd85"],
Cell[22143, 594, 396, 8, 33, "Output",ExpressionUUID->"959d4f4e-4e5a-455d-8e9c-2f3d56a27f59"],
Cell[22542, 604, 466, 11, 33, "Output",ExpressionUUID->"fc4dced9-7158-4a8f-b302-bb204f108310"],
Cell[23011, 617, 468, 11, 33, "Output",ExpressionUUID->"f5c5d474-6033-4e80-949e-46e5e0a26349"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23528, 634, 186, 3, 41, "Subsubtitle",ExpressionUUID->"eea14446-08e9-4e7b-a065-3ec4042ca706"],
Cell[23717, 639, 2839, 67, 221, "Text",ExpressionUUID->"6c96e922-cdcc-45f5-9e7f-7974be5f4680"],
Cell[26559, 708, 6189, 144, 464, "Input",ExpressionUUID->"bb04c2bc-caa1-4e68-9131-f6cbe1aed486"],
Cell[CellGroupData[{
Cell[32773, 856, 404, 9, 29, "Input",ExpressionUUID->"9e4959c5-c31a-4c04-b8da-8723e3d3d420"],
Cell[33180, 867, 640, 12, 49, "Output",ExpressionUUID->"bad6a46a-14bd-4ab9-a5b5-27ea94781d71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33857, 884, 463, 10, 29, "Input",ExpressionUUID->"1272e920-5f03-4f43-ba36-3c0f2182e2e8"],
Cell[34323, 896, 1156, 32, 55, "Output",ExpressionUUID->"1dc58842-7b75-4d34-b15f-ed80f2234e04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35516, 933, 1580, 44, 71, "Input",ExpressionUUID->"73e67e94-e5e9-4ad5-9df8-d1e7677914cf"],
Cell[37099, 979, 975, 34, 51, "Output",ExpressionUUID->"3a94dc42-bf28-402a-9660-213af0b78033"],
Cell[38077, 1015, 715, 24, 51, "Output",ExpressionUUID->"0d770b95-8ab0-43a7-9249-1c17d5110379"],
Cell[38795, 1041, 827, 28, 49, "Output",ExpressionUUID->"abdb2f2b-6940-4e26-99fe-e789cadc1f56"]
}, Open  ]],
Cell[39637, 1072, 181, 3, 35, "Text",ExpressionUUID->"d1c1167d-b45b-4a16-8537-b70ce73e3c52"],
Cell[CellGroupData[{
Cell[39843, 1079, 838, 21, 51, "Input",ExpressionUUID->"0305386c-2ef8-4467-85f4-dad15174e7ea"],
Cell[40684, 1102, 425, 14, 49, "Output",ExpressionUUID->"955a00de-ecfc-44a0-b902-2e1c67b90213"],
Cell[41112, 1118, 427, 14, 49, "Output",ExpressionUUID->"4f2b6f9a-e7f1-42f4-8129-ab2afdd70897"]
}, Open  ]],
Cell[41554, 1135, 518, 11, 29, "Input",ExpressionUUID->"7a0ac765-6d7f-4c38-a1d5-ec9a3ee6ec67"],
Cell[CellGroupData[{
Cell[42097, 1150, 3255, 95, 133, "Input",ExpressionUUID->"5e7e3695-791b-4f3e-b014-090ea8a4080d"],
Cell[45355, 1247, 789, 24, 49, "Output",ExpressionUUID->"d1a9f030-e24b-4774-b8b6-11577886de16"],
Cell[46147, 1273, 739, 23, 49, "Output",ExpressionUUID->"1cb345db-7013-40a4-b32d-93930271fd32"],
Cell[46889, 1298, 557, 17, 49, "Output",ExpressionUUID->"1832a20d-6352-4183-92a3-0fe5390d314e"]
}, Open  ]],
Cell[47461, 1318, 521, 15, 35, "Text",ExpressionUUID->"c12e1f0f-7652-4d48-a063-30fc9be63a73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48031, 1339, 154, 3, 53, "Subtitle",ExpressionUUID->"d44b79df-f145-4a93-bc50-9d5a6d1d4901"],
Cell[48188, 1344, 895, 16, 127, "Text",ExpressionUUID->"528e3cbe-9c6b-44fc-bb4d-f0a2ffa0970a"],
Cell[49086, 1362, 423, 10, 29, "Input",ExpressionUUID->"723e3d04-781a-43a4-9f42-0d74d859d996"],
Cell[49512, 1374, 239, 6, 35, "Text",ExpressionUUID->"7571f009-14c7-4611-918a-162503f40d46"],
Cell[49754, 1382, 4836, 110, 360, "Input",ExpressionUUID->"939b21b8-e5a3-45f7-88df-df1a8549caaa"],
Cell[CellGroupData[{
Cell[54615, 1496, 506, 14, 29, "Input",ExpressionUUID->"6894c8c5-1be8-4978-9125-076b8f6ad6f3"],
Cell[55124, 1512, 207, 4, 33, "Output",ExpressionUUID->"676eac02-0f9e-465b-93e1-8b2aadb73057"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55368, 1521, 1322, 41, 71, "Input",ExpressionUUID->"2f491b85-e088-48ea-91af-5cb4bf6c029e"],
Cell[56693, 1564, 415, 7, 33, "Output",ExpressionUUID->"acb51416-59e6-4a21-b486-db7fef56358f"],
Cell[57111, 1573, 415, 7, 33, "Output",ExpressionUUID->"4b8d7cdd-90f4-493c-9886-c739029dfe2a"],
Cell[57529, 1582, 558, 12, 36, "Output",ExpressionUUID->"b9b67d63-6f48-4219-bf63-da1b921430d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58124, 1599, 416, 12, 29, "Input",ExpressionUUID->"2967b2cc-04ab-4048-a8e5-1fc8b12984f3"],
Cell[58543, 1613, 489, 12, 33, "Output",ExpressionUUID->"317e60e4-fa9b-4ab1-bf1f-6d597c0aea99"]
}, Open  ]],
Cell[59047, 1628, 735, 15, 29, "Input",ExpressionUUID->"734903f8-cde0-41da-ba90-0c3e5dbe12f5"],
Cell[CellGroupData[{
Cell[59807, 1647, 564, 14, 29, "Input",ExpressionUUID->"01e69b4d-ba78-4ce4-a0e0-242331a074c5"],
Cell[60374, 1663, 505, 12, 51, "Output",ExpressionUUID->"b7450d56-14d4-4317-bf5e-0c2e96c4cb17"]
}, Open  ]],
Cell[60894, 1678, 596, 13, 81, "Text",ExpressionUUID->"cfa6a3c5-db13-4001-b79e-44d0c775c403"],
Cell[CellGroupData[{
Cell[61515, 1695, 766, 25, 29, "Input",ExpressionUUID->"4c05ba30-55a0-4d2a-9e76-49d28066101c"],
Cell[62284, 1722, 809, 25, 36, "Output",ExpressionUUID->"7bac531a-5cb7-4bde-9436-f1e6e3991a41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63130, 1752, 1666, 40, 113, "Input",ExpressionUUID->"3bb69849-2be3-4eb1-b786-3f966c43c217"],
Cell[64799, 1794, 825, 23, 49, "Output",ExpressionUUID->"d33ece22-ddc3-4a81-b600-52dd93dca90e"],
Cell[65627, 1819, 802, 22, 49, "Output",ExpressionUUID->"c942c627-19a2-48f7-8114-6a730e6ad8ee"],
Cell[66432, 1843, 965, 28, 49, "Output",ExpressionUUID->"76c38813-6b2d-46ed-a5bd-1c61592131d0"],
Cell[67400, 1873, 607, 16, 49, "Output",ExpressionUUID->"2c27feb3-e9a4-4a68-aae7-c7d7bf847e1b"],
Cell[68010, 1891, 604, 15, 49, "Output",ExpressionUUID->"25ff548e-5456-4b8f-8761-90a620c6fb39"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68663, 1912, 155, 3, 53, "Subtitle",ExpressionUUID->"745cca63-c79f-4d37-90a4-f9f1c533ecc9"],
Cell[68821, 1917, 1523, 29, 219, "Text",ExpressionUUID->"8a196890-91b8-40e9-b01d-c3c2d8a11938"],
Cell[70347, 1948, 1711, 44, 195, "Input",ExpressionUUID->"bde2a0cc-355e-412a-8c75-6b62573f33a1"],
Cell[CellGroupData[{
Cell[72083, 1996, 278, 6, 29, "Input",ExpressionUUID->"ac5a3ffa-d33c-4371-aeee-b88cb230802e"],
Cell[72364, 2004, 282, 7, 33, "Output",ExpressionUUID->"7cb656c6-82bc-4961-87fe-5433feb14b4a"]
}, Open  ]],
Cell[72661, 2014, 473, 9, 58, "Text",ExpressionUUID->"7d06efee-3590-46d1-a231-cbaa84101b22"],
Cell[CellGroupData[{
Cell[73159, 2027, 1028, 24, 51, "Input",ExpressionUUID->"15365c87-047f-4812-b26e-1655d50cc175"],
Cell[74190, 2053, 503, 13, 33, "Output",ExpressionUUID->"abc2f3bd-f10f-4db1-bdb3-3644033f1383"],
Cell[74696, 2068, 421, 10, 36, "Output",ExpressionUUID->"93e255fe-c4bb-491d-98e7-42cbb7f492f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75154, 2083, 1655, 49, 51, "Input",ExpressionUUID->"6ae9592b-e847-47b3-8e13-9ba64edc6b19"],
Cell[76812, 2134, 939, 28, 36, "Output",ExpressionUUID->"ad22d588-3e0d-4bca-9aa9-49b9b092a4c2"],
Cell[77754, 2164, 493, 15, 48, "Output",ExpressionUUID->"57810e3a-1f0d-4507-ac0c-a5f60a96a04e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78284, 2184, 1664, 48, 51, "Input",ExpressionUUID->"b6316d7d-c51e-49f6-bc37-ef5cffbeb405"],
Cell[79951, 2234, 884, 29, 36, "Output",ExpressionUUID->"bcda8de8-8241-4746-bbae-062cd4b69bc5"],
Cell[80838, 2265, 414, 12, 46, "Output",ExpressionUUID->"0ae6149e-e4a2-40b8-9627-c875c2f23c35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81289, 2282, 1176, 30, 51, "Input",ExpressionUUID->"a512e250-1730-4882-8d2a-9b304ee02bf0"],
Cell[82468, 2314, 448, 15, 33, "Output",ExpressionUUID->"8c6ec0ee-6e2d-4a1a-89f9-47b24cf5427b"],
Cell[82919, 2331, 246, 7, 33, "Output",ExpressionUUID->"ecf3f8bf-7fda-4be9-a943-c5a2536efb20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83202, 2343, 1122, 28, 51, "Input",ExpressionUUID->"00193dc3-f3f0-4a73-b7b8-cde59018157d"],
Cell[84327, 2373, 632, 12, 33, "Output",ExpressionUUID->"e9d6b5a2-a659-4c9f-8645-9ade4526d568"],
Cell[84962, 2387, 590, 12, 33, "Output",ExpressionUUID->"2e771468-fe4c-44cd-9b08-81d8bd192419"]
}, Open  ]],
Cell[85567, 2402, 494, 10, 81, "Text",ExpressionUUID->"25f86d65-94b6-43bd-b347-c6f9e3fd7a7d"],
Cell[CellGroupData[{
Cell[86086, 2416, 1027, 33, 51, "Input",ExpressionUUID->"270935a7-a516-4431-99f9-ba56fcf456a4"],
Cell[87116, 2451, 544, 16, 36, "Output",ExpressionUUID->"3025993b-12e8-42ba-935c-0b21d13ab0a2"],
Cell[87663, 2469, 334, 10, 33, "Output",ExpressionUUID->"4f0bd5f3-c512-41de-ba49-f96814d4ddbf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88034, 2484, 970, 30, 51, "Input",ExpressionUUID->"f4d15c1d-6a9d-4584-ae09-bd823693eed3"],
Cell[89007, 2516, 599, 18, 33, "Output",ExpressionUUID->"7be3e4ae-461a-4e5c-90a8-679040e835ae"],
Cell[89609, 2536, 334, 10, 33, "Output",ExpressionUUID->"c08990f9-71dd-4cbb-b8c2-2f5fd03496ec"]
}, Open  ]],
Cell[89958, 2549, 201, 3, 35, "Text",ExpressionUUID->"65a9d9f8-2802-4167-8944-4345b2704e7f"],
Cell[CellGroupData[{
Cell[90184, 2556, 1701, 58, 92, "Input",ExpressionUUID->"df96cdd2-e556-49de-9a6e-147f4b52f94a"],
Cell[91888, 2616, 1415, 48, 36, "Output",ExpressionUUID->"1bb4fb88-d103-4819-a2da-1da3aae410bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93340, 2669, 1326, 32, 133, "Input",ExpressionUUID->"73fa5fe8-cc63-4b6c-9dbe-7708653c2360"],
Cell[CellGroupData[{
Cell[94691, 2705, 222, 6, 23, "Print",ExpressionUUID->"419073f3-1696-413f-9c9e-a635b4a3558d"],
Cell[94916, 2713, 382, 11, 23, "Print",ExpressionUUID->"22e6c433-2767-43a9-86e4-89984faf7b2f"],
Cell[95301, 2726, 384, 12, 23, "Print",ExpressionUUID->"ed34b940-8022-484b-b3e7-0c5e46dc0de1"],
Cell[95688, 2740, 244, 7, 23, "Print",ExpressionUUID->"0c9ad708-2bfe-49af-bea2-7546c10fca30"],
Cell[95935, 2749, 340, 10, 23, "Print",ExpressionUUID->"5ce749b9-0294-43df-92fa-0b740f1a31b4"],
Cell[96278, 2761, 465, 14, 38, "Print",ExpressionUUID->"caf860ba-37dd-4421-a873-115849f217a1"],
Cell[96746, 2777, 326, 10, 23, "Print",ExpressionUUID->"8a5de303-3bb2-4d3d-8911-52af545182eb"],
Cell[97075, 2789, 383, 11, 23, "Print",ExpressionUUID->"77d5cdf4-d7dc-4963-85b5-37ba2ca84411"],
Cell[97461, 2802, 463, 14, 38, "Print",ExpressionUUID->"05928672-9d65-4363-8448-8180913f8b63"],
Cell[97927, 2818, 296, 9, 23, "Print",ExpressionUUID->"728efd3f-e2a6-49ad-9276-5fa3e7caf052"],
Cell[98226, 2829, 359, 10, 23, "Print",ExpressionUUID->"4d3b4dea-157f-4fb0-baab-e7e9ba72711a"],
Cell[98588, 2841, 515, 16, 38, "Print",ExpressionUUID->"465ac1be-edd4-4ea7-9f57-81ab9ebe2a64"],
Cell[99106, 2859, 376, 12, 23, "Print",ExpressionUUID->"859c35b5-f66c-462a-bcf6-cbe6b996e444"],
Cell[99485, 2873, 408, 12, 23, "Print",ExpressionUUID->"c86a4f28-9f51-4c70-a90a-72b5b436e9bf"],
Cell[99896, 2887, 516, 16, 38, "Print",ExpressionUUID->"00933948-dcfb-48ed-80fd-73c343bdbbe7"],
Cell[100415, 2905, 294, 9, 23, "Print",ExpressionUUID->"407b5f48-4575-4a07-87c3-31182a650304"],
Cell[100712, 2916, 361, 10, 23, "Print",ExpressionUUID->"1a323e07-52df-46be-be3e-09bece50d6d4"],
Cell[101076, 2928, 517, 16, 38, "Print",ExpressionUUID->"6b811f85-9171-4fcf-8dec-47f3ca2cd394"],
Cell[101596, 2946, 376, 12, 23, "Print",ExpressionUUID->"b298bb6c-fcdc-4267-a37e-30244ab38e9e"],
Cell[101975, 2960, 410, 12, 23, "Print",ExpressionUUID->"da10746f-1c61-4d1a-9369-ec419b3c5713"],
Cell[102388, 2974, 520, 16, 38, "Print",ExpressionUUID->"9f55840e-8987-4dea-8cac-59499becfa84"],
Cell[102911, 2992, 296, 9, 23, "Print",ExpressionUUID->"9ba6dc7e-e10a-4fd1-bb18-dd5228efdcc8"],
Cell[103210, 3003, 437, 12, 23, "Print",ExpressionUUID->"e226625f-6892-4694-b64a-34308e7c20e8"],
Cell[103650, 3017, 439, 13, 38, "Print",ExpressionUUID->"a40da077-0978-4bd7-a1be-a72364e83897"]
}, Open  ]]
}, Open  ]],
Cell[104116, 3034, 1211, 20, 173, "Text",ExpressionUUID->"efde2a9e-349d-41b7-bda1-519adcc67d0b"]
}, Open  ]]
}
]
*)

